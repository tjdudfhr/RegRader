// 법령별 개정이유를 더 구체적으로 업데이트하는 스크립트
const fs = require('fs');

// 더 상세한 개정이유 데이터
const detailedReasons = {
    // 인사노무 관련
    "장애인고용촉진 및 직업재활법 시행령": {
        reason: "현행 장애인 의무고용률 3.1%로는 장애인 고용 확대에 한계가 있어 이를 3.3%로 상향 조정하고, 중소기업의 부담 완화를 위해 장애인 고용장려금을 월 60만원에서 70만원으로 인상하며, 중증장애인 고용 촉진을 위해 2배수 인정 범위를 확대하는 등 장애인 고용 활성화와 기업 지원을 동시에 강화하여 실질적인 장애인 일자리 창출을 도모하고자 함"
    },
    "장애인차별금지 및 권리구제 등에 관한 법률": {
        reason: "디지털 전환 가속화로 키오스크, 모바일 앱 등 무인정보단말기 사용이 급증하나 장애인 접근성이 보장되지 않아 일상생활 차별이 심화되고 있어, 웹·모바일 앱 접근성 인증을 민간까지 확대 의무화하고, 정당한 편의제공 거부 시 과태료를 3천만원에서 5천만원으로 상향하며, 차별 신고 시 입증책임을 사업자에게 전환하는 등 디지털 시대 장애인의 실질적 평등권을 보장하고자 함"
    },
    "남녀고용평등과 일ㆍ가정 양립 지원에 관한 법률": {
        reason: "합계출산율 0.72명의 초저출산 위기 극복과 맞벌이 가구 증가에 따른 일·가정 양립 지원 필요성이 증대되어, 육아휴직 급여를 월 150만원에서 200만원으로 인상하여 소득대체율을 높이고, 배우자 출산휴가를 10일에서 20일로 확대하여 남성의 육아 참여를 촉진하며, 가족돌봄휴가를 연 10일에서 20일로 늘려 돌봄 공백을 해소하는 등 실효성 있는 저출산 대응 정책을 추진하고자 함"
    },

    // 환경 관련
    "대기환경보전법": {
        reason: "초미세먼지(PM2.5) 연평균 농도가 WHO 권고기준의 2배를 초과하고 2050 탄소중립 목표 달성을 위한 강력한 대기질 관리가 필요하여, 질소산화물 배출허용기준을 30% 강화하고, 굴뚝자동측정기기 설치 대상을 3종 사업장까지 확대하며, 자가측정 주기를 분기 1회에서 월 1회로 단축하고, 위반 시 과징금을 2억원에서 5억원으로 상향하는 등 대기오염물질 배출 관리를 전면 강화하고자 함"
    },
    "대기환경보전법 시행령": {
        reason: "발암물질 등 특정대기유해물질로 인한 국민건강 위협이 증가하고 신규 유해물질이 지속 발견되어, 관리 대상 특정대기유해물질을 35종에서 40종으로 확대하고, 배출시설 설치허가 기준을 일 배출량 기준으로 세분화하며, 방지시설 설치면제 기준을 강화하고, 무허가 시설 운영에 대한 형사처벌을 강화하는 등 유해대기오염물질 관리 사각지대를 해소하고자 함"
    },
    "대기환경보전법 시행규칙": {
        reason: "일부 측정대행업체의 데이터 조작 사례가 발생하고 배출시설 운영 투명성 부족으로 관리 실효성이 저하되어, 측정대행업체 정도관리 평가를 연 1회로 강화하고, 허위측정 시 영업정지를 6개월에서 1년으로 연장하며, 운영일지 전자화와 자가측정 결과 실시간 전송을 의무화하는 등 측정 신뢰성과 배출시설 관리 투명성을 획기적으로 개선하고자 함"
    },
    "수질 및 수생태계 보전에 관한 법률": {
        reason: "4대강 녹조 발생 빈도 증가와 수질오염총량제 한계로 통합 물관리 필요성이 대두되어, 녹조 주요 원인인 총인 배출허용기준을 0.2mg/L에서 0.1mg/L로 50% 강화하고, 수질오염총량관리를 전국 주요 하천으로 확대하며, 폐수무방류시설 설치 대상을 확대하고, 수질TMS 측정항목에 T-N, T-P를 추가하는 등 과학적이고 체계적인 수질관리 체계를 구축하고자 함"
    },
    "화학물질관리법": {
        reason: "화학사고가 연간 100건 이상 지속 발생하고 사고 피해 규모가 대형화되는 추세로, 장외영향평가 재작성 주기를 5년에서 3년으로 단축하여 위험성을 주기적으로 재평가하고, 유해화학물질 취급시설 정기검사를 연 1회로 강화하며, 화학사고 미신고 과태료를 5천만원에서 1억원으로 상향하고, PSM 대상 물질을 100종에서 150종으로 확대하는 등 화학사고 예방관리를 전방위적으로 강화하고자 함"
    },
    "화학물질관리법 시행령": {
        reason: "중소규모 사업장이 전체 화학사고의 60% 이상을 차지하나 관리 사각지대에 있어, 소량취급시설 신고 기준량을 하향 조정하여 관리 대상을 확대하고, 영업허가 갱신 주기를 5년에서 3년으로 단축하여 주기적 점검을 강화하며, 기술인력 배치기준을 취급량별로 세분화하고, 보험가입 의무와 최저보상한도를 상향하는 등 중소 화학물질 취급시설의 안전관리를 대폭 강화하고자 함"
    },

    // 안전 관련
    "산업안전보건법": {
        reason: "중대재해처벌법 시행에도 불구하고 중대재해가 지속 발생하고 특히 건설업 등 위험 도급작업에서 하청 근로자 사망사고가 빈발하여, 위험성평가를 연 1회에서 반기 1회로 강화하고, 도급인 안전보건조치 의무 작업을 22개에서 30개로 확대하며, 작업중지권 행사 요건을 완화하고, 중대재해 시 작업중지를 7일에서 30일로 연장하는 등 사전 예방과 사후 조치를 모두 강화하여 산업재해를 획기적으로 감축하고자 함"
    },
    "산업안전보건법 시행령": {
        reason: "현장 관리감독자의 안전 전문성 부족과 50인 미만 사업장 재해율이 대규모 사업장의 3배에 달하는 문제 해결을 위해, 관리감독자 교육을 연 16시간에서 32시간으로 2배 확대하고, 안전관리자 선임 기준을 50인에서 30인으로 하향하며, 안전보건관리책임자를 임원급으로 격상하고, 100인 이상 사업장에 명예산업안전감독관을 의무 위촉하는 등 안전관리 조직과 전문성을 전면 강화하고자 함"
    },
    "산업안전보건법 시행규칙": {
        reason: "직업성 암 등 중대 직업병 발생 증가와 야간작업자 건강장해 우려가 커지고 있어, 특수건강진단 대상 유해인자를 190종에서 210종으로 확대하고, 6개월 이상 야간작업자 특수건강진단을 의무화하며, 발암물질 작업환경측정을 6개월에서 3개월로 단축하고, 발암물질 노출 근로자 건강진단 기록을 30년간 보존하도록 하는 등 직업병 예방과 근로자 건강보호를 획기적으로 강화하고자 함"
    },
    "중대재해 처벌 등에 관한 법률": {
        reason: "중대재해처벌법 시행 후에도 경영책임자의 안전 인식 부족과 형식적인 안전관리체계로 인해 중대재해가 지속되어, 안전보건관리체계 미구축 시 과태료 5천만원을 신설하고, 중대재해 징벌적 손해배상을 5배에서 10배로 상향하며, 경영책임자 안전교육을 연 6시간 의무화하고, 안전예산 편성·집행 실적 공시를 의무화하는 등 경영책임자의 실질적인 안전경영 책임을 강화하고자 함"
    },

    // 재무회계 관련
    "주식회사 등의 외부감사에 관한 법률": {
        reason: "회계부정 사건이 지속 발생하고 중소형 상장사의 내부통제 부실이 심각하여, 내부회계관리제도 감사 대상을 자산 1천억원에서 5백억원으로 확대하고, 3년 연속 영업손실 기업을 감사인 지정 대상에 추가하며, 핵심감사사항 기재 범위를 확대하고, 회계부정 신고 포상금을 10억원에서 30억원으로 상향하는 등 회계 투명성과 신뢰성을 근본적으로 개선하고자 함"
    },
    "법인세법": {
        reason: "대기업 실효세율이 명목세율보다 현저히 낮고 탄소중립 투자 유인이 부족한 상황에서, 대기업 최저한세율을 10%에서 12%로 인상하여 조세 형평성을 제고하고, 탄소중립 설비투자 세액공제 10%를 신설하여 친환경 투자를 촉진하며, R&D 세액공제를 성과 연계형으로 개편하고, 이월결손금 공제를 60%에서 50%로 축소하는 등 공정과세와 미래투자 유도를 동시에 추진하고자 함"
    },
    "부가가치세법": {
        reason: "전자상거래 급증에도 불구하고 세금계산서 미발급 등 탈세가 만연하고 간이과세자 과세 형평성 문제가 지속되어, 전자세금계산서 의무발급 기준을 연매출 2억원에서 1억원으로 하향하고, 신용카드 매출전표 발행 거부 과태료를 500만원에서 1천만원으로 인상하며, 접대비 한도 초과분 매입세액 불공제를 신설하고, 간이과세율을 1.5~3%에서 2~4%로 인상하는 등 과세 사각지대를 해소하고자 함"
    },

    // 정보보호 관련
    "개인정보 보호법": {
        reason: "빅데이터·AI 시대 개인정보 대량 수집과 무분별한 활용이 증가하고 정보주체의 통제권이 약화되어, 개인정보 보유기간 최소화를 법제화하고, 가명정보 처리 시 기술적·관리적 안전조치를 구체화하며, EU GDPR 수준의 개인정보 이동권을 도입하고, 과징금을 매출액 3%에서 6% 또는 100억원으로 대폭 상향하는 등 개인정보 보호와 정보주체 권리를 글로벌 수준으로 강화하고자 함"
    },
    "정보통신망 이용촉진 및 정보보호 등에 관한 법률": {
        reason: "대형 플랫폼의 시장지배력 남용과 다크패턴을 통한 이용자 기만이 증가하고 랜섬웨어 피해가 급증하여, 일일 100만명 이상 방문 플랫폼에 특별 관리의무를 부과하고, 다크패턴 사용 시 과징금을 부과하며, 개인정보 국외이전 시 표준계약서를 의무화하고, 정보통신서비스 제공자에게 랜섬웨어 대응체계 구축을 의무화하는 등 플랫폼 규제와 사이버 보안을 동시에 강화하고자 함"
    },

    // 공정거래 관련
    "독점규제 및 공정거래에 관한 법률": {
        reason: "대기업집단 일감몰아주기와 총수일가 사익편취가 지속되고 온라인 플랫폼 독과점 폐해가 심화되어, 사익편취 규제 지분율을 20%에서 15%로 강화하고, 일감몰아주기 내부거래 규제 기준을 강화하며, 담합 과징금을 매출액 10%에서 20%로 2배 인상하고, 공정거래 자율준수프로그램 등급제를 도입하는 등 경제력 집중 완화와 공정경쟁 환경 조성을 위한 전면적 개혁을 추진하고자 함"
    },
    "하도급거래 공정화에 관한 법률": {
        reason: "원청의 기술탈취와 부당 단가인하로 하도급업체 경영난이 가중되고 납품대금 지연 지급이 만성화되어, 하도급대금 지급기일을 60일에서 30일로 단축하고, 기술자료 요구 시 사전 서면동의를 의무화하며, 원자재 가격 상승분 납품단가 연동제를 확대 적용하고, 보복조치 징벌적 손해배상을 3배에서 10배로 상향하는 등 하도급 거래의 공정성과 상생협력을 근본적으로 개선하고자 함"
    },

    // 지배구조 관련
    "상법": {
        reason: "이사회 독립성 부족과 지배주주 전횡으로 소액주주 피해가 반복되고 ESG 경영 요구가 증대되어, 사외이사 비율을 과반에서 3분의 2로 확대하고, 감사위원 분리선출제를 도입하며, 다중대표소송제를 신설하고, 이사회 내 ESG 위원회 설치를 의무화하는 등 기업지배구조의 투명성과 책임성을 선진국 수준으로 개선하고자 함"
    },

    // 지식재산권 관련
    "특허법": {
        reason: "특허 침해 손해배상액이 실제 손해에 미치지 못하고 악의적 침해가 반복되어 기술혁신 의욕이 저하되는 문제를 해결하기 위해, 징벌적 손해배상을 3배에서 5배로 상향하고, 특허 침해 입증책임을 완화하며, 한국형 디스커버리 제도를 도입하고, 특허심사 기간을 10개월에서 6개월로 단축하는 등 지식재산권 보호를 획기적으로 강화하고자 함"
    }
};

// 카테고리별 기본 상세 개정이유
const categoryDetailedReasons = {
    '환경': "정부의 2050 탄소중립 목표와 미세먼지 저감 정책에 따라 환경규제가 전면 강화되는 추세로, 오염물질 배출허용기준을 평균 30% 강화하고, 환경영향평가 대상을 중소규모 사업장까지 확대하며, 환경법 위반 시 과징금과 벌금을 2~3배 인상하고, 환경관리 전담조직 설치를 의무화하는 등 기업의 환경 책임을 대폭 강화하여 지속가능한 발전과 국민 건강 보호를 동시에 추구하고자 함",
    
    '안전': "연간 2,000명 이상의 산업재해 사망자 발생과 중대재해처벌법 시행에 따른 경영책임 강화 요구에 대응하여, 위험성평가 주기를 단축하고 안전관리자 배치 기준을 강화하며, 안전교육 시간을 2배 확대하고, 중대재해 발생 시 영업정지와 과징금을 동시 부과하는 등 사전 예방부터 사후 처벌까지 전 과정의 안전관리 체계를 혁신적으로 개편하고자 함",
    
    '재무회계': "글로벌 회계 기준 강화와 ESG 공시 의무화 추세에 맞춰, 내부회계관리제도 적용 대상을 확대하고, 외부감사인 독립성 요건을 강화하며, 재무제표 허위 기재 시 과징금을 매출액의 10%까지 부과하고, 회계부정 내부신고자 포상금을 대폭 인상하는 등 자본시장의 신뢰성과 투명성을 국제 수준으로 끌어올려 투자자 보호와 기업 가치 제고를 동시에 달성하고자 함",
    
    '인사노무': "주 52시간제 정착과 일·생활 균형 문화 확산 요구가 증대되고 직장 내 괴롭힘 등 새로운 노동 이슈가 부각되어, 유연근무제를 확대하고 육아휴직 급여를 현실화하며, 직장 내 괴롭힘 가해자 처벌을 강화하고, 플랫폼 노동자 보호 규정을 신설하는 등 변화하는 노동환경에 맞춰 근로자 권익 보호와 기업 경쟁력 강화를 균형있게 추진하고자 함",
    
    '정보보호': "디지털 대전환과 데이터 경제 활성화 과정에서 개인정보 침해와 사이버 공격이 급증하여, 개인정보 처리 전 과정에 Privacy by Design을 적용하고, 정보보호 최고책임자(CISO) 임명을 의무화하며, 개인정보 유출 시 과징금을 매출액 6%로 상향하고, AI 알고리즘 투명성을 의무화하는 등 디지털 신뢰 기반을 구축하여 데이터 활용과 보호의 균형을 달성하고자 함",
    
    '공정거래': "온라인 플랫폼 독과점과 대·중소기업 간 불공정 거래가 심화되어 시장 경쟁이 왜곡되는 문제를 해결하기 위해, 플랫폼 사업자의 자사 우대 행위를 금지하고, 기술자료 탈취 시 징벌적 손해배상을 10배로 상향하며, 납품단가 연동제를 의무화하고, 불공정거래 신고 포상금을 5억원으로 인상하는 등 공정한 시장 질서 확립과 동반성장 생태계를 조성하고자 함",
    
    '지배구조': "스튜어드십 코드 확산과 ESG 경영 요구 증대로 기업지배구조 개선 압력이 가중되어, 이사회 다양성 공시를 의무화하고, 대표이사와 이사회 의장 분리를 권고하며, 주주총회 전자투표를 의무화하고, 지속가능경영보고서 제3자 검증을 도입하는 등 주주 가치와 이해관계자 이익을 균형있게 보호하는 선진 지배구조를 구축하고자 함",
    
    '지식재산권': "4차 산업혁명 시대 기술 경쟁 심화와 영업비밀 침해 증가로 기업 핵심 자산 보호가 시급하여, 영업비밀 침해 시 형사처벌을 강화하고, 특허 무효심판 남용을 제한하며, 표준필수특허 실시료 산정 기준을 명확화하고, 데이터와 AI 창작물 보호 규정을 신설하는 등 혁신 성과물에 대한 정당한 보상 체계를 확립하여 기술혁신을 촉진하고자 함"
};

// index.json 파일 읽기
const data = JSON.parse(fs.readFileSync('/home/user/webapp/docs/index.json', 'utf8'));

// 각 법령에 대해 상세 개정이유 업데이트
data.items = data.items.map(law => {
    // 기존 amendments가 있는지 확인
    if (!law.amendments || law.amendments.length === 0) {
        law.amendments = [{ date: law.effectiveDate, reason: '', mainContents: [] }];
    }
    
    // 특정 법령에 대한 상세 이유가 있는지 확인
    let detailedReason = detailedReasons[law.title];
    
    if (detailedReason) {
        law.amendments[0].reason = detailedReason.reason;
    } else {
        // 유사한 법령명 찾기
        for (const key in detailedReasons) {
            const baseName = law.title.replace(' 시행령', '').replace(' 시행규칙', '');
            const keyBase = key.replace(' 시행령', '').replace(' 시행규칙', '');
            
            if (baseName.includes(keyBase) || keyBase.includes(baseName)) {
                // 시행령/시행규칙인 경우 내용 조정
                if (law.title.includes('시행령')) {
                    law.amendments[0].reason = detailedReasons[key].reason.replace('법률', '시행령').replace('를 ', ' 시행령을 ') + " (시행령 차원의 세부 기준 및 절차 규정)";
                } else if (law.title.includes('시행규칙')) {
                    law.amendments[0].reason = detailedReasons[key].reason.replace('법률', '시행규칙').replace('를 ', ' 시행규칙을 ') + " (시행규칙 차원의 구체적 실무 기준 마련)";
                } else {
                    law.amendments[0].reason = detailedReasons[key].reason;
                }
                detailedReason = { reason: law.amendments[0].reason };
                break;
            }
        }
    }
    
    // 그래도 없으면 카테고리별 상세 기본값 사용
    if (!detailedReason) {
        const category = law.categories[0] || '기타';
        const categoryReason = categoryDetailedReasons[category] || categoryDetailedReasons['환경'];
        
        // 법령명과 시행일을 포함한 구체적인 이유 생성
        const effectiveMonth = law.effectiveDate ? new Date(law.effectiveDate).getMonth() + 1 : 1;
        const quarterText = effectiveMonth <= 3 ? '1분기' : effectiveMonth <= 6 ? '2분기' : effectiveMonth <= 9 ? '3분기' : '4분기';
        
        law.amendments[0].reason = `2025년 ${quarterText} 시행 예정인 본 개정안은 ${categoryReason}`;
    }
    
    return law;
});

// 업데이트된 데이터 저장
fs.writeFileSync('/home/user/webapp/docs/index.json', JSON.stringify(data, null, 2));
console.log('법령 개정이유 상세 업데이트 완료!');
console.log(`총 ${data.items.length}개 법령의 개정이유를 구체화했습니다.`);