# RegRader 데이터 연동 체계 가이드

## 📊 현재 데이터 연동 구조

### 1. 데이터 소스 (Single Source of Truth)
```
docs/index.json (276개 매칭 법규)
├── 2025년 시행 법규 정보
├── 개정유형 (amendments[0].amendmentType)
├── 시행일 (effectiveDate)
├── 카테고리 (categories)
└── 부처 정보 (ministry)
```

### 2. 데이터 흐름도
```
index.json (마스터 데이터)
    ↓
┌─────────────────────────────┐
│  PC 버전 (index.html)       │
│  - 자동 카운트 계산         │
│  - 분기별 집계              │
│  - 카테고리별 분류          │
└─────────────────────────────┘
    ↓
┌─────────────────────────────┐
│  모바일 버전 (mobile_v2.html)│
│  - updateAllCounts() 함수   │
│  - TOP 3 자동 계산          │
│  - 동적 UI 업데이트         │
└─────────────────────────────┘
```

## 🔄 자동 연동 시스템

### PC 버전 (index.html)
- **데이터 로딩**: `fetch('./index.json')`
- **자동 계산**:
  - 시행완료/시행예정: 날짜 비교로 자동 계산
  - 분기별 분포: effectiveDate 기반 자동 분류
  - 카테고리별 집계: categories 필드 기반

### 모바일 버전 (mobile_v2.html)
- **핵심 함수**: `updateAllCounts()`
  ```javascript
  // 모든 카운트 자동 업데이트
  - 분기별 카운트 (Q1, Q2, Q3, Q4)
  - 카테고리별 카운트 (8대 직무)
  - TOP 3 자동 선정 및 정렬
  - 시행 상태 카운트
  ```

## ✅ 현재 연동되는 항목들

### 자동 업데이트 항목:
1. **총 매칭 법규 수** (276개)
2. **시행완료/시행예정** (255/21)
3. **분기별 분포** (Q1:134, Q2:61, Q3:67, Q4:14)
4. **카테고리별 분포**
   - 환경: 105개
   - 안전: 56개
   - 재무회계: 61개
   - 인사노무: 23개
   - 정보보호: 13개
   - 공정거래: 7개
   - 지배구조: 6개
   - 지식재산권: 5개
5. **TOP 3 직무** (자동 정렬)
6. **개정유형** (일부개정/타법개정)

## 🔧 데이터 업데이트 방법

### 전체 법규 수 변경시:
1. `docs/index.json` 수정
2. 자동으로 모든 화면에 반영됨
3. 분기별, 카테고리별 재계산 자동 실행

### 개별 법규 정보 수정시:
```javascript
// index.json에서 수정
{
  "id": "matched_1",
  "title": "법령명",
  "effectiveDate": "2025-01-01",  // 시행일 변경 → 분기 자동 재분류
  "categories": ["환경"],         // 카테고리 변경 → 직무별 자동 재집계
  "amendments": [{
    "amendmentType": "일부개정"    // 개정유형 변경 → 모든 화면 자동 반영
  }]
}
```

## ⚠️ 주의사항

### 아직 수동 업데이트가 필요한 부분:
1. **전체 개정 법규 수** (2,971개) - README와 일부 텍스트에 하드코딩
2. **기본 적용 법규 수** (207개) - 별도 파일 관리

### 개선 필요 사항:
1. PC 버전에 `updateAllCounts()` 같은 통합 함수 필요
2. 전체 법규 수(2,971개)도 JSON 파일에서 관리하도록 개선
3. 실시간 데이터 새로고침 기능 추가

## 📝 업데이트 체크리스트

데이터 변경시 확인 사항:
- [ ] index.json 수정 완료
- [ ] PC 버전에서 숫자 확인
- [ ] 모바일 버전에서 숫자 확인
- [ ] 분기별 합계 = 276개 확인
- [ ] 카테고리별 합계 = 276개 확인
- [ ] TOP 3 정렬 정확성 확인
- [ ] Git commit & push
- [ ] GitHub Pages 배포 확인

## 🚀 향후 개선 계획

1. **완전 자동화**
   - 모든 하드코딩된 숫자 제거
   - 단일 설정 파일에서 모든 수치 관리

2. **실시간 동기화**
   - WebSocket 또는 polling으로 실시간 업데이트
   - 데이터 변경 알림 시스템

3. **데이터 검증**
   - 자동 데이터 무결성 검사
   - 불일치 경고 시스템

## 📅 최종 업데이트: 2025-09-04

---

이 문서는 RegRader의 데이터 연동 체계를 설명합니다.
모든 데이터는 `docs/index.json`을 중심으로 자동 연동됩니다.