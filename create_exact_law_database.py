#!/usr/bin/env python3
"""
사용자가 직무별로 정확히 분류해준 207개 실제 적용 법규로 새로운 데이터베이스 생성
"""

import json
import hashlib
import time
from datetime import datetime

def generate_law_id(title):
    """법령 제목을 기반으로 고유 ID 생성"""
    return hashlib.md5(title.encode('utf-8')).hexdigest()

def create_exact_law_database():
    """사용자 제공 정확한 분류에 따른 법률 데이터베이스 생성"""
    
    # 사용자가 직무별로 분류해준 법규 데이터
    law_categories = {
        "인사노무": [
            "파견근로자보호 등에 관한 법률",
            "파견근로자보호 등에 관한 법률 시행령",
            "파견근로자보호 등에 관한 법률 시행규칙",
            "채용절차의 공정화에 관한 법률",
            "채용절차의 공정화에 관한 법률 시행령",
            "채용절차의 공정화에 관한 법률 시행규칙",
            "장애인고용촉진 및 직업재활법",
            "장애인고용촉진 및 직업재활법 시행령",
            "장애인고용촉진 및 직업재활법 시행규칙",
            "장애인차별금지 및 권리구제 등에 관한 법률",
            "장애인차별금지 및 권리구제 등에 관한 법률 시행령",
            "남녀고용평등과 일·가정 양립 지원에 관한 법률",
            "남녀고용평등과 일·가정 양립 지원에 관한 법률 시행령",
            "남녀고용평등과 일·가정 양립 지원에 관한 법률 시행규칙",
            "기간제 및 단시간근로자 보호 등에 관한 법률",
            "기간제 및 단시간근로자 보호 등에 관한 법률 시행령",
            "기간제 및 단시간근로자 보호 등에 관한 법률 시행규칙",
            "근로기준법",
            "근로기준법 시행령",
            "근로기준법 시행규칙",
            "최저임금법",
            "최저임금법 시행령",
            "최저임금법 시행규칙",
            "근로자퇴직급여 보장법",
            "근로자퇴직급여 보장법 시행령",
            "근로자퇴직급여 보장법 시행규칙",
            "근로복지기본법",
            "근로복지기본법 시행령",
            "근로복지기본법 시행규칙",
            "고용보험법",
            "고용보험법 시행령",
            "고용보험법 시행규칙",
            "고용정책 기본법",
            "고용정책 기본법 시행령",
            "고용정책 기본법 시행규칙",
            "노동조합 및 노동관계조정법",
            "노동조합 및 노동관계조정법 시행령",
            "노동조합 및 노동관계조정법 시행규칙",
            "근로자 참여 및 협력 증진에 관한 법률",
            "근로자 참여 및 협력 증진에 관한 법률 시행령",
            "근로자 참여 및 협력 증진에 관한 법률 시행규칙"
        ],
        "공정거래": [
            "대리점 거래의 공정화에 관한 법률",
            "대리점 거래의 공정화에 관한 법률 시행령",
            "독점규제 및 공정거래에 관한 법률",
            "독점규제 및 공정거래에 관한 법률 시행령",
            "하도급거래 공정화에 관한 법률",
            "하도급거래 공정화에 관한 법률 시행령",
            "대·중소기업 상생협력 촉진에 관한 법률",
            "대·중소기업 상생협력 촉진에 관한 법률 시행령",
            "대·중소기업 상생협력 촉진에 관한 법률 시행규칙",
            "약관의 규제에 관한 법률",
            "약관의 규제에 관한 법률 시행령"
        ],
        "지식재산권": [
            "특허법",
            "특허법 시행령",
            "특허법 시행규칙",
            "특허법·실용신안법·의장법·상표법의 시행에 관한 규칙",
            "실용신안법",
            "실용신안법 시행령",
            "실용신안법 시행규칙"
        ],
        "정보보호": [
            "개인정보 보호법",
            "개인정보 보호법 시행령",
            "정보통신망 이용촉진 및 정보보호 등에 관한 법률",
            "정보통신망 이용촉진 및 정보보호 등에 관한 법률 시행령",
            "정보통신망 이용촉진 및 정보보호 등에 관한 법률 시행규칙",
            "부정경쟁방지 및 영업비밀보호에 관한 법률",
            "부정경쟁방지 및 영업비밀보호에 관한 법률 시행령",
            "정보보호산업의 진흥에 관한 법률",
            "정보보호산업의 진흥에 관한 법률 시행령",
            "정보보호산업의 진흥에 관한 법률 시행규칙",
            "산업기술의 유출방지 및 보호에 관한 법률",
            "산업기술의 유출방지 및 보호에 관한 법률 시행령",
            "산업기술의 유출방지 및 보호에 관한 법률 시행규칙",
            "국가첨단전략산업 경쟁력 강화 및 보호에 관한 특별조치법",
            "국가첨단전략산업 경쟁력 강화 및 보호에 관한 특별조치법 시행령",
            "국가첨단전략산업 경쟁력 강화 및 보호에 관한 특별조치법 시행규칙"
        ],
        "지배구조": [
            "부정청탁 및 금품등 수수의 금지에 관한 법률",
            "부정청탁 및 금품등 수수의 금지에 관한 법률 시행령",
            "상법",
            "상법 시행령",
            "주식회사 등의 외부감사에 관한 법률",
            "주식회사 등의 외부감사에 관한 법률 시행령",
            "주식회사 등의 외부감사에 관한 법률 시행규칙"
        ],
        "재무회계": [
            "법인세법",
            "법인세법 시행령",
            "법인세법 시행규칙",
            "지방세법",
            "지방세법 시행령",
            "지방세법 시행규칙",
            "임시수입부가가치세법",
            "증권거래세법",
            "증권거래세법 시행령",
            "증권거래세법 시행규칙",
            "종합부동산세법 시행령",
            "종합부동산세법 시행규칙",
            "종합부동산세법",
            "국제조세조정에 관한 법률",
            "국제조세조정에 관한 법률 시행령",
            "국제조세조정에 관한 법률 시행규칙",
            "자본시장과 금융투자업에 관한 법률 시행령",
            "자본시장과 금융투자업에 관한 법률",
            "자본시장과 금융투자업에 관한 법률 시행규칙"
        ],
        "환경": [
            "대기환경보전법",
            "대기환경보전법 시행령",
            "대기환경보전법 시행규칙",
            "토양환경보전법",
            "토양환경보전법 시행령",
            "토양환경보전법 시행규칙",
            "물환경보전법",
            "물환경보전법 시행령",
            "물환경보전법 시행규칙",
            "폐기물관리법",
            "폐기물관리법 시행령",
            "폐기물관리법 시행규칙",
            "해양폐기물 및 해양오염퇴적물 관리법",
            "잔류성 오염물질 관리법",
            "잔류성 오염물질 관리법 시행령",
            "잔류성 오염물질 관리법 시행규칙",
            "화학물질관리법",
            "화학물질관리법 시행령",
            "화학물질관리법 시행규칙",
            "소음·진동관리법",
            "소음·진동관리법 시행령",
            "소음·진동관리법 시행규칙",
            "자원의 절약과 재활용 촉진에 관한 법률",
            "자원의 절약과 재활용 촉진에 관한 법률 시행령",
            "자원의 절약과 재활용 촉진에 관한 법률 시행규칙",
            "하수도법",
            "하수도법 시행령",
            "하수도법 시행규칙",
            "악취방지법",
            "악취방지법 시행령",
            "악취방지법 시행규칙",
            "환경영향평가법",
            "환경영향평가법 시행령",
            "환경영향평가법 시행규칙",
            "온실가스 배출권의 할당 및 거래에 관한 법률",
            "온실가스 배출권의 할당 및 거래에 관한 법률 시행령",
            "에너지이용 합리화법",
            "에너지이용 합리화법 시행령",
            "에너지이용 합리화법 시행규칙",
            "환경정책기본법",
            "환경정책기본법 시행령",
            "환경정책기본법 시행규칙",
            "환경개선비용의 부담에 관한 법률",
            "환경개선비용의 부담에 관한 법률 시행령",
            "환경개선비용의 부담에 관한 법률 시행규칙",
            "환경기술 및 환경산업 지원법",
            "환경기술 및 환경산업 지원법 시행령",
            "환경기술 및 환경산업 지원법 시행규칙",
            "먹는물관리법",
            "먹는물관리법 시행령",
            "먹는물관리법 시행규칙",
            "수도법",
            "수도법 시행령",
            "수도법 시행규칙",
            "자원순환기본법",
            "자원순환기본법 시행령",
            "자원순환기본법 시행규칙",
            "화학물질의 등록 및 평가 등에 관한 법률",
            "화학물질의 등록 및 평가 등에 관한 법률 시행령",
            "화학물질의 등록 및 평가 등에 관한 법률 시행규칙",
            "기후위기 대응을 위한 탄소중립·녹색성장 기본법",
            "기후위기 대응을 위한 탄소중립·녹색성장 기본법 시행령",
            "건설폐기물의 재활용촉진에 관한 법률",
            "건설폐기물의 재활용촉진에 관한 법률 시행령",
            "건설폐기물의 재활용촉진에 관한 법률 시행규칙"
        ],
        "안전": [
            "산업안전보건법",
            "산업안전보건법 시행령",
            "산업안전보건법 시행규칙",
            "고압가스 안전관리법",
            "고압가스 안전관리법 시행규칙",
            "소방시설 설치 및 관리에 관한 법률",
            "소방시설 설치 및 관리에 관한 법률 시행령",
            "소방시설 설치 및 관리에 관한 법률 시행규칙",
            "중대재해 처벌 등에 관한 법률",
            "중대재해 처벌 등에 관한 법률 시행령",
            "석면안전관리법",
            "석면안전관리법 시행령",
            "석면안전관리법 시행규칙",
            "위험물 안전관리법",
            "연구실 안전환경 조성에 관한 법률",
            "연구실 안전환경 조성에 관한 법률 시행령",
            "연구실 안전환경 조성에 관한 법률 시행규칙",
            "전기안전관리법",
            "전기안전관리법 시행령",
            "전기안전관리법 시행규칙",
            "화재의 예방 및 안전관리에 관한 법률",
            "화재의 예방 및 안전관리에 관한 법률 시행령",
            "화재의 예방 및 안전관리에 관한 법률 시행규칙",
            "액화석유가스의 안전관리 및 사업법",
            "액화석유가스의 안전관리 및 사업법 시행령",
            "액화석유가스의 안전관리 및 사업법 시행규칙",
            "도시가스사업법",
            "도시가스사업법 시행령",
            "도시가스사업법 시행규칙",
            "원자력안전법",
            "원자력안전법 시행령",
            "원자력안전법 시행규칙",
            "승강기 안전관리법",
            "승강기 안전관리법 시행령",
            "승강기 안전관리법 시행규칙",
            "감염병의 예방 및 관리에 관한 법률",
            "감염병의 예방 및 관리에 관한 법률 시행령",
            "감염병의 예방 및 관리에 관한 법률 시행규칙",
            "식품위생법",
            "식품위생법 시행령",
            "식품위생법 시행규칙"
        ]
    }
    
    laws = []
    category_counts = {}
    
    print(f"📋 사용자 제공 정확한 분류로 법령 데이터베이스 생성 시작...")
    
    for category, law_titles in law_categories.items():
        category_counts[category] = len(law_titles)
        print(f"   - {category}: {len(law_titles)}개")
        
        for title in law_titles:
            # 법령 객체 생성
            law_obj = {
                "id": generate_law_id(title),
                "title": title,
                "summary": "",
                "effectiveDate": "2025-01-01",  # 기본 시행일
                "announcedDate": None,
                "lawType": "개정",
                "categories": [category],
                "meta": {
                    "ministry": "관계부처",
                    "lsId": None
                },
                "source": {
                    "name": "실제 당사 적용 법규",
                    "url": f"https://www.law.go.kr/lsSc.do?query={title}",
                    "search": f"https://www.law.go.kr/lsSc.do?query={title}"
                }
            }
            
            laws.append(law_obj)
    
    total_laws = len(laws)
    
    # 최종 데이터베이스 구조
    database = {
        "generatedAt": int(time.time()),
        "year": 2025,
        "description": f"실제 당사 적용 법규 데이터베이스 ({total_laws}개)",
        "total_laws": total_laws,
        "category_counts": category_counts,
        "items": laws
    }
    
    # JSON 파일로 저장
    with open('docs/index.json', 'w', encoding='utf-8') as f:
        json.dump(database, f, ensure_ascii=False, indent=2)
    
    print(f"✅ 새로운 법률 데이터베이스 생성 완료!")
    print(f"📊 총 법령 수: {total_laws}개")
    print("📊 직무별 최종 분포:")
    for category, count in sorted(category_counts.items()):
        print(f"   - {category}: {count}개")
    
    return database

if __name__ == "__main__":
    create_exact_law_database()