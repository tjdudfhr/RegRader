<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì´ˆê°„ë‹¨ ì´ë©”ì¼ í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: 'Malgun Gothic', sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f0f0f0;
        }
        .container {
            background: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            font-size: 28px;
            margin-bottom: 30px;
        }
        .input-group {
            margin: 20px 0;
        }
        label {
            display: block;
            font-weight: bold;
            margin-bottom: 5px;
            color: #555;
        }
        input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            box-sizing: border-box;
        }
        input:focus {
            border-color: #4CAF50;
            outline: none;
        }
        button {
            width: 100%;
            padding: 15px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 20px;
        }
        button:hover {
            background: #45a049;
        }
        button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        .result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 5px;
            display: none;
        }
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .help {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .help h3 {
            margin-top: 0;
            color: #856404;
        }
        .help-item {
            margin: 10px 0;
            padding: 10px;
            background: white;
            border-radius: 3px;
        }
        .help-item strong {
            color: #e74c3c;
        }
        .loading {
            display: none;
            text-align: center;
            color: #666;
            margin: 10px 0;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
</head>
<body>
    <div class="container">
        <h1>ğŸš€ ì´ˆê°„ë‹¨ ì´ë©”ì¼ í…ŒìŠ¤íŠ¸</h1>
        
        <div class="help">
            <h3>ğŸ“Œ EmailJSì—ì„œ ì´ 3ê°œ ê°’ì„ ì°¾ì•„ì„œ ì•„ë˜ì— ì…ë ¥í•˜ì„¸ìš”:</h3>
            <div class="help-item">
                <strong>Public Key</strong> = EmailJS ì‚¬ì´íŠ¸ â†’ Account â†’ API Keys â†’ Public Key
            </div>
            <div class="help-item">
                <strong>Service ID</strong> = EmailJS ì‚¬ì´íŠ¸ â†’ Email Services â†’ ì„œë¹„ìŠ¤ ì´ë¦„ ì˜†ì˜ ID (service_xxxxx)
            </div>
            <div class="help-item">
                <strong>Template ID</strong> = EmailJS ì‚¬ì´íŠ¸ â†’ Email Templates â†’ í…œí”Œë¦¿ ì´ë¦„ ì˜†ì˜ ID (template_xxxxx)
            </div>
        </div>

        <div class="input-group">
            <label>Public Key (ì˜ˆ: BH4k2m_XyZ9Lp3Q8R)</label>
            <input type="text" id="publicKey" placeholder="EmailJS Public Key ì…ë ¥">
        </div>

        <div class="input-group">
            <label>Service ID (ì˜ˆ: service_gmail)</label>
            <input type="text" id="serviceId" placeholder="EmailJS Service ID ì…ë ¥">
        </div>

        <div class="input-group">
            <label>Template ID (ì˜ˆ: template_law_monitor)</label>
            <input type="text" id="templateId" placeholder="EmailJS Template ID ì…ë ¥">
        </div>

        <div class="input-group">
            <label>ë°›ì„ ì´ë©”ì¼ ì£¼ì†Œ</label>
            <input type="email" id="toEmail" placeholder="test@example.com">
        </div>

        <button onclick="sendTestEmail()">í…ŒìŠ¤íŠ¸ ì´ë©”ì¼ ë³´ë‚´ê¸°</button>
        
        <div class="loading" id="loading">
            â³ ì´ë©”ì¼ ë³´ë‚´ëŠ” ì¤‘... ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”...
        </div>

        <div id="result" class="result"></div>
    </div>

    <script>
        function sendTestEmail() {
            // ì…ë ¥ê°’ ê°€ì ¸ì˜¤ê¸°
            const publicKey = document.getElementById('publicKey').value.trim();
            const serviceId = document.getElementById('serviceId').value.trim();
            const templateId = document.getElementById('templateId').value.trim();
            const toEmail = document.getElementById('toEmail').value.trim();
            
            // ì…ë ¥ê°’ í™•ì¸
            if (!publicKey || !serviceId || !templateId || !toEmail) {
                showResult('error', 'âŒ ëª¨ë“  í•­ëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!');
                return;
            }
            
            // ë²„íŠ¼ ë¹„í™œì„±í™” ë° ë¡œë”© í‘œì‹œ
            document.querySelector('button').disabled = true;
            document.getElementById('loading').style.display = 'block';
            document.getElementById('result').style.display = 'none';
            
            try {
                // EmailJS ì´ˆê¸°í™”
                emailjs.init(publicKey);
                
                // í…ŒìŠ¤íŠ¸ ë°ì´í„°
                const testData = {
                    to_email: toEmail,
                    to_name: "í…ŒìŠ¤íŠ¸ ì‚¬ìš©ì",
                    from_name: "ë²•ë ¹ ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ",
                    subject: "ë²•ë ¹ ëª¨ë‹ˆí„°ë§ í…ŒìŠ¤íŠ¸ ì´ë©”ì¼",
                    message: "ì´ë©”ì¼ì´ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•©ë‹ˆë‹¤!",
                    content: "ë²•ë ¹ ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€ì…ë‹ˆë‹¤.",
                    total_count: "259",
                    quarterly_summary: "1ë¶„ê¸°: 119ê±´, 2ë¶„ê¸°: 61ê±´, 3ë¶„ê¸°: 64ê±´, 4ë¶„ê¸°: 15ê±´",
                    job_summary: "ì•ˆì „ë³´ê±´: 50ê±´, í™˜ê²½: 45ê±´, ì†Œë°©: 30ê±´",
                    recent_laws: "ìµœê·¼ ê°œì • ë²•ë ¹ ëª©ë¡ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.",
                    // ì¶”ê°€ ë³€ìˆ˜ë“¤ (í…œí”Œë¦¿ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ëª¨ë“  ë³€ìˆ˜)
                    q1_count: "119",
                    q2_count: "61", 
                    q3_count: "64",
                    q4_count: "15",
                    safety_count: "50",
                    environment_count: "45",
                    fire_count: "30"
                };
                
                // ì´ë©”ì¼ ë°œì†¡
                emailjs.send(serviceId, templateId, testData)
                    .then(function(response) {
                        showResult('success', 
                            `âœ… ì´ë©”ì¼ ë°œì†¡ ì„±ê³µ!<br><br>` +
                            `ğŸ“§ ${toEmail} ì£¼ì†Œë¡œ ì´ë©”ì¼ì´ ë°œì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.<br>` +
                            `ì´ë©”ì¼í•¨ì„ í™•ì¸í•´ë³´ì„¸ìš”!<br><br>` +
                            `Status: ${response.status} - ${response.text}`
                        );
                    })
                    .catch(function(error) {
                        let errorMessage = 'âŒ ì´ë©”ì¼ ë°œì†¡ ì‹¤íŒ¨!<br><br>';
                        
                        if (error.text) {
                            if (error.text.includes('public key')) {
                                errorMessage += 'Public Keyê°€ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ í™•ì¸í•´ì£¼ì„¸ìš”.';
                            } else if (error.text.includes('service')) {
                                errorMessage += 'Service IDê°€ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ í™•ì¸í•´ì£¼ì„¸ìš”.';
                            } else if (error.text.includes('template')) {
                                errorMessage += 'Template IDê°€ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ í™•ì¸í•´ì£¼ì„¸ìš”.';
                            } else {
                                errorMessage += `ì˜¤ë¥˜: ${error.text}`;
                            }
                        } else {
                            errorMessage += 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
                        }
                        
                        showResult('error', errorMessage);
                        console.error('EmailJS Error:', error);
                    });
                    
            } catch (err) {
                showResult('error', `âŒ ì˜¤ë¥˜ ë°œìƒ: ${err.message}`);
                console.error('Error:', err);
            }
        }
        
        function showResult(type, message) {
            const resultDiv = document.getElementById('result');
            resultDiv.className = 'result ' + type;
            resultDiv.innerHTML = message;
            resultDiv.style.display = 'block';
            
            // ë²„íŠ¼ í™œì„±í™” ë° ë¡œë”© ìˆ¨ê¸°ê¸°
            document.querySelector('button').disabled = false;
            document.getElementById('loading').style.display = 'none';
        }
        
        // ì—”í„°í‚¤ë¡œ ì „ì†¡
        document.querySelectorAll('input').forEach(input => {
            input.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    sendTestEmail();
                }
            });
        });
    </script>
</body>
</html>