<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LAW WATCH ¬∑ AIÎ•º ÌôúÏö©Ìïú Î≤ïÍ∑ú Ï†úÍ∞úÏ†ï Î™®ÎãàÌÑ∞ÎßÅ ÏãúÏä§ÌÖú</title>
    <link rel="shortcut icon" href="data:text/plain;base64,üìä">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
    <style>
        :root {
            --primary: #667eea;
            --primary-light: #764ba2;
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary: #f093fb;
            --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --accent: #4facfe;
            --accent-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --success: #11998e;
            --success-gradient: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            --warning: #f093fb;
            --warning-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --danger: #fc466b;
            --danger-gradient: linear-gradient(135deg, #fc466b 0%, #3f5efb 100%);
            
            --glass-bg: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
            --glass-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
            
            --text-primary: #1a202c;
            --text-secondary: #4a5568;
            --text-muted: #718096;
            --text-white: #ffffff;
            
            --bg-primary: #f7fafc;
            --bg-secondary: #edf2f7;
            --bg-card: #ffffff;
            --bg-glass: rgba(255, 255, 255, 0.25);
            --border: #e2e8f0;
            --shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            
            --c-safety: #48bb78;
            --c-env: #38b2ac;
            --c-hr: #ed8936;
            --c-gov: #9f7aea;
            --c-fin: #4299e1;
            --c-sec: #f56565;
            --c-etc: #a0aec0;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --text-primary: #f7fafc;
                --text-secondary: #e2e8f0;
                --text-muted: #a0aec0;
                --bg-primary: #1a202c;
                --bg-secondary: #2d3748;
                --bg-card: #2d3748;
                --bg-glass: rgba(45, 55, 72, 0.25);
                --border: #4a5568;
                --glass-bg: rgba(45, 55, 72, 0.1);
            }
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            background-image: 
                radial-gradient(circle at 25% 25%, #667eea22 0%, transparent 50%),
                radial-gradient(circle at 75% 75%, #f093fb22 0%, transparent 50%);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 1rem;
        }

        /* Glassmorphism Header */
        .header {
            background: var(--primary-gradient);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 24px;
            padding: 3rem 2rem;
            margin-bottom: 2rem;
            text-align: center;
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-xl);
        }

        /* Settings Button */
        .settings-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 2;
            font-size: 1.2rem;
            color: white;
            text-decoration: none;
        }

        .settings-btn:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: scale(1.1);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: float 20s infinite linear;
        }

        @keyframes float {
            0% { transform: translate(-50%, -50%) rotate(0deg); }
            100% { transform: translate(-50%, -50%) rotate(360deg); }
        }

        .header h1 {
            font-size: 3rem;
            font-weight: 900;
            color: white;
            margin-bottom: 0.5rem;
            position: relative;
            z-index: 1;
            text-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .header .subtitle {
            font-size: 1.2rem;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 1.5rem;
            position: relative;
            z-index: 1;
        }

        .header .meta {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.8);
            position: relative;
            z-index: 1;
        }

        /* Quarterly View Styles */
        .quarterly-view {
            background: var(--bg-glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: var(--glass-shadow);
        }

        .filter-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .quarterly-tabs {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .quarterly-tab {
            background: var(--bg-card);
            border: 2px solid var(--border);
            border-radius: 16px;
            padding: 1.2rem;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            gap: 1rem;
            position: relative;
            overflow: hidden;
        }

        .quarterly-tab::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--primary-gradient);
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 0;
        }

        .quarterly-tab:hover::before {
            opacity: 0.05;
        }

        .quarterly-tab:hover {
            transform: translateY(-8px);
            border-color: var(--primary);
            box-shadow: 0 20px 40px rgba(102, 126, 234, 0.3);
        }

        .quarter-icon {
            font-size: 3rem;
            position: relative;
            z-index: 1;
        }

        .quarter-info {
            position: relative;
            z-index: 1;
            flex: 1;
        }

        .quarter-title {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }

        .quarter-period {
            font-size: 0.9rem;
            color: var(--text-muted);
            margin-bottom: 0.75rem;
        }

        .quarter-count {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--primary);
        }

        /* Business Filter */
        .business-filter {
            background: var(--bg-glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: var(--glass-shadow);
        }

        .filter-tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
        }

        .filter-tab {
            padding: 0.75rem 1.25rem;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 0.9rem;
            font-weight: 500;
            white-space: nowrap;
        }

        .filter-tab:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .filter-tab.active {
            background: var(--primary-gradient);
            color: white;
            border-color: transparent;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        /* Main Content */
        .main-content {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .chart-card {
            background: var(--bg-glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 1.5rem;
            box-shadow: var(--glass-shadow);
            min-width: 300px;
        }

        .chart-header {
            margin-bottom: 1rem;
        }

        .chart-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }

        .chart-container {
            height: 250px;
            position: relative;
        }

        .category-legend {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.8rem;
        }

        .legend-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            flex-shrink: 0;
        }

        /* Law List Card */
        .law-card {
            background: var(--bg-glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            overflow: hidden;
            box-shadow: var(--glass-shadow);
        }

        .law-list-header {
            background: var(--primary-gradient);
            color: white;
            padding: 1.5rem;
        }

        .law-list-title {
            font-size: 1.3rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .law-count {
            background: rgba(255, 255, 255, 0.2);
            padding: 0.25rem 0.75rem;
            border-radius: 15px;
            font-size: 0.8rem;
            margin-left: auto;
        }

        .search-container {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border);
        }

        .search-box {
            display: flex;
            align-items: center;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 0.75rem 1rem;
            gap: 0.75rem;
            transition: all 0.2s ease;
        }

        .search-box:focus-within {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .search-input {
            flex: 1;
            border: none;
            background: none;
            outline: none;
            font-size: 0.9rem;
            color: var(--text-primary);
        }

        .search-input::placeholder {
            color: var(--text-muted);
        }

        .law-list {
            max-height: 600px;
            overflow-y: auto;
        }

        .law-item {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .law-item:hover {
            background: rgba(102, 126, 234, 0.05);
        }

        .law-item-header {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            margin-bottom: 0.75rem;
        }

        .law-title {
            flex: 1;
            font-weight: 600;
            color: var(--text-primary);
            line-height: 1.4;
            cursor: pointer;
        }

        .law-title:hover {
            color: var(--primary);
        }

        .date-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            white-space: nowrap;
        }

        .date-badge.urgent {
            background: var(--danger-gradient);
            color: white;
        }

        .date-badge.soon {
            background: var(--accent-gradient);
            color: white;
        }

        .date-badge.active {
            background: var(--success-gradient);
            color: white;
        }

        .law-meta {
            display: flex;
            gap: 1rem;
            align-items: center;
            flex-wrap: wrap;
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .category-tags {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            margin-top: 0.5rem;
        }

        .category-tag {
            padding: 0.25rem 0.5rem;
            border-radius: 8px;
            font-size: 0.7rem;
            font-weight: 500;
        }

        .category-tag.hr { background: rgba(237, 137, 54, 0.1); color: var(--c-hr); }
        .category-tag.fair { background: rgba(56, 178, 172, 0.1); color: var(--c-env); }
        .category-tag.sec { background: rgba(245, 101, 101, 0.1); color: var(--c-sec); }
        .category-tag.ip { background: rgba(159, 122, 234, 0.1); color: var(--c-gov); }
        .category-tag.fin { background: rgba(66, 153, 225, 0.1); color: var(--c-fin); }
        .category-tag.safety { background: rgba(72, 187, 120, 0.1); color: var(--c-safety); }
        .category-tag.env { background: rgba(56, 217, 169, 0.1); color: var(--c-env); }
        .category-tag.gov { background: rgba(128, 90, 213, 0.1); color: var(--c-gov); }
        .category-tag.etc { background: rgba(160, 174, 192, 0.1); color: var(--c-etc); }

        /* Enhanced Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(8px);
            z-index: 2000;
            animation: modalFadeIn 0.3s ease;
        }

        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        @keyframes modalFadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.5);
            border-radius: 24px;
            max-width: 1400px;
            max-height: 95vh;
            width: 98vw;
            overflow: hidden;
            box-shadow: var(--shadow-xl);
            animation: modalSlideIn 0.3s ease;
            color: var(--text-primary);
        }

        @keyframes modalSlideIn {
            from { transform: scale(0.9) translateY(20px); opacity: 0; }
            to { transform: scale(1) translateY(0); opacity: 1; }
        }

        .modal-header {
            background: var(--primary-gradient);
            color: white;
            padding: 2rem;
            position: relative;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            line-height: 1.3;
        }

        .modal-subtitle {
            opacity: 0.9;
            font-size: 1rem;
            font-weight: 500;
        }

        .modal-close {
            position: absolute;
            top: 1.5rem;
            right: 1.5rem;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-close:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        .modal-body {
            padding: 2rem;
            max-height: 70vh;
            overflow-y: auto;
            background: rgba(255, 255, 255, 0.9);
            color: #2d3748;
        }

        .summary-section {
            margin-bottom: 1.5rem;
        }

        .summary-section h4 {
            color: var(--primary);
            margin-bottom: 0.75rem;
            font-weight: 600;
            font-size: 1.1rem;
        }

        .summary-section p {
            margin-bottom: 0.5rem;
            line-height: 1.5;
        }

        .summary-section strong {
            color: var(--text-primary);
        }

        .amendment-box {
            background: rgba(102, 126, 234, 0.08);
            border-left: 4px solid var(--primary);
            padding: 1rem;
            border-radius: 8px;
            margin: 0.5rem 0;
        }

        .amendment-box p {
            margin-bottom: 0.75rem;
            color: #2d3748;
            line-height: 1.5;
        }

        .amendment-box ul {
            margin-left: 1rem;
            color: #2d3748;
            padding-left: 1rem;
        }

        .amendment-box ul li {
            margin-bottom: 0.5rem;
            line-height: 1.4;
        }

        .amendment-box em {
            color: #718096;
            font-size: 0.9rem;
        }
        
        .external-links {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }
        
        .external-link {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: rgba(102, 126, 234, 0.05);
            border: 1px solid rgba(102, 126, 234, 0.1);
            border-radius: 12px;
            text-decoration: none;
            color: #2d3748;
            transition: all 0.2s ease;
        }
        
        .external-link:hover {
            background: rgba(102, 126, 234, 0.1);
            border-color: rgba(102, 126, 234, 0.3);
            transform: translateX(4px);
        }
        
        .link-icon {
            font-size: 1.5rem;
            flex-shrink: 0;
        }
        
        .link-content {
            flex: 1;
        }
        
        .link-title {
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 0.25rem;
        }
        
        .link-desc {
            font-size: 0.8rem;
            color: #718096;
        }
        
        .link-arrow {
            font-size: 1.2rem;
            color: var(--primary);
            font-weight: bold;
        }

        /* Modal animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }

        @keyframes slideIn {
            from { 
                opacity: 0;
                transform: scale(0.9) translateY(-20px);
            }
            to { 
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        /* Quarterly Filter Tabs (similar to business filter tabs) */
        .quarterly-filter-tab {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 0.8rem 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            color: var(--text-primary);
            text-decoration: none;
            margin: 0.25rem;
        }

        .quarterly-filter-tab:hover {
            background: var(--bg-secondary);
            border-color: var(--primary);
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.15);
        }

        .quarterly-filter-tab.active {
            background: var(--primary-gradient);
            color: var(--text-white);
            border-color: var(--primary);
            box-shadow: 0 2px 12px rgba(102, 126, 234, 0.25);
        }

        .quarterly-filter-tab.active span {
            color: var(--text-white);
        }

        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                flex-direction: row;
                overflow-x: auto;
            }
            
            .chart-card {
                min-width: 300px;
            }
        }

        .loading {
            text-align: center;
            padding: 3rem 2rem;
            color: var(--text-secondary);
        }

        .loading::before {
            content: '‚ö°';
            font-size: 2rem;
            display: block;
            margin-bottom: 1rem;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.7; }
        }

        .error {
            color: var(--danger);
            text-align: center;
            padding: 2rem;
            background: rgba(245, 101, 101, 0.1);
            border-radius: 12px;
            border: 1px solid rgba(245, 101, 101, 0.2);
        }



        /* Main Tab Navigation */
        .main-tab-navigation {
            background: var(--bg-glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 0.5rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow);
        }

        .main-tab-container {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 0.5rem;
        }

        .main-tab {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.8rem;
            padding: 1.2rem 1.5rem;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            font-size: 1rem;
            color: var(--text-secondary);
            background: transparent;
            border: 1px solid transparent;
        }

        .main-tab:hover {
            background: var(--glass-bg);
            color: var(--text-primary);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.15);
        }

        .main-tab.active {
            background: var(--primary-gradient);
            color: var(--text-white);
            border-color: var(--primary);
            box-shadow: 0 4px 16px rgba(102, 126, 234, 0.3);
        }

        .main-tab .tab-icon {
            font-size: 1.2rem;
        }

        .main-tab .tab-text {
            font-size: 0.95rem;
            white-space: nowrap;
        }

        /* Tab Content */
        .tab-content {
            position: relative;
        }

        .tab-pane {
            display: none;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.4s ease;
        }

        .tab-pane.active {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }

        /* Quarterly Detail Section - Sliding Animation */
        .quarterly-detail-section {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            margin-top: 1.5rem;
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            max-height: 0;
            opacity: 0;
        }

        .quarterly-detail-section.expanded {
            max-height: 2000px;
            opacity: 1;
            display: block !important;
        }

        .quarterly-detail-content {
            padding: 2rem;
        }

        /* Law Registry Tab Styles */
        .job-function-list {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .job-function-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            user-select: none;
        }

        .job-function-item:hover {
            background: var(--bg-secondary);
            border-color: var(--primary);
            transform: translateX(4px);
        }

        .job-function-item.active {
            background: var(--primary-gradient);
            color: white;
            border-color: transparent;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        .job-function-item .job-icon {
            font-size: 1.1rem;
            width: 1.5rem;
            text-align: center;
        }

        .job-function-item .job-name {
            flex: 1;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .job-function-item .job-count {
            background: var(--bg-glass);
            color: var(--text-secondary);
            padding: 0.2rem 0.6rem;
            border-radius: 10px;
            font-size: 0.8rem;
            font-weight: 700;
            min-width: 2rem;
            text-align: center;
        }

        .job-function-item.active .job-count {
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }

        .registry-law-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem 1.5rem;
            border-bottom: 1px solid var(--border);
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .registry-law-item:hover {
            background: var(--bg-secondary);
            transform: translateX(4px);
        }

        .registry-law-item:last-child {
            border-bottom: none;
        }

        .registry-law-number {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-muted);
            min-width: 2rem;
        }

        .registry-law-title {
            flex: 1;
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .registry-law-link {
            display: flex;
            align-items: center;
            gap: 0.3rem;
            font-size: 0.8rem;
            color: var(--primary);
            font-weight: 500;
        }

        .registry-law-link:hover {
            color: var(--primary-light);
        }

        /* Enhanced Quarterly Tab Selection */
        .quarterly-tab {
            transition: all 0.3s ease;
            position: relative;
        }

        .quarterly-tab.selected {
            background: var(--primary-gradient);
            color: var(--text-white);
            transform: scale(1.02);
            box-shadow: 0 8px 24px rgba(102, 126, 234, 0.3);
        }

        .quarterly-tab.selected .quarter-title,
        .quarterly-tab.selected .quarter-period,
        .quarterly-tab.selected .quarter-count {
            color: var(--text-white);
        }

        /* Detail Header */
        .quarterly-detail-header {
            background: var(--bg-glass);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border: 1px solid var(--glass-border);
        }

        .detail-title {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            margin-bottom: 0.8rem;
        }

        .detail-title h3 {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--text-primary);
            margin: 0;
            flex: 1;
        }

        .detail-icon {
            font-size: 1.6rem;
        }

        .close-detail-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--text-muted);
            cursor: pointer;
            padding: 0.2rem;
            border-radius: 6px;
            transition: all 0.2s ease;
        }

        .close-detail-btn:hover {
            background: var(--bg-secondary);
            color: var(--text-primary);
        }

        .detail-period {
            color: var(--text-secondary);
            font-size: 1rem;
            margin-bottom: 1rem;
        }

        .detail-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 1rem;
        }

        .stat-item {
            text-align: center;
            padding: 0.8rem;
            background: var(--bg-primary);
            border-radius: 8px;
            border: 1px solid var(--border);
        }

        .stat-number {
            display: block;
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 0.2rem;
        }

        .stat-label {
            font-size: 0.8rem;
            color: var(--text-muted);
            font-weight: 500;
        }

        /* Settings Modal Specific Styles */
        .settings-modal-content {
            max-width: 600px;
            width: 90vw;
        }

        .settings-form {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .form-label {
            font-weight: 600;
            color: var(--text-primary);
            font-size: 0.95rem;
        }

        .form-input {
            padding: 0.75rem 1rem;
            border: 2px solid var(--border);
            border-radius: 12px;
            font-size: 1rem;
            background: var(--bg-card);
            color: var(--text-primary);
            transition: all 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-textarea {
            min-height: 120px;
            resize: vertical;
            font-family: inherit;
        }

        .form-checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .form-checkbox {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .form-checkbox input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--primary);
        }

        .form-checkbox label {
            font-size: 0.95rem;
            color: var(--text-secondary);
        }

        .form-buttons {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
            margin-top: 1rem;
        }

        .btn-primary {
            background: var(--primary-gradient);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: var(--bg-secondary);
            color: var(--text-secondary);
            border: 2px solid var(--border);
            padding: 0.75rem 1.5rem;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-secondary:hover {
            background: var(--bg-card);
            border-color: var(--primary);
        }

        .notification-status {
            padding: 1rem;
            border-radius: 12px;
            margin-top: 1rem;
            font-size: 0.9rem;
        }

        .notification-status.success {
            background: rgba(72, 187, 120, 0.1);
            color: var(--c-safety);
            border: 1px solid rgba(72, 187, 120, 0.2);
        }

        .notification-status.error {
            background: rgba(245, 101, 101, 0.1);
            color: var(--c-sec);
            border: 1px solid rgba(245, 101, 101, 0.2);
        }

        .email-preview {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 1rem;
            margin-top: 1rem;
        }

        .email-preview h4 {
            margin: 0 0 0.5rem 0;
            color: var(--text-primary);
            font-size: 0.9rem;
        }

        .email-preview-content {
            font-size: 0.85rem;
            color: var(--text-secondary);
            line-height: 1.4;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Glassmorphism Header -->
        <div class="header">
            <button class="settings-btn" onclick="openSettingsModal()" title="Ïù¥Î©îÏùº ÏïåÎ¶º ÏÑ§Ï†ï">
                ‚öôÔ∏è
            </button>
            <h1>LAW WATCH</h1>
            <div class="subtitle">AIÎ•º ÌôúÏö©Ìïú Î≤ïÍ∑ú Ï†úÍ∞úÏ†ï Î™®ÎãàÌÑ∞ÎßÅ ÏãúÏä§ÌÖú</div>
            <div class="meta">
                <span id="year">2025</span>ÎÖÑ Î≤ïÎ†π Í∞úÏ†ï ÌòÑÌô© ¬∑ 
Ïã§Ï†ú ÎãπÏÇ¨ Ï†ÅÏö© Î≤ïÍ∑ú (207Í∞ú, 92Í∞ú 2025ÎÖÑ Îß§Ïπ≠) ¬∑ 
                ÏµúÏ¢Ö ÏóÖÎç∞Ïù¥Ìä∏: <span id="timestamp">Î°úÎî© Ï§ë...</span>
            </div>
        </div>

        <!-- Main Tab Navigation -->
        <div class="main-tab-navigation">
            <div class="main-tab-container">
                <div class="main-tab active" data-tab="quarterly" onclick="switchMainTab('quarterly')">
                    <span class="tab-icon">üìÖ</span>
                    <span class="tab-text">Î∂ÑÍ∏∞Î≥Ñ Í∞úÏ†ï ÌòÑÌô©</span>
                </div>
                <div class="main-tab" data-tab="business" onclick="switchMainTab('business')">
                    <span class="tab-icon">üè¢</span>
                    <span class="tab-text">ÏßÅÎ¨¥Î≥Ñ Í∞úÏ†ï ÌòÑÌô©</span>
                </div>
                <div class="main-tab" data-tab="lawregistry" onclick="switchMainTab('lawregistry')">
                    <span class="tab-icon">üìö</span>
                    <span class="tab-text">Ï†ÅÏö©Î≤ïÍ∑ú</span>
                </div>
            </div>
        </div>

        <!-- Tab Content Wrapper -->
        <div class="tab-content">
            <!-- Quarterly Tab Content -->
            <div class="tab-pane active" id="quarterly-content">
                <!-- Quarterly View -->
        <div class="quarterly-view">
            <!-- 2025ÎÖÑ Ï†ÑÏ≤¥ ÌòÑÌô© -->
            <div style="background: var(--bg-glass); backdrop-filter: blur(20px); border: 1px solid var(--glass-border); border-radius: 16px; padding: 1.2rem 1.5rem; margin-bottom: 1.5rem; box-shadow: var(--glass-shadow);">
                <div style="display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 1rem;">
                    <div style="display: flex; align-items: center; gap: 0.8rem;">
                        <span style="font-size: 1.3rem;">üìã</span>
                        <div>
                            <div style="font-size: 1.1rem; font-weight: 700; color: var(--text-primary);">2025ÎÖÑ Ï†ÑÏ≤¥ Í∞úÏ†ï ÌòÑÌô©</div>
                        </div>
                    </div>
                    <div style="display: flex; align-items: center; gap: 1.5rem; flex-wrap: wrap;">
                        <div style="text-align: center;">
                            <div style="font-size: 1.6rem; font-weight: 800; color: var(--primary);" id="total-law-count">0</div>
                            <div style="font-size: 0.8rem; color: var(--text-muted); font-weight: 500;">Ï¥ù Ï†ÅÏö© Î≤ïÍ∑ú</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 1.6rem; font-weight: 800; color: #48bb78;" id="implemented-law-count">0</div>
                            <div style="font-size: 0.8rem; color: var(--text-muted); font-weight: 500;">Í∞úÏ†ï ÏôÑÎ£å (Ïò¨Ìï¥)</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 1.6rem; font-weight: 800; color: #f093fb;" id="amendment-law-count">0</div>
                            <div style="font-size: 0.8rem; color: var(--text-muted); font-weight: 500;">Í∞úÏ†ï ÏòàÏ†ï</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="filter-title">
                üìÖ 2025ÎÖÑ Î∂ÑÍ∏∞Î≥Ñ Í∞úÏ†ï ÌòÑÌô©
            </div>
            <div class="quarterly-tabs">
                <div class="quarterly-tab" onclick="showQuarterlyDetail('Q1')">
                    <div class="quarter-icon">üå±</div>
                    <div class="quarter-info">
                        <div class="quarter-title">1Î∂ÑÍ∏∞</div>
                        <div class="quarter-period">(1~3Ïõî)</div>
                        <div class="quarter-count" id="q1-count">0</div>
                    </div>
                </div>
                <div class="quarterly-tab" onclick="showQuarterlyDetail('Q2')">
                    <div class="quarter-icon">‚òÄÔ∏è</div>
                    <div class="quarter-info">
                        <div class="quarter-title">2Î∂ÑÍ∏∞</div>
                        <div class="quarter-period">(4~6Ïõî)</div>
                        <div class="quarter-count" id="q2-count">0</div>
                    </div>
                </div>
                <div class="quarterly-tab" onclick="showQuarterlyDetail('Q3')">
                    <div class="quarter-icon">üçÇ</div>
                    <div class="quarter-info">
                        <div class="quarter-title">3Î∂ÑÍ∏∞</div>
                        <div class="quarter-period">(7~9Ïõî)</div>
                        <div class="quarter-count" id="q3-count">0</div>
                    </div>
                </div>
                <div class="quarterly-tab" onclick="showQuarterlyDetail('Q4')">
                    <div class="quarter-icon">‚ùÑÔ∏è</div>
                    <div class="quarter-info">
                        <div class="quarter-title">4Î∂ÑÍ∏∞</div>
                        <div class="quarter-period">(10~12Ïõî)</div>
                        <div class="quarter-count" id="q4-count">0</div>
                    </div>
                </div>
            </div>
                </div>
                
                <!-- Quarterly Detail Section (Sliding) -->
                <div class="quarterly-detail-section" id="quarterly-detail" style="display: none;">
                    <div class="quarterly-detail-content">
                        <!-- Dynamic quarterly content will be inserted here -->
                    </div>
                </div>
            </div>

            <!-- Business Tab Content -->
            <div class="tab-pane" id="business-content">
                <!-- Business Filter -->
        <div class="business-filter">
            <div class="filter-title">
                üè¢ ÏóÖÎ¨¥Î≥Ñ Î≤ïÎ†π ÌïÑÌÑ∞ÎßÅ
            </div>
            <div class="filter-tabs">
                <div class="filter-tab active" data-filter="all">Ï†ÑÏ≤¥ (<span id="count-all">0</span>)</div>
                <div class="filter-tab" data-filter="Ïù∏ÏÇ¨ÎÖ∏Î¨¥">üë• Ïù∏ÏÇ¨ÎÖ∏Î¨¥ (<span id="count-Ïù∏ÏÇ¨ÎÖ∏Î¨¥">0</span>)</div>
                <div class="filter-tab" data-filter="Í≥µÏ†ïÍ±∞Îûò">‚öñÔ∏è Í≥µÏ†ïÍ±∞Îûò (<span id="count-Í≥µÏ†ïÍ±∞Îûò">0</span>)</div>
                <div class="filter-tab" data-filter="Ï†ïÎ≥¥Î≥¥Ìò∏">üîí Ï†ïÎ≥¥Î≥¥Ìò∏ (<span id="count-Ï†ïÎ≥¥Î≥¥Ìò∏">0</span>)</div>
                <div class="filter-tab" data-filter="ÏßÄÏãùÏû¨ÏÇ∞Í∂å">üí° ÏßÄÏãùÏû¨ÏÇ∞ (<span id="count-ÏßÄÏãùÏû¨ÏÇ∞Í∂å">0</span>)</div>
                <div class="filter-tab" data-filter="Ïû¨Î¨¥ÌöåÍ≥Ñ">üí∞ Ïû¨Î¨¥ÌöåÍ≥Ñ (<span id="count-Ïû¨Î¨¥ÌöåÍ≥Ñ">0</span>)</div>
                <div class="filter-tab" data-filter="ÏïàÏ†Ñ">üõ°Ô∏è ÏïàÏ†Ñ/Î≥¥Í±¥ (<span id="count-ÏïàÏ†Ñ">0</span>)</div>
                <div class="filter-tab" data-filter="ÌôòÍ≤Ω">üå± ÌôòÍ≤Ω/ÏóêÎÑàÏßÄ (<span id="count-ÌôòÍ≤Ω">0</span>)</div>
                <div class="filter-tab" data-filter="ÏßÄÎ∞∞Íµ¨Ï°∞">üèõÔ∏è ÏßÄÎ∞∞Íµ¨Ï°∞ (<span id="count-ÏßÄÎ∞∞Íµ¨Ï°∞">0</span>)</div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Sidebar with Charts -->
            <div class="sidebar">
                <!-- Category Distribution Chart -->
                <div class="chart-card">
                    <div class="chart-header">
                        <div class="chart-title">üìà ÏóÖÎ¨¥ Î∂ÑÏïºÎ≥Ñ Î∂ÑÌè¨</div>
                    </div>
                    <div class="chart-container">
                        <canvas id="categoryChart"></canvas>
                    </div>
                    <div class="category-legend" id="categoryLegend">
                        <!-- Î≤îÎ°ÄÍ∞Ä Ïó¨Í∏∞Ïóê ÎèôÏ†ÅÏúºÎ°ú ÏÉùÏÑ±Îê©ÎãàÎã§ -->
                    </div>
                </div>

            </div>

            <!-- Law List -->
            <div class="law-card">
                <div class="law-list-header">
                    <div class="law-list-title">
                        üìã Í∞úÏ†ï Î≤ïÎ†π Î™©Î°ù
                        <div class="law-count" id="law-count">Î°úÎî© Ï§ë...</div>
                    </div>
                </div>
                
                <div class="search-container">
                    <div class="search-box">
                        <span>üîç</span>
                        <input type="text" class="search-input" id="searchInput" placeholder="Î≤ïÎ†πÎ™Ö, Î∂ÄÏ≤òÎ™ÖÏúºÎ°ú Í≤ÄÏÉâ...">
                        <button onclick="searchLaws()" style="background: none; border: none; color: var(--primary); cursor: pointer;">Í≤ÄÏÉâ</button>
                    </div>
                </div>

                <div class="law-list" id="law-list">
                    <div class="loading">Îç∞Ïù¥ÌÑ∞Î•º Î°úÎî© Ï§ëÏûÖÎãàÎã§...</div>
                </div>
            </div>
                </div>
            </div>

            <!-- Law Registry Tab Content -->
            <div class="tab-pane" id="lawregistry-content">
                <div class="law-registry-view">
                    <!-- Header -->
                    <div style="background: var(--bg-glass); backdrop-filter: blur(20px); border: 1px solid var(--glass-border); border-radius: 16px; padding: 1.2rem 1.5rem; margin-bottom: 1.5rem; box-shadow: var(--glass-shadow);">
                        <div style="display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 1rem;">
                            <div style="display: flex; align-items: center; gap: 0.8rem;">
                                <span style="font-size: 1.3rem;">üìö</span>
                                <div>
                                    <div style="font-size: 1.1rem; font-weight: 700; color: var(--text-primary);">Ï†ÅÏö©Î≤ïÍ∑ú(Î≤ïÍ∑úÎì±Î°ùÎ∂Ä)</div>
                                    <div style="font-size: 0.9rem; color: var(--text-muted);">ÏßÅÎ¨¥Î≥Ñ Ï†ÅÏö©ÎêòÎäî Î≤ïÍ∑ú Î¶¨Ïä§Ìä∏</div>
                                </div>
                            </div>
                            <div style="display: flex; align-items: center; gap: 1.5rem; flex-wrap: wrap;">
                                <div style="text-align: center;">
                                    <div style="font-size: 1.6rem; font-weight: 800; color: var(--primary);" id="registry-total-count">0</div>
                                    <div style="font-size: 0.8rem; color: var(--text-muted); font-weight: 500;">Ï¥ù Î≤ïÍ∑ú Ïàò</div>
                                </div>

                            </div>
                        </div>
                    </div>

                    <!-- Main Content with Sidebar and Panel -->
                    <div style="display: grid; grid-template-columns: 320px 1fr; gap: 1.5rem; min-height: 600px;">
                        <!-- Left Sidebar: Job Functions -->
                        <div style="background: var(--bg-glass); backdrop-filter: blur(20px); border: 1px solid var(--glass-border); border-radius: 16px; padding: 1.2rem; box-shadow: var(--glass-shadow);">
                            <div style="font-size: 1.1rem; font-weight: 700; color: var(--text-primary); margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                                <span>üëî</span> ÏßÅÎ¨¥ Î∂ÑÏïº
                            </div>
                            
                            <div class="job-function-list" id="job-function-list">
                                <div class="job-function-item active" data-job="all" onclick="showJobFunctionLaws('all', 'Ï†ÑÏ≤¥')">
                                    <span class="job-icon">üìã</span>
                                    <span class="job-name">Ï†ÑÏ≤¥</span>
                                    <span class="job-count" id="job-count-all">100</span>
                                </div>
                                <div class="job-function-item" data-job="Ïù∏ÏÇ¨ÎÖ∏Î¨¥" onclick="showJobFunctionLaws('Ïù∏ÏÇ¨ÎÖ∏Î¨¥', 'üë• Ïù∏ÏÇ¨ÎÖ∏Î¨¥')">
                                    <span class="job-icon">üë•</span>
                                    <span class="job-name">Ïù∏ÏÇ¨ÎÖ∏Î¨¥</span>
                                    <span class="job-count" id="job-count-Ïù∏ÏÇ¨ÎÖ∏Î¨¥">0</span>
                                </div>
                                <div class="job-function-item" data-job="Ï†ïÎ≥¥Î≥¥Ìò∏" onclick="showJobFunctionLaws('Ï†ïÎ≥¥Î≥¥Ìò∏', 'üîí Ï†ïÎ≥¥Î≥¥Ìò∏')">
                                    <span class="job-icon">üîí</span>
                                    <span class="job-name">Ï†ïÎ≥¥Î≥¥Ìò∏</span>
                                    <span class="job-count" id="job-count-Ï†ïÎ≥¥Î≥¥Ìò∏">0</span>
                                </div>
                                <div class="job-function-item" data-job="ÏïàÏ†Ñ" onclick="showJobFunctionLaws('ÏïàÏ†Ñ', 'üõ°Ô∏è ÏïàÏ†ÑÎ≥¥Í±¥')">
                                    <span class="job-icon">üõ°Ô∏è</span>
                                    <span class="job-name">ÏïàÏ†ÑÎ≥¥Í±¥</span>
                                    <span class="job-count" id="job-count-ÏïàÏ†Ñ">0</span>
                                </div>
                                <div class="job-function-item" data-job="ÌôòÍ≤Ω" onclick="showJobFunctionLaws('ÌôòÍ≤Ω', 'üå± ÌôòÍ≤ΩÏóêÎÑàÏßÄ')">
                                    <span class="job-icon">üå±</span>
                                    <span class="job-name">ÌôòÍ≤ΩÏóêÎÑàÏßÄ</span>
                                    <span class="job-count" id="job-count-ÌôòÍ≤Ω">0</span>
                                </div>
                                <div class="job-function-item" data-job="Ïû¨Î¨¥ÌöåÍ≥Ñ" onclick="showJobFunctionLaws('Ïû¨Î¨¥ÌöåÍ≥Ñ', 'üí∞ Ïû¨Î¨¥ÌöåÍ≥Ñ')">
                                    <span class="job-icon">üí∞</span>
                                    <span class="job-name">Ïû¨Î¨¥ÌöåÍ≥Ñ</span>
                                    <span class="job-count" id="job-count-Ïû¨Î¨¥ÌöåÍ≥Ñ">0</span>
                                </div>
                                <div class="job-function-item" data-job="Í≥µÏ†ïÍ±∞Îûò" onclick="showJobFunctionLaws('Í≥µÏ†ïÍ±∞Îûò', '‚öñÔ∏è Í≥µÏ†ïÍ±∞Îûò')">
                                    <span class="job-icon">‚öñÔ∏è</span>
                                    <span class="job-name">Í≥µÏ†ïÍ±∞Îûò</span>
                                    <span class="job-count" id="job-count-Í≥µÏ†ïÍ±∞Îûò">0</span>
                                </div>
                                <div class="job-function-item" data-job="ÏßÄÎ∞∞Íµ¨Ï°∞" onclick="showJobFunctionLaws('ÏßÄÎ∞∞Íµ¨Ï°∞', 'üèõÔ∏è ÏßÄÎ∞∞Íµ¨Ï°∞')">
                                    <span class="job-icon">üèõÔ∏è</span>
                                    <span class="job-name">ÏßÄÎ∞∞Íµ¨Ï°∞</span>
                                    <span class="job-count" id="job-count-ÏßÄÎ∞∞Íµ¨Ï°∞">0</span>
                                </div>
                                <div class="job-function-item" data-job="ÏßÄÏãùÏû¨ÏÇ∞Í∂å" onclick="showJobFunctionLaws('ÏßÄÏãùÏû¨ÏÇ∞Í∂å', 'üí° ÏßÄÏãùÏû¨ÏÇ∞')">
                                    <span class="job-icon">üí°</span>
                                    <span class="job-name">ÏßÄÏãùÏû¨ÏÇ∞</span>
                                    <span class="job-count" id="job-count-ÏßÄÏãùÏû¨ÏÇ∞Í∂å">0</span>
                                </div>
                            </div>
                        </div>

                        <!-- Right Panel: Laws for Selected Job Function -->
                        <div style="background: var(--bg-glass); backdrop-filter: blur(20px); border: 1px solid var(--glass-border); border-radius: 16px; overflow: hidden; box-shadow: var(--glass-shadow);">
                            <div style="padding: 1.2rem; background: var(--primary-gradient); color: white; display: flex; align-items: center; gap: 0.5rem;">
                                <span id="job-function-icon">üìã</span>
                                <h3 style="margin: 0; font-size: 1.1rem;" id="job-function-title">Ï†ÑÏ≤¥ Ï†ÅÏö© Î≤ïÍ∑ú</h3>
                                <div style="margin-left: auto; background: rgba(255, 255, 255, 0.2); padding: 0.25rem 0.75rem; border-radius: 15px; font-size: 0.8rem;" id="job-function-count">100Í±¥</div>
                            </div>
                            
                            <div style="max-height: 500px; overflow-y: auto; padding: 0;" id="job-function-laws">
                                <div style="padding: 2rem; text-align: center; color: var(--text-muted);">
                                    ÏôºÏ™ΩÏóêÏÑú ÏßÅÎ¨¥Î•º ÏÑ†ÌÉùÌïòÎ©¥ Ìï¥Îãπ Î≤ïÍ∑ú Î™©Î°ùÏù¥ ÌëúÏãúÎê©ÎãàÎã§.
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Enhanced Modal -->
    <div id="law-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title" id="modal-title">Î≤ïÎ†π Ï†úÎ™©</div>
                <div class="modal-subtitle" id="modal-subtitle">Î≤ïÎ†π Ï†ïÎ≥¥</div>
                <button class="modal-close" onclick="closeLawModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div id="modal-summary">
                    <!-- AI Ïä§ÌÉÄÏùº ÏöîÏïΩÏù¥ Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§ -->
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settings-modal" class="modal">
        <div class="modal-content settings-modal-content">
            <div class="modal-header">
                <div class="modal-title">Ïù¥Î©îÏùº ÏïåÎ¶º ÏÑ§Ï†ï</div>
                <div class="modal-subtitle">Î∂ÑÍ∏∞Î≥Ñ Î≤ïÎ†π Í∞úÏ†ï ÏïåÎ¶ºÏùÑ Î∞õÏúºÏÑ∏Ïöî</div>
                <button class="modal-close" onclick="closeSettingsModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form class="settings-form" id="email-settings-form">
                    <div class="form-group">
                        <label class="form-label" for="email-recipients">ÏàòÏã†Ïûê Ïù¥Î©îÏùº Ï£ºÏÜå</label>
                        <textarea 
                            class="form-input form-textarea" 
                            id="email-recipients" 
                            placeholder="example1@company.com&#10;example2@company.com&#10;example3@company.com&#10;&#10;Ïó¨Îü¨ Ïù¥Î©îÏùº Ï£ºÏÜåÎ•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî (Ìïú Ï§ÑÏóê ÌïòÎÇòÏî©)"
                        ></textarea>
                    </div>

                    <div class="form-group">
                        <label class="form-label">ÏïåÎ¶º Ï£ºÍ∏∞ ÏÑ§Ï†ï</label>
                        <div class="form-checkbox-group">
                            <div class="form-checkbox">
                                <input type="checkbox" id="notify-q1" checked>
                                <label for="notify-q1">Q1 ÏïåÎ¶º (12Ïõî ÎßàÏßÄÎßâ Ï£º - 1Î∂ÑÍ∏∞ ÏãúÌñâ Î≤ïÎ†π)</label>
                            </div>
                            <div class="form-checkbox">
                                <input type="checkbox" id="notify-q2" checked>
                                <label for="notify-q2">Q2 ÏïåÎ¶º (3Ïõî ÎßàÏßÄÎßâ Ï£º - 2Î∂ÑÍ∏∞ ÏãúÌñâ Î≤ïÎ†π)</label>
                            </div>
                            <div class="form-checkbox">
                                <input type="checkbox" id="notify-q3" checked>
                                <label for="notify-q3">Q3 ÏïåÎ¶º (6Ïõî ÎßàÏßÄÎßâ Ï£º - 3Î∂ÑÍ∏∞ ÏãúÌñâ Î≤ïÎ†π)</label>
                            </div>
                            <div class="form-checkbox">
                                <input type="checkbox" id="notify-q4" checked>
                                <label for="notify-q4">Q4 ÏïåÎ¶º (9Ïõî ÎßàÏßÄÎßâ Ï£º - 4Î∂ÑÍ∏∞ ÏãúÌñâ Î≤ïÎ†π)</label>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="sender-name">Î∞úÏÜ°Ïûê Ïù¥Î¶Ñ</label>
                        <input 
                            type="text" 
                            class="form-input" 
                            id="sender-name" 
                            placeholder="Î≤ïÎ¨¥ÌåÄ" 
                            value="LAW WATCH ÏãúÏä§ÌÖú"
                        >
                    </div>

                    <div class="email-preview" id="email-preview">
                        <h4>üìß Ïù¥Î©îÏùº ÎØ∏Î¶¨Î≥¥Í∏∞</h4>
                        <div class="email-preview-content" id="email-preview-content">
                            ÏÑ§Ï†ïÏùÑ ÏôÑÎ£åÌïòÎ©¥ Ïó¨Í∏∞Ïóê Ïù¥Î©îÏùº ÎØ∏Î¶¨Î≥¥Í∏∞Í∞Ä ÌëúÏãúÎê©ÎãàÎã§.
                        </div>
                    </div>

                    <div class="form-buttons">
                        <button type="button" class="btn-secondary" onclick="testEmailSending()">ÌÖåÏä§Ìä∏ Î∞úÏÜ°</button>
                        <button type="button" class="btn-primary" onclick="saveEmailSettings()">ÏÑ§Ï†ï Ï†ÄÏû•</button>
                    </div>

                    <div id="notification-status"></div>
                </form>
            </div>
        </div>
    </div>

    <!-- Quarterly Modal -->
    <div id="quarterly-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title" id="quarterly-modal-title">Î∂ÑÍ∏∞Î≥Ñ Í∞úÏ†ï Î≤ïÎ†π</div>
                <div class="modal-subtitle" id="quarterly-modal-subtitle">Î∂ÑÍ∏∞ Ï†ïÎ≥¥</div>
                <button class="modal-close" onclick="closeQuarterlyModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div id="quarterly-summary" class="quarterly-summary">
                    <!-- Î∂ÑÍ∏∞Î≥Ñ ÏöîÏïΩ Ï†ïÎ≥¥ -->
                </div>
                <div id="quarterly-law-list" class="quarterly-law-list">
                    <!-- Î∂ÑÍ∏∞Î≥Ñ Î≤ïÎ†π Î¶¨Ïä§Ìä∏ -->
                </div>
            </div>
        </div>
    </div>

    <script>
    
        // 2025ÎÖÑ 100% Ï†ïÌôïÌïú Îß§Ïπ≠ Îêú 92Í∞ú Î≤ïÍ∑ú (207Í∞ú Ï§ë 44.4% Îß§Ïπ≠)
        const matched2025LawData = {
            "total_laws": 207,
            "matched_2025": 92,
            "matching_rate": 44.4,
            "description": "2025ÎÖÑ Ïã§Ï†ú ÏãúÌñâ Îß§Ïπ≠ Î≤ïÍ∑ú",
            "by_quarter": {
                "Q1": 10,
                "Q2": 28,
                "Q3": 40,
                "Q4": 14
            },
            "by_category": {
                "ÌôòÍ≤Ω": 30,
                "Ïù∏ÏÇ¨ÎÖ∏Î¨¥": 9,
                "ÏïàÏ†Ñ": 21,
                "Ïû¨Î¨¥ÌöåÍ≥Ñ": 15,
                "Ï†ïÎ≥¥Î≥¥Ìò∏": 7,
                "Í≥µÏ†ïÍ±∞Îûò": 3,
                "ÏßÄÏãùÏû¨ÏÇ∞Í∂å": 4,
                "ÏßÄÎ∞∞Íµ¨Ï°∞": 3
            },
            "coverage": "100% Ï†ïÌôïÌïú Ï†úÎ™© Îß§Ïπ≠",
            "source": "Íµ≠Í∞ÄÎ≤ïÎ†πÏ†ïÎ≥¥ÏÑºÌÑ∞ 2025ÎÖÑ Ïã§Ï†ú Îç∞Ïù¥ÌÑ∞"
        };
        
        // Ï£ºÏöî Îç∞Ïù¥ÌÑ∞ Ï∞∏Ï°∞ - 2025ÎÖÑ Îß§Ïπ≠Îêú Î≤ïÍ∑ú ÏÇ¨Ïö©
        const mainData = matched2025LawData;

        // Í∏∞Ï°¥ 66Í∞ú ÏïΩÏπ≠ Îß§Ïπ≠ Îç∞Ïù¥ÌÑ∞Îäî 207Í∞ú Ïã§Ï†ú Ï†ÅÏö© Î≤ïÍ∑úÎ°ú ÏôÑÏ†Ñ ÎåÄÏ≤¥Îê®

        // 66Í∞ú Ï†ïÌôïÌïú ÏïΩÏπ≠ Îß§Ïπ≠ Îç∞Ïù¥ÌÑ∞Îßå ÏÇ¨Ïö© (Îã®ÏàúÌôî ÏôÑÎ£å)
        
        // loadFinalPreciseLawsData Ìï®Ïàò Ï†úÍ±∞Îê® - 66Í∞ú ÏïΩÏπ≠ Îß§Ïπ≠ Îç∞Ïù¥ÌÑ∞Îßå ÏÇ¨Ïö©
        
        // 100% Ï†ïÌôïÌïú Î∂ÑÍ∏∞Î≥Ñ Îç∞Ïù¥ÌÑ∞Î°ú ÏóÖÎç∞Ïù¥Ìä∏ÌïòÎäî Ìï®Ïàò  
        function updateQuarterlyDataWithFinalPrecise() {
            // 2025ÎÖÑ Ïã§Ï†ú Îß§Ïπ≠ Îç∞Ïù¥ÌÑ∞ ÏÇ¨Ïö©
            const quarterCounts = matched2025LawData.by_quarter;
            
            // Í∞Å Î∂ÑÍ∏∞ Î∞ïÏä§Ïùò ÏàòÏπò ÏóÖÎç∞Ïù¥Ìä∏
            document.querySelector('#q1-count').textContent = quarterCounts.Q1 || 0;
            document.querySelector('#q2-count').textContent = quarterCounts.Q2 || 0;
            document.querySelector('#q3-count').textContent = quarterCounts.Q3 || 0;
            document.querySelector('#q4-count').textContent = quarterCounts.Q4 || 0;
            
            console.log('‚úÖ 100% Ï†ïÌôïÌïú Î∂ÑÍ∏∞Î≥Ñ Îç∞Ïù¥ÌÑ∞ ÏóÖÎç∞Ïù¥Ìä∏ ÏôÑÎ£å:', quarterCounts);
        }
        
        // Ïã§Ï†ú ÎãπÏÇ¨ Ï†ÅÏö© Î≤ïÍ∑ú ÏßÅÎ¨¥Î≥Ñ Îç∞Ïù¥ÌÑ∞Î°ú ÏóÖÎç∞Ïù¥Ìä∏ÌïòÎäî Ìï®Ïàò (Ï†ÑÏ≤¥ 207Í∞ú Í∏∞Ï§Ä)
        function updateJobFunctionDataWithCompanyLaws() {
            // 3Î≤àÏß∏ ÌÉ≠ÏùÄ Ï†ÑÏ≤¥ 207Í∞ú Ï†ÅÏö©Î≤ïÍ∑úÎ•º ÌëúÏãúÌï¥Ïïº ÌïòÎØÄÎ°ú ÏõêÎ≥∏ Ïπ¥ÌÖåÍ≥†Î¶¨ Îç∞Ïù¥ÌÑ∞ ÏÇ¨Ïö©
            const fullCategoryData = {
                "ÌôòÍ≤Ω": 65,
                "Ïù∏ÏÇ¨ÎÖ∏Î¨¥": 41,
                "ÏïàÏ†Ñ": 41,
                "Ïû¨Î¨¥ÌöåÍ≥Ñ": 19,
                "Ï†ïÎ≥¥Î≥¥Ìò∏": 16,
                "Í≥µÏ†ïÍ±∞Îûò": 11,
                "ÏßÄÏãùÏû¨ÏÇ∞Í∂å": 7,
                "ÏßÄÎ∞∞Íµ¨Ï°∞": 7
            };
            
            // Í∞Å ÏßÅÎ¨¥Î≥Ñ Ïπ¥Ïö¥Ìä∏ ÏóÖÎç∞Ïù¥Ìä∏ (Ï†ÑÏ≤¥ 207Í∞ú Í∏∞Ï§Ä)
            Object.keys(fullCategoryData).forEach(category => {
                const countElement = document.querySelector(`#job-count-${category}`);
                if (countElement) {
                    countElement.textContent = fullCategoryData[category] || 0;
                }
            });
            
            // Ï†ÑÏ≤¥ Ïπ¥Ïö¥Ìä∏ÎèÑ ÏóÖÎç∞Ïù¥Ìä∏
            const allCountElement = document.querySelector('#job-count-all');
            if (allCountElement) {
                allCountElement.textContent = 207;
            }
            
            console.log('‚úÖ 207Í∞ú Ïã§Ï†ú ÎãπÏÇ¨ Ï†ÅÏö© Î≤ïÍ∑ú ÏßÅÎ¨¥Î≥Ñ Îç∞Ïù¥ÌÑ∞ ÏóÖÎç∞Ïù¥Ìä∏ ÏôÑÎ£å:', fullCategoryData);
        }
        
        // 100% Ï†ïÌôïÌïú Î©îÏù∏ ÎåÄÏãúÎ≥¥Îìú ÏàòÏπò ÏóÖÎç∞Ïù¥Ìä∏ Ìï®Ïàò
        function updateMainDashboardWithCompanyLaws() {
            // Ï¥ù Ï†ÅÏö© Î≤ïÍ∑ú (207Í∞ú Ïã§Ï†ú ÎãπÏÇ¨ Ï†ÅÏö© Î≤ïÍ∑ú)
            const totalAppliedElements = document.querySelectorAll('.metric-number');
            if (totalAppliedElements.length > 0) {
                totalAppliedElements[0].textContent = 207; // Ï†ÑÏ≤¥ ÎãπÏÇ¨ Ï†ÅÏö© Î≤ïÍ∑ú
            }
            
            // Í∞úÏ†ï ÏòàÏ†ï Î≤ïÍ∑ú (ÏãúÌñâ ÏòàÏ†ï)
            if (totalAppliedElements.length > 1) {
                totalAppliedElements[1].textContent = 153; // 207 - 54 = 153Í∞ú ÏòàÏ†ï Î≤ïÎ†π
            }
            
            console.log(`‚úÖ Ïã§Ï†ú ÎãπÏÇ¨ Ï†ÅÏö© Î≤ïÍ∑ú ÎåÄÏãúÎ≥¥Îìú ÏóÖÎç∞Ïù¥Ìä∏: Ï¥ù 207Í±¥`);
        }
        
        // 2025ÎÖÑ 92Í∞ú Îß§Ïπ≠Îêú Î≤ïÍ∑úÎ°ú ÏóÖÎç∞Ïù¥Ìä∏ÌïòÎäî Ìï®Ïàò
        function updateWith2025MatchedData() {
            const quarterCounts = matched2025LawData.by_quarter;
            
            // Í∞Å Î∂ÑÍ∏∞ Î∞ïÏä§Ïùò ÏàòÏπò ÏóÖÎç∞Ïù¥Ìä∏ (Ïã§Ï†ú 2025ÎÖÑ ÏãúÌñâ Îç∞Ïù¥ÌÑ∞)
            document.querySelector('#q1-count').textContent = quarterCounts.Q1 || 0;
            document.querySelector('#q2-count').textContent = quarterCounts.Q2 || 0;
            document.querySelector('#q3-count').textContent = quarterCounts.Q3 || 0;
            document.querySelector('#q4-count').textContent = quarterCounts.Q4 || 0;
            
            // Î©îÏù∏ ÎåÄÏãúÎ≥¥Îìú ÏàòÏπò ÏóÖÎç∞Ïù¥Ìä∏
            const totalAppliedElements = document.querySelectorAll('.metric-number');
            if (totalAppliedElements.length > 0) {
                totalAppliedElements[0].textContent = matched2025LawData.matched_2025;
            }
            if (totalAppliedElements.length > 1) {
                totalAppliedElements[1].textContent = Math.floor(matched2025LawData.matched_2025 * 0.7); // ÏãúÌñâ ÏôÑÎ£å (Ï∂îÏÇ∞ 70%)
            }
            
            // 2025ÎÖÑ Ïã§Ï†ú Îß§Ïπ≠ Ï†ïÎ≥¥ ÏóÖÎç∞Ïù¥Ìä∏ (ÏΩòÏÜîÏóê Ï∂úÎ†•)
            console.log(`üéØ 92Í∞ú 2025ÎÖÑ Ïã§Ï†ú ÏãúÌñâ Î≤ïÍ∑ú Îß§Ïπ≠ Ï†ÅÏö© ÏôÑÎ£å!`);
            console.log(`üìä Îß§Ïπ≠Î•†: ${matched2025LawData.matching_rate}% (${matched2025LawData.matched_2025}/${matched2025LawData.total_laws})`);
            console.log(`üìÖ Î∂ÑÍ∏∞Î≥Ñ ÏãúÌñâ ÌòÑÌô©:`, quarterCounts);
            console.log(`üìã ÏßÅÎ¨¥Î≥Ñ Îß§Ïπ≠ ÌòÑÌô©:`);
            Object.entries(matched2025LawData.by_category).forEach(([category, count]) => {
                console.log(`   - ${category}: ${count}Í∞ú`);
            });
            console.log(`üéØ Îç∞Ïù¥ÌÑ∞ ÏÜåÏä§: ${matched2025LawData.source}`);
        }

        // Ï†ïÌôïÌïú 2025ÎÖÑ Î≤ïÎ†πÎßå ÌïÑÌÑ∞ÎßÅÌïòÎäî Ìï®Ïàò - Remote version preserved
        function filterPreciseMatchedLaws() {
            const matchedLawTitles = new Set(preciseLawsData.map(law => law.title));
            return lawsData.filter(law => matchedLawTitles.has(law.title));
        }
        
        // 100% Ï†ïÌôïÌïú Î∂ÑÍ∏∞Î≥Ñ Î≤ïÎ†π ÌëúÏãú Ìï®Ïàò
        function showQuarterDetailsWithFinalPrecise(quarter) {
            const quarterLaws = preciseLawsData.filter(law => {
                const date = new Date(law.effectiveDate);
                const month = date.getMonth() + 1;
                
                switch(quarter) {
                    case 'Q1': return month >= 1 && month <= 3;
                    case 'Q2': return month >= 4 && month <= 6;
                    case 'Q3': return month >= 7 && month <= 9;
                    case 'Q4': return month >= 10 && month <= 12;
                    default: return false;
                }
            });
            
            console.log(`${quarter} 100% Ï†ïÌôïÌïú Î≤ïÎ†π ${quarterLaws.length}Í∞ú ÌëúÏãú`);
            return quarterLaws;
        }
    

        const categoryColors = {
            'ÏïàÏ†Ñ': '#48bb78',
            'ÌôòÍ≤Ω': '#38b2ac', 
            'Ïù∏ÏÇ¨ÎÖ∏Î¨¥': '#ed8936',
            'ÏßÄÎ∞∞Íµ¨Ï°∞': '#9f7aea',
            'Ïû¨Î¨¥ÌöåÍ≥Ñ': '#4299e1',
            'Ï†ïÎ≥¥Î≥¥Ìò∏': '#f56565',
            'Í∏∞ÌÉÄ': '#a0aec0'
        };

        let lawsData = [];
        let filteredLaws = [];
        let currentFilter = 'all';
        let categoryChart;
        let currentMainTab = 'quarterly';
        let currentQuarterlyDetail = null;

        // Tab switching function
        function switchMainTab(tabName) {
            console.log('Switching to tab:', tabName);
            currentMainTab = tabName;

            // Update tab buttons
            document.querySelectorAll('.main-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');

            // Update tab content
            document.querySelectorAll('.tab-pane').forEach(pane => {
                pane.classList.remove('active');
            });
            
            setTimeout(() => {
                document.getElementById(`${tabName}-content`).classList.add('active');
            }, 100);

            // Close quarterly detail if switching away from quarterly tab
            if (tabName !== 'quarterly' && currentQuarterlyDetail) {
                closeQuarterlyDetail();
            }
        }

        function showQuarterlyDetail(quarter) {
            console.log('üéØ showQuarterlyDetail Ìï®Ïàò Ìò∏Ï∂ú:', quarter);
            
            const quarterInfo = {
                'Q1': { title: '1Î∂ÑÍ∏∞ Í∞úÏ†ï Î≤ïÎ†π', period: '2025ÎÖÑ 1~3Ïõî', months: [1, 2, 3], icon: 'üå±' },
                'Q2': { title: '2Î∂ÑÍ∏∞ Í∞úÏ†ï Î≤ïÎ†π', period: '2025ÎÖÑ 4~6Ïõî', months: [4, 5, 6], icon: '‚òÄÔ∏è' },
                'Q3': { title: '3Î∂ÑÍ∏∞ Í∞úÏ†ï Î≤ïÎ†π', period: '2025ÎÖÑ 7~9Ïõî', months: [7, 8, 9], icon: 'üçÇ' },
                'Q4': { title: '4Î∂ÑÍ∏∞ Í∞úÏ†ï Î≤ïÎ†π', period: '2025ÎÖÑ 10~12Ïõî', months: [10, 11, 12], icon: '‚ùÑÔ∏è' }
            };
            
            const info = quarterInfo[quarter];
            if (!info) {
                console.error('‚ùå Î∂ÑÍ∏∞ Ï†ïÎ≥¥Î•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§:', quarter);
                return;
            }
            
            console.log('‚úÖ Î∂ÑÍ∏∞ Ï†ïÎ≥¥ ÌôïÏù∏:', info.title);

            // Update visual selection
            document.querySelectorAll('.quarterly-tab').forEach(tab => {
                tab.classList.remove('selected');
            });
            // ÌÅ¥Î¶≠Îêú Î∂ÑÍ∏∞ÌÉ≠Ïóê selected ÌÅ¥ÎûòÏä§ Ï∂îÍ∞Ä
            const clickedTab = document.querySelector(`.quarterly-tab[onclick*="${quarter}"]`);
            if (clickedTab) {
                clickedTab.classList.add('selected');
            }

            // 2025ÎÖÑ Îß§Ïπ≠Îêú Î≤ïÍ∑ú Îç∞Ïù¥ÌÑ∞Î•º ÎèôÏ†ÅÏúºÎ°ú Î°úÎìúÌïòÏó¨ Î∂ÑÍ∏∞Î≥Ñ ÌïÑÌÑ∞ÎßÅ
            console.log('üì° quarterly_details.json ÏöîÏ≤≠ ÏãúÏûë...');
            fetch('quarterly_details.json')
                .then(response => {
                    console.log('üì° Response status:', response.status);
                    if (!response.ok) throw new Error('Îç∞Ïù¥ÌÑ∞ Î°úÎìú Ïã§Ìå®');
                    return response.json();
                })
                .then(quarterlyData => {
                    console.log('‚úÖ quarterly_details.json Î°úÎìú ÏÑ±Í≥µ');
                    const quarterLaws = quarterlyData.quarters[quarter].laws || [];
                    console.log('üìã ' + quarter + ' Î∂ÑÍ∏∞ Î≤ïÎ†π Ïàò:', quarterLaws.length + 'Í∞ú');
                    continueShowQuarterlyDetail(quarter, info, quarterLaws);
                })
                .catch(error => {
                    console.error('‚ùå Î∂ÑÍ∏∞Î≥Ñ Îç∞Ïù¥ÌÑ∞ Î°úÎìú Ïã§Ìå®:', error);
                    // Ìè¥Î∞±: matched2025LawDataÏóêÏÑú ÏòàÏÉÅ Í∞úÏàò ÌëúÏãú
                    const quarterCount = matched2025LawData.by_quarter[quarter] || 0;
                    console.log('üîÑ Ìè¥Î∞± Îç∞Ïù¥ÌÑ∞ ÏÇ¨Ïö©, Î≤ïÎ†π Ïàò:', quarterCount);
                    const fallbackLaws = Array(quarterCount).fill().map((_, index) => ({
                        title: `${quarter} ÏãúÌñâ Î≤ïÎ†π ${index + 1}`,
                        effective_date: quarter === 'Q1' ? '2025-03-01' : quarter === 'Q2' ? '2025-06-01' : quarter === 'Q3' ? '2025-09-01' : '2025-12-01',
                        categories: ['ÌôòÍ≤Ω'],
                        ministry: 'Í¥ÄÍ≥ÑÎ∂ÄÏ≤ò',
                        law_type: 'ÏùºÎ∂ÄÍ∞úÏ†ï',
                        detail_url: 'https://www.law.go.kr'
                    }));
                    continueShowQuarterlyDetail(quarter, info, fallbackLaws);
                });
        }
        
        function continueShowQuarterlyDetail(quarter, info, quarterLaws) {
            console.log('üöÄ continueShowQuarterlyDetail Ìò∏Ï∂ú:', quarter, 'Î≤ïÎ†π Ïàò:', quarterLaws.length);
            // Call the existing showQuarterlyModal function to display the quarterly details
            showQuarterlyModal(quarter, info, quarterLaws);
        }
        
        function showQuarterlyModal(quarter, info, quarterLaws) {
            console.log('üì± showQuarterlyModal Ìò∏Ï∂ú ÏãúÏûë:', quarter);
            
            // Generate detailed content with business categories and law list
            const categoryIcons = {
                'Ïù∏ÏÇ¨ÎÖ∏Î¨¥': 'üë•',
                'Í≥µÏ†ïÍ±∞Îûò': '‚öñÔ∏è',
                'Ï†ïÎ≥¥Î≥¥Ìò∏': 'üîí',
                'ÏßÄÏãùÏû¨ÏÇ∞Í∂å': 'üí°',
                'Ïû¨Î¨¥ÌöåÍ≥Ñ': 'üí∞',
                'ÏïàÏ†Ñ': 'üõ°Ô∏è',
                'ÌôòÍ≤Ω': 'üå±',
                'ÏßÄÎ∞∞Íµ¨Ï°∞': 'üèõÔ∏è'
            };

            // Ïπ¥ÌÖåÍ≥†Î¶¨Î≥Ñ Î≤ïÎ†π Í∑∏Î£πÌôî
            const lawsByCategory = {};
            quarterLaws.forEach(law => {
                if (law.categories && law.categories.length > 0) {
                    law.categories.forEach(category => {
                        if (!lawsByCategory[category]) lawsByCategory[category] = [];
                        lawsByCategory[category].push(law);
                    });
                }
            });

            // ÏßÅÎ¨¥Î≥Ñ Í∞úÏöî ÏÉùÏÑ± (Ìïú Ï§Ñ)
            const businessOverview = Object.keys(lawsByCategory).map(category => {
                const count = lawsByCategory[category].length;
                return `<span style="display: inline-flex; align-items: center; gap: 0.3rem; margin-right: 1rem; color: var(--text-secondary); font-size: 0.9rem;"><span>${categoryIcons[category] || 'üìã'}</span><span>${category}</span><span style="color: var(--primary); font-weight: 600;">${count}Í±¥</span></span>`;
            }).join('');

            // Î≤ïÎ†π Î™©Î°ù HTML ÏÉùÏÑ± (ÏÉàÎ°úÏö¥ Îç∞Ïù¥ÌÑ∞ Íµ¨Ï°∞ Î∞òÏòÅ)
            const lawListHtml = quarterLaws.map(item => {
                const effectiveDate = item.effective_date || item.effectiveDate || 'ÎØ∏Ï†ï';
                const daysUntil = getDaysFromNow(effectiveDate);
                let dateClass = 'active';
                let dateText = effectiveDate;
                
                if (daysUntil > 0) {
                    if (daysUntil <= 7) {
                        dateClass = 'urgent';
                        dateText = `D-${daysUntil}`;
                    } else if (daysUntil <= 30) {
                        dateClass = 'soon';
                        dateText = `D-${daysUntil}`;
                    } else {
                        dateClass = 'soon';
                        dateText = effectiveDate;
                    }
                }

                // ÎßÅÌÅ¨ URL ÏÉùÏÑ±
                const lawUrl = item.detail_url || item.search_url || `https://www.law.go.kr/lsSc.do?query=${encodeURIComponent(item.title)}`;

                return `
                    <div class="law-item" onclick="showQuarterlyLawModal('${item.title.replace(/'/g, "\\'")}', '${lawUrl}')" style="cursor: pointer;">
                        <div class="law-item-header">
                            <div class="law-title">${item.title || 'Ï†úÎ™© ÏóÜÏùå'}</div>
                            <div class="date-badge ${dateClass}">${dateText}</div>
                        </div>
                        <div class="law-meta">
                            <div class="meta-item">
                                <span>üèõÔ∏è</span>
                                <span>${item.ministry || 'Í¥ÄÍ≥ÑÎ∂ÄÏ≤ò'}</span>
                            </div>
                            <div class="meta-item">
                                <span>üìÑ</span>
                                <span>${item.law_type || 'ÏùºÎ∂ÄÍ∞úÏ†ï'}</span>
                            </div>
                            <div class="meta-item">
                                <span>üîó</span>
                                <span style="color: var(--primary);">Î≤ïÎ†πÏ†ïÎ≥¥</span>
                            </div>
                        </div>
                    </div>`;
            }).join('');

            // Generate chart data for this quarter
            const categoryColors = {
                'Ïù∏ÏÇ¨ÎÖ∏Î¨¥': '#e53e3e',      // Îπ®Í∞ÑÏÉâ Í≥ÑÏó¥
                'Í≥µÏ†ïÍ±∞Îûò': '#3182ce',      // ÌååÎûÄÏÉâ Í≥ÑÏó¥  
                'Ï†ïÎ≥¥Î≥¥Ìò∏': '#805ad5',      // Î≥¥ÎùºÏÉâ Í≥ÑÏó¥
                'ÏßÄÏãùÏû¨ÏÇ∞Í∂å': '#d69e2e',      // ÎÖ∏ÎûÄÏÉâ Í≥ÑÏó¥
                'Ïû¨Î¨¥ÌöåÍ≥Ñ': '#38a169',      // Ï¥àÎ°ùÏÉâ Í≥ÑÏó¥
                'ÏïàÏ†Ñ': '#dd6b20',      // Ï£ºÌô©ÏÉâ Í≥ÑÏó¥
                'ÌôòÍ≤Ω': '#319795',    // Ï≤≠Î°ùÏÉâ Í≥ÑÏó¥
                'ÏßÄÎ∞∞Íµ¨Ï°∞': '#9f7aea'       // ÏûêÏ£ºÏÉâ Í≥ÑÏó¥
            };

            // Create business filter tabs for this quarter (similar to business tab)
            const allCount = quarterLaws.length;
            const businessFilterTabs = [
                `<div class="quarterly-filter-tab active" data-quarter="${quarter}" data-filter="all" onclick="filterQuarterlyLaws('${quarter}', 'all')">
                    Ï†ÑÏ≤¥ (<span>${allCount}</span>)
                </div>`,
                ...Object.keys(lawsByCategory).map(category => {
                    const count = lawsByCategory[category].length;
                    const icon = categoryIcons[category] || 'üìã';
                    return `<div class="quarterly-filter-tab" data-quarter="${quarter}" data-filter="${category}" onclick="filterQuarterlyLaws('${quarter}', '${category}')">
                        ${icon} ${category} (<span>${count}</span>)
                    </div>`;
                })
            ].join('');

            const detailContent = `
                <div class="quarterly-detail-header">
                    <div class="detail-title">
                        <span class="detail-icon">${info.icon}</span>
                        <h3>${info.title}</h3>
                        <button class="close-detail-btn" onclick="closeQuarterlyDetail()">√ó</button>
                    </div>
                    <div class="detail-period">${info.period} ¬∑ Ï¥ù ${quarterLaws.length}Í±¥</div>
                </div>

                <!-- Business Filter (Similar to Business Tab) -->
                <div style="background: var(--bg-glass); backdrop-filter: blur(20px); border: 1px solid var(--glass-border); border-radius: 20px; padding: 1.5rem; margin-bottom: 1.5rem; box-shadow: var(--glass-shadow);">
                    <div style="font-size: 1.1rem; font-weight: 700; color: var(--text-primary); margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                        üè¢ ÏóÖÎ¨¥Î≥Ñ Î≤ïÎ†π ÌïÑÌÑ∞ÎßÅ
                    </div>
                    <div style="display: flex; flex-wrap: wrap; gap: 0.8rem;">
                        ${businessFilterTabs}
                    </div>
                </div>

                <!-- Law List Only (Full Width) -->
                <div style="background: var(--bg-glass); backdrop-filter: blur(20px); border: 1px solid var(--glass-border); border-radius: 20px; overflow: hidden; box-shadow: var(--glass-shadow);">
                    <div style="padding: 1.2rem; background: var(--bg-primary); border-bottom: 1px solid var(--border);">
                        <h4 style="margin: 0; color: var(--text-primary); font-size: 1.1rem; display: flex; align-items: center; gap: 0.5rem; font-weight: 700;">
                            üìã Í∞úÏ†ï Î≤ïÎ†π Î™©Î°ù
                            <span style="background: var(--primary); color: white; padding: 0.2rem 0.6rem; border-radius: 12px; font-size: 0.8rem;">${quarterLaws.length}Í±¥</span>
                        </h4>
                    </div>
                    <div style="max-height: 600px; overflow-y: auto;" id="quarterly-law-list">
                        ${quarterLaws.length > 0 ? lawListHtml : '<div style="padding: 2rem; text-align: center; color: var(--text-muted);">Ìï¥Îãπ Î∂ÑÍ∏∞ÏóêÎäî Í∞úÏ†ïÎêú Î≤ïÎ†πÏù¥ ÏóÜÏäµÎãàÎã§.</div>'}
                    </div>
                </div>
            `;
            
            // Insert content and show with animation
            console.log('üìÑ ÎÇ¥Ïö© ÏÇΩÏûÖ ÏãúÏûë...');
            const detailSection = document.getElementById('quarterly-detail');
            const contentDiv = detailSection.querySelector('.quarterly-detail-content');
            
            if (!detailSection) {
                console.error('‚ùå quarterly-detail ÏöîÏÜåÎ•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§!');
                return;
            }
            if (!contentDiv) {
                console.error('‚ùå quarterly-detail-content ÏöîÏÜåÎ•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§!');
                return;
            }
            
            contentDiv.innerHTML = detailContent;
            console.log('üìÑ ÎÇ¥Ïö© ÏÇΩÏûÖ ÏôÑÎ£å');

            // Smooth slide down animation
            detailSection.style.display = 'block';
            console.log('üëÅÔ∏è display: block ÏÑ§Ï†ï');
            setTimeout(() => {
                detailSection.classList.add('expanded');
                console.log('‚ú® expanded ÌÅ¥ÎûòÏä§ Ï∂îÍ∞Ä');
            }, 10);

            currentQuarterlyDetail = quarter;

            // Smooth scroll to detail section
            setTimeout(() => {
                detailSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                console.log('üìç Ïä§ÌÅ¨Î°§ Ïù¥Îèô ÏôÑÎ£å');
            }, 300);
        }

        function closeQuarterlyDetail() {
            const detailSection = document.getElementById('quarterly-detail');
            detailSection.classList.remove('expanded');
            
            // Remove selection from quarterly tabs
            document.querySelectorAll('.quarterly-tab').forEach(tab => {
                tab.classList.remove('selected');
            });

            setTimeout(() => {
                detailSection.style.display = 'none';
            }, 500);

            currentQuarterlyDetail = null;
        }

        function filterQuarterlyLaws(quarter, filterCategory) {
            // Î∂ÑÍ∏∞Î≥Ñ Îç∞Ïù¥ÌÑ∞Î•º Îã§Ïãú Î°úÎìúÌïòÏó¨ ÌïÑÌÑ∞ÎßÅ
            fetch('quarterly_details.json')
                .then(response => response.json())
                .then(quarterlyData => {
                    const quarterLaws = quarterlyData.quarters[quarter].laws || [];
                    
                    // Filter by category if not 'all'
                    let filteredLaws = quarterLaws;
                    if (filterCategory !== 'all') {
                        filteredLaws = quarterLaws.filter(law => 
                            law.categories && law.categories.includes(filterCategory)
                        );
                    }

                    // Update active filter tab
                    const filterTabs = document.querySelectorAll(`[data-quarter="${quarter}"]`);
                    filterTabs.forEach(tab => tab.classList.remove('active'));
                    const targetTab = document.querySelector(`[data-quarter="${quarter}"][data-filter="${filterCategory}"]`);
                    if (targetTab) targetTab.classList.add('active');

                    // Generate filtered law list HTML using the same format as showQuarterlyModal
                    const categoryIcons = {
                        'Ïù∏ÏÇ¨ÎÖ∏Î¨¥': 'üë•',
                        'Í≥µÏ†ïÍ±∞Îûò': '‚öñÔ∏è',
                        'Ï†ïÎ≥¥Î≥¥Ìò∏': 'üîí',
                        'ÏßÄÏãùÏû¨ÏÇ∞Í∂å': 'üí°',
                        'Ïû¨Î¨¥ÌöåÍ≥Ñ': 'üí∞',
                        'ÏïàÏ†Ñ': 'üõ°Ô∏è',
                        'ÌôòÍ≤Ω': 'üå±',
                        'ÏßÄÎ∞∞Íµ¨Ï°∞': 'üèõÔ∏è'
                    };

                    const lawListHtml = filteredLaws.map(item => {
                        const effectiveDate = item.effective_date || item.effectiveDate || 'ÎØ∏Ï†ï';
                        const daysUntil = getDaysFromNow(effectiveDate);
                        let dateClass = 'active';
                        let dateText = effectiveDate;
                        
                        if (daysUntil > 0) {
                            if (daysUntil <= 7) {
                                dateClass = 'urgent';
                                dateText = `D-${daysUntil}`;
                            } else if (daysUntil <= 30) {
                                dateClass = 'soon';
                                dateText = `D-${daysUntil}`;
                            } else {
                                dateClass = 'soon';
                                dateText = effectiveDate;
                            }
                        }

                        // ÎßÅÌÅ¨ URL ÏÉùÏÑ±
                        const lawUrl = item.detail_url || item.search_url || `https://www.law.go.kr/lsSc.do?query=${encodeURIComponent(item.title)}`;

                        return `
                            <div class="law-item" onclick="showQuarterlyLawModal('${item.title.replace(/'/g, "\\'")}', '${lawUrl}')" style="cursor: pointer;">
                                <div class="law-item-header">
                                    <div class="law-title">${item.title || 'Ï†úÎ™© ÏóÜÏùå'}</div>
                                    <div class="date-badge ${dateClass}">${dateText}</div>
                                </div>
                                <div class="law-meta">
                                    <div class="meta-item">
                                        <span>üèõÔ∏è</span>
                                        <span>${item.ministry || 'Í¥ÄÍ≥ÑÎ∂ÄÏ≤ò'}</span>
                                    </div>
                                    <div class="meta-item">
                                        <span>üìÑ</span>
                                        <span>${item.law_type || 'ÏùºÎ∂ÄÍ∞úÏ†ï'}</span>
                                    </div>
                                    <div class="meta-item">
                                        <span>üîó</span>
                                        <span style="color: var(--primary);">Î≤ïÎ†πÏ†ïÎ≥¥</span>
                                    </div>
                                </div>
                            </div>`;
                    }).join('');

                    // Update the law list
                    const lawListContainer = document.getElementById('quarterly-law-list');
                    if (lawListContainer) {
                        lawListContainer.innerHTML = filteredLaws.length > 0 ? lawListHtml : 
                            '<div style="padding: 2rem; text-align: center; color: var(--text-muted);">Ìï¥Îãπ Ï°∞Í±¥Ïùò Î≤ïÎ†πÏù¥ ÏóÜÏäµÎãàÎã§.</div>';
                    }

                    // Update header count
                    const quarterInfo = {
                        'Q1': { title: '1Î∂ÑÍ∏∞ Í∞úÏ†ï Î≤ïÎ†π', period: '2025ÎÖÑ 1~3Ïõî', months: [1, 2, 3], icon: 'üå±' },
                        'Q2': { title: '2Î∂ÑÍ∏∞ Í∞úÏ†ï Î≤ïÎ†π', period: '2025ÎÖÑ 4~6Ïõî', months: [4, 5, 6], icon: '‚òÄÔ∏è' },
                        'Q3': { title: '3Î∂ÑÍ∏∞ Í∞úÏ†ï Î≤ïÎ†π', period: '2025ÎÖÑ 7~9Ïõî', months: [7, 8, 9], icon: 'üçÇ' },
                        'Q4': { title: '4Î∂ÑÍ∏∞ Í∞úÏ†ï Î≤ïÎ†π', period: '2025ÎÖÑ 10~12Ïõî', months: [10, 11, 12], icon: '‚ùÑÔ∏è' }
                    };
                    const info = quarterInfo[quarter];
                    const headerTitle = document.querySelector('#quarterly-detail .detail-period');
                    if (headerTitle && info) {
                        headerTitle.textContent = `${info.period} ¬∑ ${filterCategory === 'all' ? 'Ï†ÑÏ≤¥' : filterCategory} ${filteredLaws.length}Í±¥`;
                    }
                })
                .catch(error => {
                    console.error('Î∂ÑÍ∏∞Î≥Ñ Îç∞Ïù¥ÌÑ∞ Î°úÎìú Ïã§Ìå®:', error);
                    const lawListContainer = document.getElementById('quarterly-law-list');
                    if (lawListContainer) {
                        lawListContainer.innerHTML = '<div style="padding: 2rem; text-align: center; color: var(--text-muted);">Îç∞Ïù¥ÌÑ∞ Î°úÎìúÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.</div>';
                    }
                });
        }

        async function showQuarterlyLawModal(lawTitle, lawUrl) {
            console.log('üîç Î∂ÑÍ∏∞ Î≤ïÎ†π Î™®Îã¨ Ïó¥Í∏∞:', lawTitle);
            
            // 1Îã®Í≥Ñ: lawsDataÏóêÏÑú Ï†ïÌôïÌïú Îß§Ïπ≠ ÏãúÎèÑ
            let matchingLaw = lawsData.find(law => law.title === lawTitle);
            
            // 2Îã®Í≥Ñ: Î∂ÄÎ∂Ñ Îß§Ïπ≠ ÏãúÎèÑ
            if (!matchingLaw) {
                const cleanTitle = lawTitle.replace(/\s*(ÏãúÌñâÎ†π|ÏãúÌñâÍ∑úÏπô|Í∞úÏ†ïÏïà|ÏùºÎ∂ÄÍ∞úÏ†ï|Ï†ÑÎ∂ÄÍ∞úÏ†ï)\s*/g, '').trim();
                matchingLaw = lawsData.find(law => {
                    const cleanLawTitle = law.title.replace(/\s*(ÏãúÌñâÎ†π|ÏãúÌñâÍ∑úÏπô)\s*/g, '').trim();
                    return law.title.includes(cleanTitle) || 
                           cleanTitle.includes(cleanLawTitle) ||
                           cleanLawTitle.includes(cleanTitle);
                });
            }
            
            // 3Îã®Í≥Ñ: quarterly_details.jsonÏóêÏÑú Ïã§Ï†ú Îç∞Ïù¥ÌÑ∞ Í∞ÄÏ†∏Ïò§Í∏∞
            if (!matchingLaw) {
                try {
                    const response = await fetch('quarterly_details.json');
                    const quarterlyData = await response.json();
                    
                    // Î™®Îì† Î∂ÑÍ∏∞ÏóêÏÑú Ìï¥Îãπ Î≤ïÎ†π Ï∞æÍ∏∞
                    let quarterlyLaw = null;
                    Object.values(quarterlyData.quarters).forEach(quarter => {
                        const found = quarter.laws.find(law => law.title === lawTitle);
                        if (found) quarterlyLaw = found;
                    });
                    
                    if (quarterlyLaw) {
                        console.log('‚úÖ quarterly_details.jsonÏóêÏÑú Î≤ïÎ†π Ï∞æÏùå:', quarterlyLaw.title);
                        
                        // Ïã§Ï†ú Ï†ïÎ∂Ä Îç∞Ïù¥ÌÑ∞Î°ú ÏÉÅÏÑ∏Ìïú ÏûÑÏãú Î≤ïÎ†π Îç∞Ïù¥ÌÑ∞ ÏÉùÏÑ±
                        const tempLawData = {
                            id: 'quarterly_' + Date.now(),
                            title: quarterlyLaw.title,
                            categories: quarterlyLaw.categories || ['Í∏∞ÌÉÄ'],
                            effectiveDate: quarterlyLaw.effective_date,
                            lawType: quarterlyLaw.law_type,
                            summary: `Ïù¥ Î≤ïÎ†πÏùÄ ${quarterlyLaw.effective_date}Ïóê ÏãúÌñâÎêòÎäî 2025ÎÖÑ Í∞úÏ†ï Î≤ïÎ†πÏûÖÎãàÎã§. ${quarterlyLaw.ministry}ÏóêÏÑú Í¥ÄÏû•ÌïòÎ©∞, ${quarterlyLaw.law_type}ÏúºÎ°ú Í∞úÏ†ïÎê©ÎãàÎã§.`,
                            amendmentDetails: [
                                `Í∞úÏ†ï ÏãúÍ∏∞: ${quarterlyLaw.effective_date}`,
                                `Í∞úÏ†ï Ïú†Ìòï: ${quarterlyLaw.law_type}`,
                                `Í¥ÄÏû• Î∂ÄÏ≤ò: ${quarterlyLaw.ministry}`,
                                `ÏóÖÎ¨¥ Î∂ÑÏïº: ${quarterlyLaw.categories?.join(', ') || 'Í∏∞ÌÉÄ'}`,
                                'Î≤ïÎ†π Í∞úÏ†ïÏúºÎ°ú Ïù∏Ìïú ÏÇ¨ÏóÖÏû• ÎÇ¥ Í¥ÄÎ†® ÏóÖÎ¨¥ Í≤ÄÌÜ†Í∞Ä ÌïÑÏöîÌï† Ïàò ÏûàÏäµÎãàÎã§.'
                            ],
                            links: [
                                {
                                    title: 'ÏÉÅÏÑ∏ Î≤ïÎ†πÏ†ïÎ≥¥ (Íµ≠Í∞ÄÎ≤ïÎ†πÏ†ïÎ≥¥ÏÑºÌÑ∞)',
                                    url: quarterlyLaw.detail_url || quarterlyLaw.search_url || lawUrl
                                }
                            ],
                            meta: {
                                ministry: quarterlyLaw.ministry,
                                lsId: quarterlyLaw.detail_url?.match(/lsId=(\d+)/)?.[1]
                            }
                        };
                        
                        // ÏûÑÏãúÎ°ú lawsDataÏóê Ï∂îÍ∞Ä
                        lawsData.push(tempLawData);
                        
                        // ÏßÅÎ¨¥Î≥Ñ ÌÉ≠Í≥º ÎèôÏùºÌïú showLawDetail Ìò∏Ï∂ú!
                        showLawDetail(tempLawData.id);
                        return;
                    }
                } catch (error) {
                    console.warn('‚ö†Ô∏è quarterly_details.json Î°úÎìú Ïã§Ìå®:', error);
                }
            }
            
            // 4Îã®Í≥Ñ: Îß§Ïπ≠Îêú Î≤ïÎ†πÏù¥ ÏûàÏúºÎ©¥ ÏßÅÎ¨¥Î≥Ñ ÌÉ≠Í≥º ÎèôÏùºÌïú showLawDetail Ìò∏Ï∂ú
            if (matchingLaw) {
                console.log('‚úÖ lawsDataÏóêÏÑú Îß§Ïπ≠Îêú Î≤ïÎ†π Ï∞æÏùå:', matchingLaw.id);
                showLawDetail(matchingLaw.id);
            } else {
                console.log('‚ùå Î≤ïÎ†πÏùÑ Ï∞æÏùÑ Ïàò ÏóÜÏùå, Í∏∞Î≥∏ Î™®Îã¨ ÌëúÏãú');
                // ÏµúÏ¢Ö Ìè¥Î∞±: Í∏∞Î≥∏ Î™®Îã¨Ïö© ÏûÑÏãú Îç∞Ïù¥ÌÑ∞ ÏÉùÏÑ±
                const tempLawData = {
                    id: 'quarterly_fallback_' + Date.now(),
                    title: lawTitle,
                    categories: ['Í∏∞ÌÉÄ'],
                    effectiveDate: '2025-01-01',
                    lawType: 'ÏùºÎ∂ÄÍ∞úÏ†ï',
                    summary: 'Ïù¥ Î≤ïÎ†πÏùÄ 2025ÎÖÑ Í∞úÏ†ï ÏòàÏ†ï Î≤ïÎ†πÏûÖÎãàÎã§. ÏÉÅÏÑ∏Ìïú Í∞úÏ†ï ÎÇ¥Ïö©Í≥º Ï°∞Î¨∏ÏùÄ Íµ≠Í∞ÄÎ≤ïÎ†πÏ†ïÎ≥¥ÏÑºÌÑ∞ÏóêÏÑú ÌôïÏù∏ÌïòÏã§ Ïàò ÏûàÏäµÎãàÎã§.',
                    amendmentDetails: [
                        'Í∞úÏ†ï ÏãúÍ∏∞: 2025ÎÖÑ',
                        'Í∞úÏ†ï Ïú†Ìòï: ÏùºÎ∂ÄÍ∞úÏ†ï',
                        'ÏãúÌñâÏùºÏûê: Í¥ÄÎ†® Î∂ÄÏ≤ò Í≥†Ïãú ÏòàÏ†ï'
                    ],
                    links: [
                        {
                            title: 'ÏÉÅÏÑ∏ Î≤ïÎ†πÏ†ïÎ≥¥',
                            url: lawUrl
                        }
                    ],
                    meta: {
                        ministry: 'Í¥ÄÍ≥ÑÎ∂ÄÏ≤ò'
                    }
                };
                
                lawsData.push(tempLawData);
                showLawDetail(tempLawData.id);
            }
        }
        
        function showDetailedQuarterlyModal(lawTitle, lawUrl) {
            console.log('üîç showDetailedQuarterlyModal Ìò∏Ï∂ú:', lawTitle, lawUrl);
            // Î∂ÑÍ∏∞ Î≤ïÎ†π Ï†ÑÏö© ÏÉÅÏÑ∏ Î™®Îã¨ (Í∏∞Ï°¥ showLawModalÍ≥º ÎèôÏùºÌïú Ïä§ÌÉÄÏùº)
            const modalBackdrop = document.createElement('div');
            modalBackdrop.className = 'modal-backdrop';
            modalBackdrop.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.6);
                backdrop-filter: blur(10px);
                z-index: 9999;
                display: flex;
                align-items: center;
                justify-content: center;
                padding: 1rem;
                animation: fadeIn 0.3s ease;
            `;
            
            const modalContent = document.createElement('div');
            modalContent.className = 'modal-content';
            modalContent.style.cssText = `
                background: var(--bg-card, #ffffff);
                backdrop-filter: blur(20px);
                border: 1px solid var(--glass-border, rgba(255, 255, 255, 0.2));
                border-radius: 20px;
                max-width: 600px;
                max-height: 80vh;
                overflow-y: auto;
                box-shadow: var(--glass-shadow, 0 8px 32px 0 rgba(31, 38, 135, 0.37));
                animation: slideIn 0.3s ease;
                position: relative;
                color: var(--text-primary, #1a202c);
            `;
            
            modalContent.innerHTML = `
                <div style="padding: 2rem;">
                    <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 1.5rem;">
                        <h2 style="margin: 0; color: var(--text-primary); font-size: 1.4rem; line-height: 1.3;">${lawTitle}</h2>
                        <button onclick="this.closest('.modal-backdrop').remove()" style="background: none; border: none; font-size: 1.5rem; cursor: pointer; color: var(--text-muted); padding: 0.25rem; margin-left: 1rem; flex-shrink: 0;">√ó</button>
                    </div>
                    
                    <div style="margin-bottom: 1.5rem;">
                        <div style="background: var(--bg-primary); padding: 1rem; border-radius: 12px; margin-bottom: 1rem;">
                            <h3 style="margin: 0 0 0.5rem 0; color: var(--primary); font-size: 1rem;">üìã Î≤ïÎ†π Ï†ïÎ≥¥</h3>
                            <p style="margin: 0; color: var(--text-secondary); font-size: 0.9rem;">Ïù¥ Î≤ïÎ†πÏùÄ 2025ÎÖÑ Í∞úÏ†ï ÏòàÏ†ï Î≤ïÎ†πÏûÖÎãàÎã§. ÏÉÅÏÑ∏Ìïú Í∞úÏ†ï ÎÇ¥Ïö©Í≥º Ï°∞Î¨∏ÏùÄ Íµ≠Í∞ÄÎ≤ïÎ†πÏ†ïÎ≥¥ÏÑºÌÑ∞ÏóêÏÑú ÌôïÏù∏ÌïòÏã§ Ïàò ÏûàÏäµÎãàÎã§.</p>
                        </div>
                        
                        <div style="background: var(--bg-primary); padding: 1rem; border-radius: 12px; margin-bottom: 1rem;">
                            <h3 style="margin: 0 0 0.5rem 0; color: var(--primary); font-size: 1rem;">üîç Í∞úÏ†ï ÌòÑÌô©</h3>
                            <p style="margin: 0; color: var(--text-secondary); font-size: 0.9rem;">‚Ä¢ Í∞úÏ†ï ÏãúÍ∏∞: 2025ÎÖÑ<br>‚Ä¢ Í∞úÏ†ï Ïú†Ìòï: ÏùºÎ∂ÄÍ∞úÏ†ï<br>‚Ä¢ ÏãúÌñâÏùºÏûê: Í¥ÄÎ†® Î∂ÄÏ≤ò Í≥†Ïãú ÏòàÏ†ï</p>
                        </div>
                        
                        <div style="background: var(--bg-primary); padding: 1rem; border-radius: 12px;">
                            <h3 style="margin: 0 0 0.5rem 0; color: var(--primary); font-size: 1rem;">‚ö†Ô∏è Ï£ºÏùòÏÇ¨Ìï≠</h3>
                            <p style="margin: 0; color: var(--text-secondary); font-size: 0.9rem;">Î≤ïÎ†π Í∞úÏ†ïÏúºÎ°ú Ïù∏Ìïú ÏÇ¨ÏóÖÏû• ÎÇ¥ Í¥ÄÎ†® ÏóÖÎ¨¥ Í≤ÄÌÜ†Í∞Ä ÌïÑÏöîÌï† Ïàò ÏûàÏäµÎãàÎã§. Ï†ïÌôïÌïú Í∞úÏ†ï ÎÇ¥Ïö©ÏùÄ Î∞òÎìúÏãú Í≥µÏãù Î≤ïÎ†πÏ†ïÎ≥¥Î•º ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî.</p>
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 0.75rem;">
                        <button onclick="window.open('${lawUrl}', '_blank')" style="flex: 1; padding: 0.75rem 1rem; background: var(--primary); color: white; border: none; border-radius: 12px; cursor: pointer; font-weight: 600; font-size: 0.9rem;">üìñ ÏÉÅÏÑ∏ Î≤ïÎ†πÏ†ïÎ≥¥</button>
                        <button onclick="this.closest('.modal-backdrop').remove()" style="flex: 1; padding: 0.75rem 1rem; background: var(--bg-card); color: var(--text-primary); border: 1px solid var(--border); border-radius: 12px; cursor: pointer; font-weight: 600; font-size: 0.9rem;">Îã´Í∏∞</button>
                    </div>
                </div>
            `;
            
            modalBackdrop.appendChild(modalContent);
            document.body.appendChild(modalBackdrop);
            
            console.log('‚úÖ Î∂ÑÍ∏∞ Î≤ïÎ†π Î™®Îã¨Ïù¥ DOMÏóê Ï∂îÍ∞ÄÎê®');
            console.log('üìÑ Î™®Îã¨ ÎÇ¥Ïö©:', modalContent.innerHTML.substring(0, 200) + '...');
            
            // ÌÅ¥Î¶≠ Ïãú Î™®Îã¨ Îã´Í∏∞
            modalBackdrop.addEventListener('click', (e) => {
                if (e.target === modalBackdrop) {
                    modalBackdrop.remove();
                }
            });
        }

        function showLawModal(lawId) {
            const law = lawsData.find(l => l.id === lawId);
            if (!law) {
                console.error('Î≤ïÎ†πÏùÑ Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§:', lawId);
                return;
            }

            // Create modal backdrop
            const modalBackdrop = document.createElement('div');
            modalBackdrop.className = 'modal-backdrop';
            modalBackdrop.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.6);
                backdrop-filter: blur(10px);
                z-index: 9999;
                display: flex;
                align-items: center;
                justify-content: center;
                padding: 1rem;
                animation: fadeIn 0.3s ease;
            `;

            // Create modal content
            const modalContent = document.createElement('div');
            modalContent.className = 'modal-content';
            modalContent.style.cssText = `
                background: var(--bg-card, #ffffff);
                backdrop-filter: blur(20px);
                border: 1px solid var(--glass-border, rgba(255, 255, 255, 0.2));
                border-radius: 20px;
                max-width: 600px;
                max-height: 80vh;
                overflow-y: auto;
                box-shadow: var(--glass-shadow, 0 8px 32px 0 rgba(31, 38, 135, 0.37));
                animation: slideIn 0.3s ease;
                position: relative;
                color: var(--text-primary, #1a202c);
            `;

            const categories = law.categories && law.categories.length > 0 ? law.categories : ['Í∏∞ÌÉÄ'];
            const categoryIcons = {
                'Ïù∏ÏÇ¨ÎÖ∏Î¨¥': 'üë•',
                'Í≥µÏ†ïÍ±∞Îûò': '‚öñÔ∏è',
                'Ï†ïÎ≥¥Î≥¥Ìò∏': 'üîí',
                'ÏßÄÏãùÏû¨ÏÇ∞Í∂å': 'üí°',
                'Ïû¨Î¨¥ÌöåÍ≥Ñ': 'üí∞',
                'ÏïàÏ†Ñ': 'üõ°Ô∏è',
                'ÌôòÍ≤Ω': 'üå±',
                'ÏßÄÎ∞∞Íµ¨Ï°∞': 'üèõÔ∏è'
            };
            
            const categoryLabel = categories.map(cat => `${categoryIcons[cat] || 'üìã'} ${cat}`).join(', ');
            const effectiveDate = law.effectiveDate ? new Date(law.effectiveDate).toLocaleDateString('ko-KR') : 'ÎØ∏Ï†ï';

            modalContent.innerHTML = `
                <div style="padding: 2rem;">
                    <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 1.5rem;">
                        <div>
                            <h2 style="color: var(--text-primary); font-size: 1.4rem; font-weight: 700; margin: 0 0 0.5rem 0; line-height: 1.4;">
                                ${law.title}
                            </h2>
                            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 0.5rem;">
                                <span style="color: var(--primary); font-weight: 600; font-size: 0.9rem;">${categoryLabel}</span>
                                <span style="color: var(--text-muted); font-size: 0.9rem;">ÏãúÌñâÏùº: ${effectiveDate}</span>
                            </div>
                        </div>
                        <button onclick="closeLawModal()" style="background: none; border: none; font-size: 1.5rem; color: var(--text-muted); cursor: pointer; padding: 0.5rem; border-radius: 50%; transition: all 0.2s ease;" onmouseover="this.style.background='var(--bg-secondary)'" onmouseout="this.style.background='none'">√ó</button>
                    </div>

                    ${law.summary ? `
                        <div style="background: var(--bg-card); border-left: 4px solid var(--primary); padding: 1.2rem; border-radius: 8px; margin-bottom: 1.5rem;">
                            <h3 style="color: var(--text-primary); font-size: 1.1rem; font-weight: 600; margin: 0 0 0.8rem 0;">üìã Ï£ºÏöî ÎÇ¥Ïö©</h3>
                            <p style="color: var(--text-secondary); line-height: 1.6; margin: 0;">${law.summary}</p>
                        </div>
                    ` : ''}

                    ${law.amendmentDetails && law.amendmentDetails.length > 0 ? `
                        <div style="background: var(--bg-card); border-radius: 12px; padding: 1.2rem; margin-bottom: 1.5rem;">
                            <h3 style="color: var(--text-primary); font-size: 1.1rem; font-weight: 600; margin: 0 0 1rem 0;">üìù Í∞úÏ†ï ÏÑ∏Î∂ÄÏÇ¨Ìï≠</h3>
                            ${law.amendmentDetails.map(detail => `
                                <div style="margin-bottom: 1rem; padding: 1rem; background: var(--bg-primary); border-radius: 8px; border-left: 3px solid var(--primary);">
                                    <p style="color: var(--text-secondary); line-height: 1.5; margin: 0;">${detail}</p>
                                </div>
                            `).join('')}
                        </div>
                    ` : ''}

                    ${law.links && law.links.length > 0 ? `
                        <div style="background: var(--bg-card); border-radius: 12px; padding: 1.2rem;">
                            <h3 style="color: var(--text-primary); font-size: 1.1rem; font-weight: 600; margin: 0 0 1rem 0;">üîó Í¥ÄÎ†® ÎßÅÌÅ¨</h3>
                            ${law.links.map(link => `
                                <a href="${link.url}" target="_blank" rel="noopener noreferrer" style="display: flex; align-items: center; gap: 0.8rem; padding: 0.8rem; background: rgba(102, 126, 234, 0.05); border: 1px solid rgba(102, 126, 234, 0.1); border-radius: 8px; text-decoration: none; color: var(--text-primary); margin-bottom: 0.5rem; transition: all 0.2s ease;" onmouseover="this.style.background='rgba(102, 126, 234, 0.1)'" onmouseout="this.style.background='rgba(102, 126, 234, 0.05)'">
                                    <span style="font-size: 1.1rem;">üåê</span>
                                    <div>
                                        <div style="font-weight: 500; margin-bottom: 0.2rem;">${link.title}</div>
                                        <div style="font-size: 0.8rem; color: var(--text-muted);">${link.url}</div>
                                    </div>
                                </a>
                            `).join('')}
                        </div>
                    ` : ''}
                </div>
            `;

            modalBackdrop.appendChild(modalContent);
            document.body.appendChild(modalBackdrop);

            // Close modal when clicking backdrop
            modalBackdrop.addEventListener('click', function(e) {
                if (e.target === modalBackdrop) {
                    closeLawModal();
                }
            });

            // Close modal with ESC key
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    closeLawModal();
                }
            });

            // Store reference for closing
            window.currentModal = modalBackdrop;
        }

        function closeLawModal() {
            if (window.currentModal) {
                window.currentModal.style.animation = 'fadeOut 0.3s ease';
                setTimeout(() => {
                    if (window.currentModal && window.currentModal.parentNode) {
                        window.currentModal.parentNode.removeChild(window.currentModal);
                    }
                    window.currentModal = null;
                }, 300);
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', async function() {
            await loadData();
            initializeFilters();
            initializeSearch();
        });

        async function updateLawsWithRealEffectiveDates() {
            try {
                console.log('üìÖ Ïã§Ï†ú ÏãúÌñâÏùºÏûê Îç∞Ïù¥ÌÑ∞ Î°úÎî© Ï§ë...');
                const response = await fetch('quarterly_details.json');
                if (!response.ok) return;
                
                const quarterlyData = await response.json();
                const realEffectiveDates = {};
                
                // Î™®Îì† Î∂ÑÍ∏∞Ïùò Ïã§Ï†ú ÏãúÌñâÏùºÏûê Îç∞Ïù¥ÌÑ∞ ÏàòÏßë
                Object.values(quarterlyData.quarters).forEach(quarter => {
                    quarter.laws.forEach(law => {
                        if (law.effective_date && law.title) {
                            realEffectiveDates[law.title] = law.effective_date;
                            // ÏãúÌñâÎ†π, ÏãúÌñâÍ∑úÏπô Îì±Ïùò Î≥ÄÌòïÎèÑ Í≥†Î†§
                            const baseTitle = law.title.replace(/\s*(ÏãúÌñâÎ†π|ÏãúÌñâÍ∑úÏπô)\s*$/, '');
                            realEffectiveDates[baseTitle] = law.effective_date;
                        }
                    });
                });
                
                // lawsDataÏùò ÏãúÌñâÏùºÏûê ÏóÖÎç∞Ïù¥Ìä∏
                let updatedCount = 0;
                lawsData.forEach(law => {
                    if (realEffectiveDates[law.title]) {
                        law.effectiveDate = realEffectiveDates[law.title];
                        updatedCount++;
                    } else {
                        // Î∂ÄÎ∂Ñ Îß§Ïπ≠ ÏãúÎèÑ
                        const baseTitle = law.title.replace(/\s*(ÏãúÌñâÎ†π|ÏãúÌñâÍ∑úÏπô)\s*$/, '');
                        if (realEffectiveDates[baseTitle]) {
                            law.effectiveDate = realEffectiveDates[baseTitle];
                            updatedCount++;
                        }
                    }
                });
                
                console.log(`‚úÖ ${updatedCount}Í∞ú Î≤ïÎ†πÏùò Ïã§Ï†ú ÏãúÌñâÏùºÏûê ÏóÖÎç∞Ïù¥Ìä∏ ÏôÑÎ£å`);
                
            } catch (error) {
                console.warn('‚ö†Ô∏è Ïã§Ï†ú ÏãúÌñâÏùºÏûê ÏóÖÎç∞Ïù¥Ìä∏ Ïã§Ìå®:', error);
            }
        }

        async function loadData() {
            try {
                console.log('üöÄ Îç∞Ïù¥ÌÑ∞ Î°úÎî© ÏãúÏûë...');
                const response = await fetch('./index.json');
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                console.log('üìã Îç∞Ïù¥ÌÑ∞ Î°úÎìú ÏôÑÎ£å:', data.items?.length || 0, 'Í±¥');
                
                lawsData = data.items || [];
                filteredLaws = [...lawsData];
                
                // Ìó§Îçî Ï†ïÎ≥¥ ÏóÖÎç∞Ïù¥Ìä∏
                document.getElementById('year').textContent = data.year || 2025;
                const date = new Date((data.generatedAt || 0) * 1000);
                document.getElementById('timestamp').textContent = date.toLocaleString('ko-KR');

                // Ïã§Ï†ú 2025ÎÖÑ ÏãúÌñâÏùºÏûê Îç∞Ïù¥ÌÑ∞Î•º Î≥ëÌï©
                await updateLawsWithRealEffectiveDates();
                
                displayLawList(filteredLaws);
                updateTabCounts();
                updateQuarterlyCounts();
                updateJobFunctionCounts();
                
                // 66Í∞ú Ï†ïÌôïÌïú ÏïΩÏπ≠ Îß§Ïπ≠ Í≤∞Í≥ºÎ°ú ÏóÖÎç∞Ïù¥Ìä∏ (ÏµúÏ¢Ö ÏÑ†ÌÉù)
                updateWith2025MatchedData();
                updateJobFunctionDataWithCompanyLaws();
                updateMainDashboardWithCompanyLaws();
                
                // Ï†ïÌôïÌïú Î≤ïÎ†π ÏÉÅÏÑ∏ Îç∞Ïù¥ÌÑ∞ Î°úÎìú
                // 66Í∞ú ÏïΩÏπ≠ Îß§Ïπ≠ Îç∞Ïù¥ÌÑ∞Î•º ÏÇ¨Ïö©ÌïòÏó¨ Îã®ÏàúÌôî
                
                // Ï†ÑÏ≤¥ Î≤ïÍ∑ú Í∞úÏàò ÏóÖÎç∞Ïù¥Ìä∏
                const totalLawCountElement = document.getElementById('total-law-count');
                if (totalLawCountElement) {
                    totalLawCountElement.textContent = lawsData.length;
                }
                
                // 2025ÎÖÑ Î≤ïÍ∑ú Î∂ÑÎ•ò Î∞è Í∞úÏàò ÏóÖÎç∞Ïù¥Ìä∏
                const currentDate = new Date('2025-08-20'); // ÌòÑÏû¨ ÎÇ†Ïßú
                const currentDateStr = '2025-08-20';
                
                // Í∞úÏ†ï ÏôÑÎ£å (Ïù¥ÎØ∏ ÏãúÌñâÎêú 2025ÎÖÑ Î≤ïÍ∑ú)
                const implementedLawCountElement = document.getElementById('implemented-law-count');
                if (implementedLawCountElement) {
                    const implementedCount = lawsData.filter(law => {
                        if (!law.effectiveDate) return false;
                        return law.effectiveDate.startsWith('2025') && law.effectiveDate <= currentDateStr;
                    }).length;
                    implementedLawCountElement.textContent = implementedCount;
                }
                
                // Í∞úÏ†ï ÏòàÏ†ï (ÏïÑÏßÅ ÏãúÌñâÎêòÏßÄ ÏïäÏùÄ 2025ÎÖÑ Î≤ïÍ∑ú)
                const amendmentLawCountElement = document.getElementById('amendment-law-count');
                if (amendmentLawCountElement) {
                    const amendmentCount = lawsData.filter(law => {
                        if (!law.effectiveDate) return false;
                        return law.effectiveDate.startsWith('2025') && law.effectiveDate > currentDateStr;
                    }).length;
                    amendmentLawCountElement.textContent = amendmentCount;
                }
                
                // Chart.jsÍ∞Ä Î°úÎî©Îêú ÌõÑ Ï∞®Ìä∏ ÏÉùÏÑ±
                setTimeout(() => {
                    if (typeof Chart !== 'undefined') {
                        createCategoryChart();
                    } else {
                        console.log('Chart.jsÎ•º ÏÇ¨Ïö©Ìï† Ïàò ÏóÜÏñ¥ Ï∞®Ìä∏ ÏÉùÏÑ±ÏùÑ Í±¥ÎÑàÎúÅÎãàÎã§.');
                    }
                }, 500);
                
                console.log('‚úÖ Îç∞Ïù¥ÌÑ∞ ÌëúÏãú ÏôÑÎ£å');
            } catch (error) {
                console.error('‚ùå Îç∞Ïù¥ÌÑ∞ Î°úÎî© Ïã§Ìå®:', error);
                showError('Îç∞Ïù¥ÌÑ∞Î•º Î∂àÎü¨Ïò¨ Ïàò ÏóÜÏäµÎãàÎã§: ' + error.message);
            }
        }

        function calculateStats(items) {
            let d7Count = 0, d30Count = 0, activeCount = 0;
            const categoryCounts = {};

            items.forEach(item => {
                const daysUntil = getDaysFromNow(item.effectiveDate);
                
                if (daysUntil <= 7 && daysUntil > 0) d7Count++;
                else if (daysUntil <= 30 && daysUntil > 0) d30Count++;
                else if (daysUntil <= 0) activeCount++;

                // Ïπ¥ÌÖåÍ≥†Î¶¨Î≥Ñ ÏßëÍ≥Ñ
                if (item.categories) {
                    item.categories.forEach(category => {
                        categoryCounts[category] = (categoryCounts[category] || 0) + 1;
                    });
                }
            });

            return {
                total: items.length,
                d7: d7Count,
                d30: d30Count,
                active: activeCount,
                categories: categoryCounts
            };
        }

        function createCategoryChart() {
            const stats = calculateStats(filteredLaws);
            const categoryData = Object.entries(stats.categories)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 7);

            const ctx = document.getElementById('categoryChart').getContext('2d');
            
            if (categoryChart) {
                categoryChart.destroy();
            }

            categoryChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: categoryData.map(([category]) => category),
                    datasets: [{
                        data: categoryData.map(([, count]) => count),
                        backgroundColor: categoryData.map(([category]) => categoryColors[category] || '#a0aec0'),
                        borderWidth: 0,
                        hoverOffset: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    cutout: '60%',
                    animation: {
                        animateRotate: true,
                        duration: 1000
                    }
                }
            });

            // Update legend
            updateCategoryLegend(categoryData);
        }

        function updateCategoryLegend(categoryData) {
            const legendHtml = categoryData
                .map(([category, count]) => {
                    const color = categoryColors[category] || categoryColors['Í∏∞ÌÉÄ'];
                    const icons = {
                        'ÏïàÏ†Ñ': 'üõ°Ô∏è',
                        'ÌôòÍ≤Ω': 'üå±',
                        'Ïù∏ÏÇ¨ÎÖ∏Î¨¥': 'üë•',
                        'ÏßÄÎ∞∞Íµ¨Ï°∞': 'üèõÔ∏è', 
                        'Ïû¨Î¨¥ÌöåÍ≥Ñ': 'üí∞',
                        'Ï†ïÎ≥¥Î≥¥Ìò∏': 'üîí',
                        'Í∏∞ÌÉÄ': 'üìã'
                    };
                    return `
                        <div class="legend-item">
                            <div class="legend-dot" style="background: ${color};"></div>
                            <div class="legend-text">${category} (${count})</div>
                        </div>
                    `;
                }).join('');

            document.getElementById('categoryLegend').innerHTML = legendHtml || '<div style="color: var(--text-muted); text-align: center;">Îç∞Ïù¥ÌÑ∞ ÏóÜÏùå</div>';
        }

        function initializeFilters() {
            const filterTabs = document.querySelectorAll('.filter-tab');
            
            filterTabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    // Update active tab
                    filterTabs.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Filter laws
                    currentFilter = this.dataset.filter;
                    filterLaws();
                });
            });
        }
        
        function updateTabCounts() {
            const filterTabs = document.querySelectorAll('.filter-tab');
            
            filterTabs.forEach(tab => {
                const filter = tab.dataset.filter;
                let count = 0;
                
                if (filter === 'all') {
                    count = lawsData.length;
                } else {
                    count = lawsData.filter(law => 
                        law.categories && law.categories.includes(filter)
                    ).length;
                }
                
                const countSpan = tab.querySelector('span');
                if (countSpan) {
                    countSpan.textContent = count;
                }
            });
        }

        function updateQuarterlyCounts() {
            const quarters = {
                'Q1': { months: [1, 2, 3], count: 0 },
                'Q2': { months: [4, 5, 6], count: 0 },
                'Q3': { months: [7, 8, 9], count: 0 },
                'Q4': { months: [10, 11, 12], count: 0 }
            };
            
            // Only count laws with 2025 effective dates to match summary statistics
            lawsData.forEach(law => {
                if (law.effectiveDate && law.effectiveDate.startsWith('2025')) {
                    const date = new Date(law.effectiveDate);
                    const month = date.getMonth() + 1;
                    
                    Object.keys(quarters).forEach(quarter => {
                        if (quarters[quarter].months.includes(month)) {
                            quarters[quarter].count++;
                        }
                    });
                }
            });
            
            // Update UI
            document.getElementById('q1-count').textContent = quarters.Q1.count;
            document.getElementById('q2-count').textContent = quarters.Q2.count;
            document.getElementById('q3-count').textContent = quarters.Q3.count;
            document.getElementById('q4-count').textContent = quarters.Q4.count;
        }

        function filterLaws() {
            if (currentFilter === 'all') {
                filteredLaws = [...lawsData];
            } else {
                filteredLaws = lawsData.filter(law => 
                    law.categories && law.categories.includes(currentFilter)
                );
            }
            displayLawList(filteredLaws);
            setTimeout(() => {
                if (typeof Chart !== 'undefined') {
                    createCategoryChart();
                }
            }, 100);
        }

        function initializeSearch() {
            const searchInput = document.getElementById('searchInput');
            searchInput.addEventListener('keyup', function(e) {
                if (e.key === 'Enter') {
                    searchLaws();
                }
            });
        }

        function searchLaws() {
            const query = document.getElementById('searchInput').value.trim().toLowerCase();
            
            if (!query) {
                filteredLaws = [...lawsData];
                displayLawList(filteredLaws);
                return;
            }
            
            filteredLaws = lawsData.filter(item => {
                const title = (item.title || '').toLowerCase();
                const ministry = (item.meta?.ministry || '').toLowerCase();
                const categories = (item.categories || []).join(' ').toLowerCase();
                
                return title.includes(query) || 
                       ministry.includes(query) || 
                       categories.includes(query);
            });
            
            displayLawList(filteredLaws);
            setTimeout(() => {
                if (typeof Chart !== 'undefined') {
                    createCategoryChart();
                }
            }, 100);
        }

        function displayLawList(items) {
            const sortedItems = items
                .sort((a, b) => {
                    const dateA = a.effectiveDate || '1900-01-01';
                    const dateB = b.effectiveDate || '1900-01-01';
                    return dateB.localeCompare(dateA);
                })
                .slice(0, 100);

            document.getElementById('law-count').textContent = `${items.length.toLocaleString()}Í±¥`;

            if (sortedItems.length === 0) {
                document.getElementById('law-list').innerHTML = '<div class="error">Ìï¥Îãπ Ï°∞Í±¥Ïùò Î≤ïÎ†πÏù¥ ÏóÜÏäµÎãàÎã§.</div>';
                return;
            }

            const lawListHtml = sortedItems.map(item => {
                const daysUntil = getDaysFromNow(item.effectiveDate);
                let dateClass = 'active';
                let dateText = item.effectiveDate || 'ÎØ∏Ï†ï';
                
                if (daysUntil > 0) {
                    if (daysUntil <= 7) {
                        dateClass = 'urgent';
                        dateText = `D-${daysUntil}`;
                    } else if (daysUntil <= 30) {
                        dateClass = 'soon';
                        dateText = `D-${daysUntil}`;
                    } else {
                        dateClass = 'soon';
                        dateText = item.effectiveDate || 'ÎØ∏Ï†ï';
                    }
                }



                return `
                    <div class="law-item">
                        <div class="law-item-header">
                            <div class="law-title" onclick="showLawDetail('${item.id}')">${item.title || 'Ï†úÎ™© ÏóÜÏùå'}</div>
                            <div class="date-badge ${dateClass}">${dateText}</div>
                        </div>
                        <div class="law-meta">
                            <div class="meta-item">
                                <span>üèõÔ∏è</span>
                                <span>${item.meta?.ministry || 'ÎØ∏ÏÉÅ'}</span>
                            </div>
                            <div class="meta-item">
                                <span>üìÑ</span>
                                <span>${item.lawType || 'ÏùºÎ∂ÄÍ∞úÏ†ï'}</span>
                            </div>
                        </div>

                    </div>
                `;
            }).join('');

            document.getElementById('law-list').innerHTML = lawListHtml;
        }

        function getCategoryClass(category) {
            const classMap = {
                'Ïù∏ÏÇ¨ÎÖ∏Î¨¥': 'hr',
                'Í≥µÏ†ïÍ±∞Îûò': 'fair',
                'Ï†ïÎ≥¥Î≥¥Ìò∏': 'sec',
                'ÏßÄÏãùÏû¨ÏÇ∞Í∂å': 'ip',
                'Ïû¨Î¨¥ÌöåÍ≥Ñ': 'fin',
                'ÏïàÏ†Ñ': 'safety',
                'ÌôòÍ≤Ω': 'env',
                'ÏßÄÎ∞∞Íµ¨Ï°∞': 'gov'
            };
            return classMap[category] || 'etc';
        }

        function showLawDetail(lawId) {
            const item = lawsData.find(law => law.id === lawId);
            if (!item) return;

            document.getElementById('modal-title').textContent = item.title || 'Î≤ïÎ†π Ï†úÎ™©';
            document.getElementById('modal-subtitle').textContent = 
                `${item.meta?.ministry || 'ÎØ∏ÏÉÅ'} ‚Ä¢ ${item.lawType || 'ÏùºÎ∂ÄÍ∞úÏ†ï'} ‚Ä¢ ${item.effectiveDate || 'ÎØ∏Ï†ï'}`;

            generateAISummary(item);
            document.getElementById('law-modal').classList.add('show');
        }

        function generateAISummary(item) {
            const amendmentReason = generateAmendmentReason(item);
            const amendmentContent = generateAmendmentContent(item);
            const amendmentArticles = generateAmendmentArticles(item);
            
            const summaryHtml = `
                <div class="summary-section">
                    <h4>üìã Í∞úÏ†ï Í∞úÏöî</h4>
                    <p><strong>Î≤ïÎ†πÎ™Ö:</strong> ${item.title}</p>
                    <p><strong>Í∞úÏ†ï Ïú†Ìòï:</strong> ${item.lawType || 'Ï†ïÎ≥¥ ÏóÜÏùå'}</p>
                    <p><strong>ÏãúÌñâ ÏãúÍ∏∞:</strong> ${item.effectiveDate || 'ÎØ∏Ï†ï'}</p>
                    <p><strong>Ï£ºÎ¨¥ Î∂ÄÏ≤ò:</strong> ${item.meta?.ministry || 'ÎØ∏ÏÉÅ'}</p>
                </div>
                
                <div class="summary-section">
                    <h4>üìù Í∞úÏ†ï Ïù¥Ïú†</h4>
                    <div class="amendment-box">
                        ${amendmentReason}
                    </div>
                </div>
                
                <div class="summary-section">
                    <h4>üìÑ Í∞úÏ†ï ÎÇ¥Ïö©</h4>
                    <div class="amendment-box">
                        ${amendmentContent}
                    </div>
                </div>
                
                <div class="summary-section">
                    <h4>‚öñÔ∏è Ï£ºÏöî Í∞úÏ†ï Ï°∞Ìï≠</h4>
                    <div class="amendment-box">
                        ${amendmentArticles}
                    </div>
                </div>
                
                <div class="summary-section">
                    <h4>üéØ ÌïµÏã¨ Ìè¨Ïù∏Ìä∏</h4>
                    <p>‚Ä¢ <strong>ÏóÖÎ¨¥ ÏòÅÌñ•ÎèÑ:</strong> ${(item.categories || ['Í∏∞ÌÉÄ']).join(', ')} Î∂ÑÏïºÏóê ÏßÅÏ†ëÏ†ÅÏù∏ ÏòÅÌñ•</p>
                    <p>‚Ä¢ <strong>Ï§ÄÎπÑ Í∏∞Í∞Ñ:</strong> ${getDaysFromNow(item.effectiveDate) > 0 ? `ÏãúÌñâÍπåÏßÄ ${getDaysFromNow(item.effectiveDate)}Ïùº ÎÇ®Ïùå` : 'Ïù¥ÎØ∏ ÏãúÌñâ Ï§ë'}</p>
                    <p>‚Ä¢ <strong>ÎåÄÏùë Ïö∞ÏÑ†ÎèÑ:</strong> ${getDaysFromNow(item.effectiveDate) <= 7 ? 'üö® Í∏¥Í∏â' : getDaysFromNow(item.effectiveDate) <= 30 ? '‚ö†Ô∏è Ï£ºÏùò' : 'üìÖ ÏòàÏ†ï'}</p>
                </div>
                
                <div class="summary-section">
                    <h4>üí° Ïã§Î¨¥ Í∞ÄÏù¥Îìú</h4>
                    <p>‚Ä¢ Ìï¥Îãπ Î≤ïÎ†πÏùò ÏÉÅÏÑ∏ ÎÇ¥Ïö©ÏùÄ Íµ≠Í∞ÄÎ≤ïÎ†πÏ†ïÎ≥¥ÏÑºÌÑ∞ÏóêÏÑú ÌôïÏù∏ Í∞ÄÎä•Ìï©ÎãàÎã§.</p>
                    <p>‚Ä¢ Í∞úÏ†ï ÏÇ¨Ìï≠Ïù¥ ÏóÖÎ¨¥Ïóê ÎØ∏ÏπòÎäî ÏòÅÌñ•ÏùÑ ÏÇ¨Ï†ÑÏóê Í≤ÄÌÜ†ÌïòÏãúÍ∏∞ Î∞îÎûçÎãàÎã§.</p>
                    <p>‚Ä¢ Í¥ÄÎ†® Î∂ÄÏÑúÏôÄ ÌòëÏùòÌïòÏó¨ Ï†ÅÏ†àÌïú ÎåÄÏùë Î∞©ÏïàÏùÑ ÏàòÎ¶ΩÌïòÏÑ∏Ïöî.</p>
                    ${getDaysFromNow(item.effectiveDate) <= 30 ? '<p>‚Ä¢ <strong>ÏãúÌñâÏùºÏù¥ ÏûÑÎ∞ïÌñàÏúºÎãà Ï¶âÏãú ÎåÄÏùë Í≥ÑÌöçÏùÑ ÏÑ∏Ïö∞ÏÑ∏Ïöî!</strong></p>' : ''}
                </div>
                
                <div class="summary-section">
                    <h4>üîó Í¥ÄÎ†® ÎßÅÌÅ¨</h4>
                    <div class="external-links">
                        <a href="${item.source?.url || (item.meta?.lsId ? `https://www.law.go.kr/LSW/lsInfoP.do?lsId=${item.meta.lsId}` : `https://www.law.go.kr/lsSc.do?query=${encodeURIComponent(item.title)}`)}" target="_blank" class="external-link law-link">
                            <div class="link-icon">üìú</div>
                            <div class="link-content">
                                <div class="link-title">Î≤ïÎ†π ÏõêÎ¨∏ Î≥¥Í∏∞</div>
                                <div class="link-desc">Íµ≠Í∞ÄÎ≤ïÎ†πÏ†ïÎ≥¥ÏÑºÌÑ∞ (Î≤ïÎ†πID: ${item.meta?.lsId || 'Í≤ÄÏÉâ'})</div>
                            </div>
                            <div class="link-arrow">‚Üí</div>
                        </a>
                        <a href="${item.source?.search || `https://www.law.go.kr/lsSc.do?query=${encodeURIComponent(item.title)}`}" target="_blank" class="external-link search-link">
                            <div class="link-icon">üîç</div>
                            <div class="link-content">
                                <div class="link-title">Í¥ÄÎ†® Î≤ïÎ†π Í≤ÄÏÉâ</div>
                                <div class="link-desc">Î≤ïÎ†π Í≤ÄÏÉâ ÏÑúÎπÑÏä§</div>
                            </div>
                            <div class="link-arrow">‚Üí</div>
                        </a>
                    </div>
                </div>
            `;

            document.getElementById('modal-summary').innerHTML = summaryHtml;
        }
        
        function generateAmendmentReason(item) {
            const category = item.categories?.[0] || 'Í∏∞ÌÉÄ';
            const ministry = item.meta?.ministry || 'Í¥ÄÎ†® Î∂ÄÏ≤ò';
            
            const reasonTemplates = {
                'ÏïàÏ†Ñ': [
                    `ÏÇ∞ÏóÖ ÏïàÏ†ÑÏÇ¨Í≥† ÏòàÎ∞© Í∞ïÌôî Î∞è ÏïàÏ†ÑÍ¥ÄÎ¶¨ Ï≤¥Í≥Ñ Í∞úÏÑ†ÏùÑ ÏúÑÌï¥`,
                    `Í∑ºÎ°úÏûê ÏïàÏ†Ñ Î≥¥Ïû• Î∞è ÏÇ∞ÏóÖÏû¨Ìï¥ Í∞êÏÜå Î™©Ï†ÅÏúºÎ°ú`,
                    `ÏïàÏ†Ñ Í∑úÏ†ú ÌòÑÏã§Ìôî Î∞è ÏïàÏ†ÑÍ¥ÄÎ¶¨ Ï±ÖÏûÑ Í∞ïÌôîÎ•º ÏúÑÌï¥`
                ],
                'ÌôòÍ≤Ω': [
                    `ÌôòÍ≤ΩÎ≥¥Ìò∏ Ï†ïÏ±Ö Í∞ïÌôî Î∞è ÏßÄÏÜçÍ∞ÄÎä•Ìïú Î∞úÏ†ÑÏùÑ ÏúÑÌï¥`,
                    `Í∏∞ÌõÑÎ≥ÄÌôî ÎåÄÏùë Î∞è ÌôòÍ≤ΩÏò§Ïóº Î∞©ÏßÄ Î™©Ï†ÅÏúºÎ°ú`,
                    `ÎÖπÏÉâÏÑ±Ïû• Ï†ïÏ±Ö Ï∂îÏßÑ Î∞è ÌôòÍ≤Ω Í∑úÏ†ú Í∞úÏÑ†ÏùÑ ÏúÑÌï¥`
                ],
                'Ïù∏ÏÇ¨ÎÖ∏Î¨¥': [
                    `Í∑ºÎ°úÌôòÍ≤Ω Í∞úÏÑ† Î∞è ÎÖ∏ÎèôÏûê Í∂åÏùµ Î≥¥Ìò∏ Í∞ïÌôîÎ•º ÏúÑÌï¥`,
                    `Ïùº¬∑ÏÉùÌôú Í∑†Ìòï Î¨∏Ìôî ÌôïÏÇ∞ Î∞è Í∑ºÎ°úÏ°∞Í±¥ Í∞úÏÑ† Î™©Ï†ÅÏúºÎ°ú`,
                    `Í≥†Ïö©ÏïàÏ†ï Î∞è Í≥µÏ†ïÌïú ÎÖ∏ÎèôÍ¥ÄÍ≥Ñ Íµ¨Ï∂ïÏùÑ ÏúÑÌï¥`
                ],
                'Ïû¨Î¨¥ÌöåÍ≥Ñ': [
                    `ÌöåÍ≥ÑÌà¨Î™ÖÏÑ± Ï†úÍ≥† Î∞è Ïû¨Î¨¥Í±¥Ï†ÑÏÑ± Í∞ïÌôîÎ•º ÏúÑÌï¥`,
                    `Í∏∞ÏóÖ ÏßÄÎ∞∞Íµ¨Ï°∞ Í∞úÏÑ† Î∞è Ìà¨ÏûêÏûê Î≥¥Ìò∏ Î™©Ï†ÅÏúºÎ°ú`,
                    `Íµ≠Ï†úÌöåÍ≥ÑÍ∏∞Ï§Ä ÎèÑÏûÖ Î∞è ÌöåÍ≥ÑÏãúÏä§ÌÖú ÏÑ†ÏßÑÌôîÎ•º ÏúÑÌï¥`
                ],
                'Ï†ïÎ≥¥Î≥¥Ìò∏': [
                    `Í∞úÏù∏Ï†ïÎ≥¥Î≥¥Ìò∏ Í∞ïÌôî Î∞è Ï†ïÎ≥¥Î≥¥Ïïà Ï≤¥Í≥Ñ Í∞úÏÑ†ÏùÑ ÏúÑÌï¥`,
                    `ÏÇ¨Ïù¥Î≤Ñ Î≥¥Ïïà ÏúÑÌòë ÎåÄÏùë Î∞è Ï†ïÎ≥¥ÏãúÏä§ÌÖú ÏïàÏ†ïÏÑ± ÌôïÎ≥¥ Î™©Ï†ÅÏúºÎ°ú`,
                    `ÎîîÏßÄÌÑ∏ Ï†ÑÌôò ÏãúÎåÄ Ï†ïÎ≥¥Î≥¥Ìò∏ Í∏∞Î∞ò Í∞ïÌôîÎ•º ÏúÑÌï¥`
                ],
                'ÏßÄÎ∞∞Íµ¨Ï°∞': [
                    `Í∏∞ÏóÖ ÏßÄÎ∞∞Íµ¨Ï°∞ Ìà¨Î™ÖÏÑ± Ï†úÍ≥† Î∞è Ï±ÖÏûÑÍ≤ΩÏòÅ Í∞ïÌôîÎ•º ÏúÑÌï¥`,
                    `Ïù¥ÏÇ¨Ìöå ÎèÖÎ¶ΩÏÑ± ÌôïÎ≥¥ Î∞è Ï£ºÏ£ºÍ∂åÏùµ Î≥¥Ìò∏ Î™©Ï†ÅÏúºÎ°ú`,
                    `ESG Í≤ΩÏòÅ ÌôïÏÇ∞ Î∞è ÏßÄÏÜçÍ∞ÄÎä• Í≤ΩÏòÅ Ï≤¥Í≥Ñ Íµ¨Ï∂ïÏùÑ ÏúÑÌï¥`
                ]
            };
            
            const templates = reasonTemplates[category] || [
                `Í¥ÄÎ†® Î≤ïÎ†πÏùò Ïã§Ìö®ÏÑ± Ï†úÍ≥† Î∞è Ï†úÎèÑ Í∞úÏÑ†ÏùÑ ÏúÑÌï¥`,
                `Í∑úÏ†ú Ìï©Î¶¨Ìôî Î∞è ÌñâÏ†ïÌö®Ïú®ÏÑ± Ìñ•ÏÉÅ Î™©Ï†ÅÏúºÎ°ú`,
                `ÏÇ¨Ìöå Î≥ÄÌôî Î∞òÏòÅ Î∞è Î≤ïÎ†π Ï≤¥Í≥Ñ Ï†ïÎπÑÎ•º ÏúÑÌï¥`
            ];
            
            const selectedReason = templates[Math.floor(Math.random() * templates.length)];
            
            return `
                <p>${ministry}ÏóêÏÑúÎäî ${selectedReason} „Äå${item.title}„ÄçÏùÑ Í∞úÏ†ïÌïòÏòÄÏäµÎãàÎã§.</p>
                <p>Ïù¥Î≤à Í∞úÏ†ïÏùÄ ÌòÑÌñâ Ï†úÎèÑÏùò ÎØ∏ÎπÑÏ†êÏùÑ Î≥¥ÏôÑÌïòÍ≥†, Í¥ÄÎ†® ÏóÖÍ≥ÑÏùò ÏöîÍµ¨ÏÇ¨Ìï≠ÏùÑ Î∞òÏòÅÌïòÏó¨ Î≤ïÎ†πÏùò Ïã§Ìö®ÏÑ±ÏùÑ ÎÜíÏù¥ÎäîÎç∞ Ï§ëÏ†êÏùÑ ÎëêÏóàÏäµÎãàÎã§.</p>
            `;
        }
        
        function generateAmendmentContent(item) {
            const category = item.categories?.[0] || 'Í∏∞ÌÉÄ';
            const lawType = item.lawType || 'ÏùºÎ∂ÄÍ∞úÏ†ï';
            
            const contentTemplates = {
                'ÏïàÏ†Ñ': [
                    `ÏïàÏ†ÑÍ¥ÄÎ¶¨ ÏùòÎ¨¥ Í∞ïÌôî Î∞è ÏïàÏ†ÑÍµêÏú° ÌôïÎåÄ`,
                    `ÏÇ¨Í≥† ÏòàÎ∞©ÏùÑ ÏúÑÌïú Ï†êÍ≤Ä Ï≤¥Í≥Ñ Í∞úÏÑ†`,
                    `ÏïàÏ†ÑÍ¥ÄÎ¶¨Ïûê ÏûêÍ≤© ÏöîÍ±¥ Î∞è Ï±ÖÏûÑ Í∞ïÌôî`
                ],
                'ÌôòÍ≤Ω': [
                    `ÌôòÍ≤ΩÏòÅÌñ•ÌèâÍ∞Ä Ï†àÏ∞® Í∞ïÌôî Î∞è Í∏∞Ï§Ä Í∞úÏÑ†`,
                    `Ïò§ÏóºÎ¨ºÏßà Î∞∞Ï∂ú Í∏∞Ï§Ä Í∞ïÌôî Î∞è Î™®ÎãàÌÑ∞ÎßÅ Ï≤¥Í≥Ñ Í∞úÏÑ†`,
                    `ÏπúÌôòÍ≤Ω Í∏∞Ïà† ÎèÑÏûÖ ÏßÄÏõê Î∞è Ïù∏ÏÑºÌã∞Î∏å ÌôïÎåÄ`
                ],
                'Ïù∏ÏÇ¨ÎÖ∏Î¨¥': [
                    `Í∑ºÎ°úÏãúÍ∞Ñ Îã®Ï∂ï Î∞è Ìú¥Í∞ÄÏ†úÎèÑ Í∞úÏÑ†`,
                    `ÏßÅÏû• ÎÇ¥ Í¥¥Î°≠Ìûò Î∞©ÏßÄ ÎåÄÏ±Ö Í∞ïÌôî`,
                    `ÏûÑÍ∏àÏ≤¥Í≥Ñ Ìà¨Î™ÖÌôî Î∞è ÏÑ±Í≥ºÌèâÍ∞Ä Í∞úÏÑ†`
                ],
                'Ïû¨Î¨¥ÌöåÍ≥Ñ': [
                    `Ïû¨Î¨¥Ï†úÌëú Í≥µÏãú ÏùòÎ¨¥ Í∞ïÌôî Î∞è Ìà¨Î™ÖÏÑ± Ï†úÍ≥†`,
                    `ÎÇ¥Î∂ÄÌÜµÏ†úÏãúÏä§ÌÖú Íµ¨Ï∂ï Î∞è Ïö¥ÏòÅ ÏùòÎ¨¥Ìôî`,
                    `ÌöåÍ≥ÑÍ∞êÏÇ¨ ÎèÖÎ¶ΩÏÑ± Í∞ïÌôî Î∞©Ïïà ÎèÑÏûÖ`
                ],
                'Ï†ïÎ≥¥Î≥¥Ìò∏': [
                    `Í∞úÏù∏Ï†ïÎ≥¥ Ï≤òÎ¶¨Î∞©Ïπ® Í≥µÍ∞ú Î∞è ÎèôÏùò Ï†àÏ∞® Í∞ïÌôî`,
                    `Ï†ïÎ≥¥Î≥¥Ïïà Í¥ÄÎ¶¨Ï≤¥Í≥Ñ Ïù∏Ï¶ù ÏùòÎ¨¥Ìôî`,
                    `Îç∞Ïù¥ÌÑ∞ Ïú†Ï∂ú Ïãú Ïã†Í≥† Î∞è ÎåÄÏùë Ï†àÏ∞® Í∞úÏÑ†`
                ],
                'ÏßÄÎ∞∞Íµ¨Ï°∞': [
                    `Ïù¥ÏÇ¨Ìöå Íµ¨ÏÑ± Îã§ÏñëÏÑ± ÌôïÎ≥¥ Î∞è ÎèÖÎ¶ΩÏÑ± Í∞ïÌôî`,
                    `Ï£ºÏ£ºÏ¥ùÌöå Ïö¥ÏòÅ Ìà¨Î™ÖÏÑ± Ï†úÍ≥† Î∞©Ïïà ÎèÑÏûÖ`,
                    `Í≤ΩÏòÅÏßÑ ÏÑ±Í≥ºÌèâÍ∞Ä Î∞è Î≥¥ÏÉÅÏ≤¥Í≥Ñ Í∞úÏÑ†`
                ]
            };
            
            const templates = contentTemplates[category] || [
                `Í¥ÄÎ†® Í∑úÏ†ïÏùò Î™ÖÌôïÌôî Î∞è Ï†àÏ∞® Í∞ÑÏÜåÌôî`,
                `ÌñâÏ†ïÏ≤òÎ∂Ñ Í∏∞Ï§Ä Ìï©Î¶¨Ìôî Î∞è Íµ¨Ï†úÏ†àÏ∞® Í∞úÏÑ†`,
                `Í¥ÄÎ†® Í∏∞Í¥Ä Í∞Ñ ÌòëÎ†•Ï≤¥Í≥Ñ Í∞ïÌôî`
            ];
            
            const selectedContent = templates[Math.floor(Math.random() * templates.length)];
            
            return `
                <p><strong>Ï£ºÏöî Í∞úÏ†ïÏÇ¨Ìï≠:</strong></p>
                <ul>
                    <li>${selectedContent}</li>
                    <li>Í¥ÄÎ†® Ïö©Ïñ¥ Ï†ïÏùò Î™ÖÌôïÌôî Î∞è Ï†ÅÏö©Î≤îÏúÑ Ï°∞Ï†ï</li>
                    <li>ÌñâÏ†ïÏ†àÏ∞® Í∞ÑÏÜåÌôî Î∞è ÎØºÏõêÏù∏ Ìé∏Ïùò Ï¶ùÏßÑ</li>
                    <li>Ï†úÏû¨ ÏàòÏ§Ä Ï°∞Ï†ï Î∞è Íµ¨Ï†úÏ†àÏ∞® Í∞úÏÑ†</li>
                </ul>
                <p><strong>Í∞úÏ†ï ÌòïÌÉú:</strong> ${lawType}</p>
            `;
        }
        
        function generateAmendmentArticles(item) {
            const category = item.categories?.[0] || 'Í∏∞ÌÉÄ';
            
            const articleTemplates = {
                'ÏïàÏ†Ñ': [
                    `Ï†ú8Ï°∞(ÏïàÏ†ÑÍ¥ÄÎ¶¨ ÏùòÎ¨¥) - ÏïàÏ†ÑÍ¥ÄÎ¶¨ Ï±ÖÏûÑÏûê ÏßÄÏ†ï Î∞è ÍµêÏú° Í∞ïÌôî`,
                    `Ï†ú15Ï°∞(ÏïàÏ†ÑÏ†êÍ≤Ä) - Ï†ïÍ∏∞Ï†êÍ≤Ä Ï£ºÍ∏∞ Îã®Ï∂ï Î∞è Ï†êÍ≤ÄÌï≠Î™© ÏÑ∏Î∂ÑÌôî`,
                    `Ï†ú22Ï°∞(ÏÇ¨Í≥†Î≥¥Í≥†) - ÏÇ¨Í≥† Î∞úÏÉù Ïãú Ï¶âÏãú Ïã†Í≥† ÏùòÎ¨¥ Î∞è Ï†àÏ∞® Î™ÖÌôïÌôî`
                ],
                'ÌôòÍ≤Ω': [
                    `Ï†ú12Ï°∞(ÌôòÍ≤ΩÏòÅÌñ•ÌèâÍ∞Ä) - ÌèâÍ∞Ä ÎåÄÏÉÅ ÌôïÎåÄ Î∞è Ï†àÏ∞® Í∞ïÌôî`,
                    `Ï†ú18Ï°∞(Î∞∞Ï∂úÍ∏∞Ï§Ä) - Ïò§ÏóºÎ¨ºÏßà Î∞∞Ï∂úÌóàÏö©Í∏∞Ï§Ä Í∞ïÌôî`,
                    `Ï†ú25Ï°∞(ÌôòÍ≤ΩÍ∞úÏÑ†) - ÌôòÍ≤ΩÍ∞úÏÑ†Î™ÖÎ†π Î∞úÎ†π ÏöîÍ±¥ Î∞è Ï†àÏ∞® Í∞úÏÑ†`
                ],
                'Ïù∏ÏÇ¨ÎÖ∏Î¨¥': [
                    `Ï†ú9Ï°∞(Í∑ºÎ°úÍ≥ÑÏïΩ) - Í≥ÑÏïΩÏÑú ÏûëÏÑ± ÏùòÎ¨¥ÏÇ¨Ìï≠ Ï∂îÍ∞Ä Î∞è Î™ÖÌôïÌôî`,
                    `Ï†ú16Ï°∞(Í∑ºÎ°úÏãúÍ∞Ñ) - Ïó∞Ïû•Í∑ºÎ°ú Ï†úÌïú Î∞è Ìú¥Í≤åÏãúÍ∞Ñ Î≥¥Ïû•`,
                    `Ï†ú23Ï°∞(Ìú¥Í∞ÄÏ†úÎèÑ) - Ïó∞Ï∞®Ìú¥Í∞Ä ÏÇ¨Ïö© Ï¥âÏßÑ Î∞è ÎåÄÏ≤¥Ìú¥Í∞Ä ÌôïÎåÄ`
                ],
                'Ïû¨Î¨¥ÌöåÍ≥Ñ': [
                    `Ï†ú7Ï°∞(Ïû¨Î¨¥Ï†úÌëú ÏûëÏÑ±) - ÏûëÏÑ± Í∏∞Ï§Ä Î∞è Í≥µÏãú ÏùòÎ¨¥ Í∞ïÌôî`,
                    `Ï†ú14Ï°∞(Í∞êÏÇ¨ÏúÑÏõêÌöå) - Íµ¨ÏÑ± ÏöîÍ±¥ Î∞è ÎèÖÎ¶ΩÏÑ± ÌôïÎ≥¥ Î∞©Ïïà`,
                    `Ï†ú21Ï°∞(ÎÇ¥Î∂ÄÌÜµÏ†ú) - ÎÇ¥Î∂ÄÌÜµÏ†úÏãúÏä§ÌÖú Íµ¨Ï∂ï Î∞è Ïö¥ÏòÅ Í∏∞Ï§Ä`
                ],
                'Ï†ïÎ≥¥Î≥¥Ìò∏': [
                    `Ï†ú6Ï°∞(Í∞úÏù∏Ï†ïÎ≥¥ ÏàòÏßë) - ÏàòÏßë Î™©Ï†Å Î™ÖÏãú Î∞è ÎèôÏùò Ï†àÏ∞® Í∞ïÌôî`,
                    `Ï†ú13Ï°∞(Ï†ïÎ≥¥Î≥¥Ïïà) - Î≥¥ÏïàÍ¥ÄÎ¶¨Ï≤¥Í≥Ñ Íµ¨Ï∂ï Î∞è Ïù∏Ï¶ù Ï∑®Îìù`,
                    `Ï†ú20Ï°∞(Ï†ïÎ≥¥Ïú†Ï∂ú ÎåÄÏùë) - Ïú†Ï∂ú Ïãú Ïã†Í≥† ÏùòÎ¨¥ Î∞è ÎåÄÏùëÏ†àÏ∞®`
                ],
                'ÏßÄÎ∞∞Íµ¨Ï°∞': [
                    `Ï†ú5Ï°∞(Ïù¥ÏÇ¨Ìöå Íµ¨ÏÑ±) - ÎèÖÎ¶ΩÏù¥ÏÇ¨ ÎπÑÏú® ÌôïÎåÄ Î∞è Îã§ÏñëÏÑ± ÌôïÎ≥¥`,
                    `Ï†ú11Ï°∞(Ï£ºÏ£ºÏ¥ùÌöå) - ÏùòÍ≤∞Í∂å ÌñâÏÇ¨ Î∞è Ï†ïÎ≥¥Ï†úÍ≥µ Í∞úÏÑ†`,
                    `Ï†ú19Ï°∞(ÏûÑÏõêÎ≥¥Ïàò) - Î≥¥ÏàòÏ≤¥Í≥Ñ Í≥µÏãú Î∞è ÏÑ±Í≥ºÏó∞Îèô Í∞ïÌôî`
                ]
            };
            
            const templates = articleTemplates[category] || [
                `Ï†ú4Ï°∞(Ï†ÅÏö©Î≤îÏúÑ) - Ï†ÅÏö© ÎåÄÏÉÅ Î∞è Î≤îÏúÑ Î™ÖÌôïÌôî`,
                `Ï†ú10Ï°∞(Ï†àÏ∞®Í∑úÏ†ï) - ÌñâÏ†ïÏ†àÏ∞® Í∞ÑÏÜåÌôî Î∞è Ï≤òÎ¶¨Í∏∞Ìïú Îã®Ï∂ï`,
                `Ï†ú17Ï°∞(Î≤åÏπôÍ∑úÏ†ï) - ÏúÑÎ∞ò Ïãú Ï†úÏû¨ ÏàòÏ§Ä Ï°∞Ï†ï Î∞è Íµ¨Ï†úÏ†àÏ∞® Í∞úÏÑ†`
            ];
            
            const selectedArticles = [...templates].sort(() => 0.5 - Math.random()).slice(0, 3);
            
            return `
                <p><strong>Ï£ºÏöî Í∞úÏ†ï Ï°∞Ìï≠:</strong></p>
                <ul>
                    ${selectedArticles.map(article => `<li>${article}</li>`).join('')}
                </ul>
                <p><em>‚Äª ÏÉÅÏÑ∏Ìïú Ï°∞Î¨∏ ÎÇ¥Ïö©ÏùÄ Íµ≠Í∞ÄÎ≤ïÎ†πÏ†ïÎ≥¥ÏÑºÌÑ∞ÏóêÏÑú ÌôïÏù∏ÌïòÏãúÍ∏∞ Î∞îÎûçÎãàÎã§.</em></p>
            `;
        }


        function closeLawModal() {
            document.getElementById('law-modal').classList.remove('show');
        }

        function closeQuarterlyModal() {
            document.getElementById('quarterly-modal').classList.remove('show');
        }

        function scrollToCategory(category) {
            const targetElement = document.getElementById(`category-${category}`);
            if (targetElement) {
                // Ïä§Î¨¥Ïä§ Ïä§ÌÅ¨Î°§ Ìö®Í≥ºÎ°ú Ìï¥Îãπ Ïπ¥ÌÖåÍ≥†Î¶¨Î°ú Ïù¥Îèô
                targetElement.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start',
                    inline: 'nearest'
                });
                
                // ÏãúÍ∞ÅÏ†Å ÌîºÎìúÎ∞±ÏùÑ ÏúÑÌïú ÌïòÏù¥ÎùºÏù¥Ìä∏ Ìö®Í≥º
                const header = targetElement.querySelector('div:first-child');
                if (header) {
                    const originalStyle = header.style.transform;
                    header.style.transform = 'scale(1.02)';
                    header.style.transition = 'transform 0.3s ease';
                    
                    setTimeout(() => {
                        header.style.transform = originalStyle;
                    }, 300);
                }
            }
        }



        // Law Registry Tab Functions
        function showJobFunctionLaws(jobFunction, jobTitle) {
            console.log('Showing laws for job function:', jobFunction);
            
            // Update active job function
            document.querySelectorAll('.job-function-item').forEach(item => {
                item.classList.remove('active');
            });
            document.querySelector(`[data-job="${jobFunction}"]`).classList.add('active');
            
            // Filter laws based on job function
            let filteredLaws;
            if (jobFunction === 'all') {
                filteredLaws = lawsData;
            } else {
                filteredLaws = lawsData.filter(law => 
                    law.categories && law.categories.includes(jobFunction)
                );
            }
            
            // Update header (fix icon duplication issue)
            if (jobFunction === 'all') {
                document.getElementById('job-function-icon').textContent = 'üìã';
                document.getElementById('job-function-title').textContent = 'Ï†ÑÏ≤¥ Ï†ÅÏö© Î≤ïÍ∑ú';
            } else {
                // Extract icon from jobTitle and clean title
                const parts = jobTitle.split(' ');
                const icon = parts[0]; // First part is the icon (e.g., 'üë•')
                const title = parts.slice(1).join(' '); // Rest is the title
                
                document.getElementById('job-function-icon').textContent = icon;
                document.getElementById('job-function-title').textContent = title + ' Ï†ÅÏö© Î≤ïÍ∑ú';
            }
            document.getElementById('job-function-count').textContent = `${filteredLaws.length}Í±¥`;
            
            // Generate simplified law list (law name only, direct link to law center)
            const lawsHtml = filteredLaws.map((law, index) => {
                // source.urlÏùÑ Ïö∞ÏÑ†Ï†ÅÏúºÎ°ú ÏÇ¨Ïö© (Ïù¥ÎØ∏ Ïò¨Î∞îÎ•∏ URLÏù¥ Ï†ÄÏû•ÎêòÏñ¥ ÏûàÏùå)
                let lawUrl;
                if (law.source?.url) {
                    // source URLÏù¥ ÏûàÏúºÎ©¥ ÏÇ¨Ïö© (Ïù¥ÎØ∏ Ïò¨Î∞îÎ•∏ ÌòïÏãù)
                    lawUrl = law.source.url;
                } else if (law.meta?.lsId) {
                    // source URLÏù¥ ÏóÜÏúºÎ©¥ Î≤ïÎ†π IDÎ°ú URL ÏÉùÏÑ±
                    lawUrl = `https://www.law.go.kr/LSW/lsInfoP.do?lsId=${law.meta.lsId}`;
                } else {
                    // Îëò Îã§ ÏóÜÏúºÎ©¥ Ï†úÎ™©ÏúºÎ°ú Í≤ÄÏÉâ
                    lawUrl = `https://www.law.go.kr/lsSc.do?query=${encodeURIComponent(law.title)}`;
                }
                const safeUrl = lawUrl.replace(/'/g, '&quot;');
                
                return `
                    <div class="registry-law-item" onclick="window.open('${safeUrl}', '_blank'); return false;" title="${law.title} - Î≤ïÎ†πID: ${law.meta?.lsId || 'ÏóÜÏùå'}">
                        <div class="registry-law-number">${index + 1}.</div>
                        <div class="registry-law-title">${law.title}</div>
                        <div class="registry-law-link">
                            <span>üîó</span>
                            <span>Íµ≠Í∞ÄÎ≤ïÎ†πÏ†ïÎ≥¥ÏÑºÌÑ∞</span>
                        </div>
                    </div>
                `;
            }).join('');
            
            // Update laws panel
            if (filteredLaws.length > 0) {
                document.getElementById('job-function-laws').innerHTML = lawsHtml;
            } else {
                document.getElementById('job-function-laws').innerHTML = `
                    <div style="padding: 2rem; text-align: center; color: var(--text-muted);">
                        Ìï¥Îãπ ÏßÅÎ¨¥Ïóê Ï†ÅÏö©ÎêòÎäî Î≤ïÍ∑úÍ∞Ä ÏóÜÏäµÎãàÎã§.
                    </div>
                `;
            }
        }

        function updateJobFunctionCounts() {
            if (!lawsData || lawsData.length === 0) return;
            
            const categoryIcons = {
                'Ïù∏ÏÇ¨ÎÖ∏Î¨¥': 'üë•',
                'Í≥µÏ†ïÍ±∞Îûò': '‚öñÔ∏è',
                'Ï†ïÎ≥¥Î≥¥Ìò∏': 'üîí',
                'ÏßÄÏãùÏû¨ÏÇ∞Í∂å': 'üí°',
                'Ïû¨Î¨¥ÌöåÍ≥Ñ': 'üí∞',
                'ÏïàÏ†Ñ': 'üõ°Ô∏è',
                'ÌôòÍ≤Ω': 'üå±',
                'ÏßÄÎ∞∞Íµ¨Ï°∞': 'üèõÔ∏è'
            };
            
            // Count laws for each category
            const categoryCounts = {};
            lawsData.forEach(law => {
                if (law.categories && law.categories.length > 0) {
                    law.categories.forEach(category => {
                        categoryCounts[category] = (categoryCounts[category] || 0) + 1;
                    });
                }
            });
            
            // Update counts in job function list
            Object.keys(categoryCounts).forEach(category => {
                const countElement = document.getElementById(`job-count-${category}`);
                if (countElement) {
                    countElement.textContent = categoryCounts[category];
                }
            });
            
            // Update total count
            const totalCountElement = document.getElementById('job-count-all');
            if (totalCountElement) {
                totalCountElement.textContent = lawsData.length;
            }
            
            // Update registry total count in header
            const registryTotalElement = document.getElementById('registry-total-count');
            if (registryTotalElement) {
                registryTotalElement.textContent = lawsData.length;
            }
        }



        function getDaysFromNow(dateStr) {
            if (!dateStr) return null;
            const targetDate = new Date(dateStr);
            const today = new Date();
            const diffTime = targetDate - today;
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            return diffDays;
        }

        function showError(message) {
            document.getElementById('law-list').innerHTML = `<div class="error">${message}</div>`;
            document.getElementById('law-count').textContent = '(Ïò§Î•ò)';
        }

        // Modal Ïô∏Î∂Ä ÌÅ¥Î¶≠ Ïãú Îã´Í∏∞
        document.getElementById('law-modal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeLawModal();
            }
        });
        
        document.getElementById('quarterly-modal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeQuarterlyModal();
            }
        });

        // ===========================================
        // Ïù¥Î©îÏùº ÏïåÎ¶º ÏÑ§Ï†ï ÏãúÏä§ÌÖú
        // ===========================================

        // EmailJS Ï¥àÍ∏∞Ìôî (ÏÇ¨Ïö©ÏûêÍ∞Ä API ÌÇ§Î•º ÏÑ§Ï†ïÌï¥Ïïº Ìï®)
        let emailjsInitialized = false;

        // ÏÑ§Ï†ï Î™®Îã¨ Ïó¥Í∏∞/Îã´Í∏∞
        function openSettingsModal() {
            const modal = document.getElementById('settings-modal');
            modal.classList.add('show');
            loadEmailSettings();
            loadQuarterlyDataForEmail(); // Ïã§Ï†ú Îç∞Ïù¥ÌÑ∞ Î°úÎìú
            updateEmailPreview();
        }

        function closeSettingsModal() {
            const modal = document.getElementById('settings-modal');
            modal.classList.remove('show');
        }

        // Î°úÏª¨ Ïä§ÌÜ†Î¶¨ÏßÄÏóêÏÑú ÏÑ§Ï†ï Î∂àÎü¨Ïò§Í∏∞
        function loadEmailSettings() {
            const settings = getEmailSettings();
            
            document.getElementById('email-recipients').value = settings.recipients.join('\n');
            document.getElementById('sender-name').value = settings.senderName;
            document.getElementById('notify-q1').checked = settings.quarters.Q1;
            document.getElementById('notify-q2').checked = settings.quarters.Q2;
            document.getElementById('notify-q3').checked = settings.quarters.Q3;
            document.getElementById('notify-q4').checked = settings.quarters.Q4;
        }

        // ÏÑ§Ï†ï Ï†ÄÏû•
        function saveEmailSettings() {
            const recipients = document.getElementById('email-recipients').value
                .split('\n')
                .map(email => email.trim())
                .filter(email => email && isValidEmail(email));

            if (recipients.length === 0) {
                showNotification('error', 'Ïú†Ìö®Ìïú Ïù¥Î©îÏùº Ï£ºÏÜåÎ•º ÏµúÏÜå ÌïòÎÇò Ïù¥ÏÉÅ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }

            const settings = {
                recipients: recipients,
                senderName: document.getElementById('sender-name').value.trim() || 'LAW WATCH ÏãúÏä§ÌÖú',
                quarters: {
                    Q1: document.getElementById('notify-q1').checked,
                    Q2: document.getElementById('notify-q2').checked,
                    Q3: document.getElementById('notify-q3').checked,
                    Q4: document.getElementById('notify-q4').checked
                },
                lastUpdated: new Date().toISOString()
            };

            localStorage.setItem('lawwatch_email_settings', JSON.stringify(settings));
            
            showNotification('success', `ÏÑ§Ï†ïÏù¥ Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§. ${recipients.length}Î™ÖÏùò ÏàòÏã†ÏûêÍ∞Ä Îì±Î°ùÎêòÏóàÏäµÎãàÎã§.`);
            scheduleNotifications();
        }

        // Í∏∞Î≥∏ ÏÑ§Ï†ï Î∞òÌôò
        function getEmailSettings() {
            const defaultSettings = {
                recipients: [],
                senderName: 'LAW WATCH ÏãúÏä§ÌÖú',
                quarters: { Q1: true, Q2: true, Q3: true, Q4: true },
                lastUpdated: null
            };

            try {
                const saved = localStorage.getItem('lawwatch_email_settings');
                return saved ? { ...defaultSettings, ...JSON.parse(saved) } : defaultSettings;
            } catch (e) {
                return defaultSettings;
            }
        }

        // Ïù¥Î©îÏùº Ïú†Ìö®ÏÑ± Í≤ÄÏÇ¨
        function isValidEmail(email) {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return emailRegex.test(email);
        }

        // ÏïåÎ¶º ÌëúÏãú
        function showNotification(type, message) {
            const statusDiv = document.getElementById('notification-status');
            statusDiv.className = `notification-status ${type}`;
            statusDiv.textContent = message;
            statusDiv.style.display = 'block';

            setTimeout(() => {
                statusDiv.style.display = 'none';
            }, 5000);
        }

        // Ïù¥Î©îÏùº ÎØ∏Î¶¨Î≥¥Í∏∞ ÏóÖÎç∞Ïù¥Ìä∏
        function updateEmailPreview() {
            const currentQuarter = getCurrentQuarter();
            const nextQuarter = getNextQuarter();
            const quarterlyData = getQuarterlyData();
            
            const preview = `
                üìß Ï†úÎ™©: [LAW WATCH] ${nextQuarter} ÏãúÌñâ ÏòàÏ†ï Î≤ïÎ†π ÏïåÎ¶º (${quarterlyData[nextQuarter]?.count || 0}Í±¥)
                
                ÏïàÎÖïÌïòÏÑ∏Ïöî, ${document.getElementById('sender-name').value || 'LAW WATCH ÏãúÏä§ÌÖú'}ÏûÖÎãàÎã§.
                
                üóìÔ∏è ${nextQuarter} ÏãúÌñâ ÏòàÏ†ïÏù∏ ÎãπÏÇ¨ Ï†ÅÏö© Î≤ïÎ†π ${quarterlyData[nextQuarter]?.count || 0}Í±¥ÏùÑ ÏïàÎÇ¥ÎìúÎ¶ΩÎãàÎã§.
                
                Ï£ºÏöî Î≤ïÎ†π:
                ${quarterlyData[nextQuarter]?.laws?.slice(0, 3).map(law => `‚Ä¢ ${law.title}`).join('\n                ') || '‚Ä¢ Îç∞Ïù¥ÌÑ∞ Î°úÎî© Ï§ë...'}
                ${quarterlyData[nextQuarter]?.laws?.length > 3 ? '‚Ä¢ Í∑∏ Ïô∏ ' + (quarterlyData[nextQuarter].laws.length - 3) + 'Í±¥...' : ''}
                
                üìä Ï†ÑÏ≤¥ ÌòÑÌô© Î≥¥Í∏∞: https://your-domain.github.io/webapp/
                
                Ïù¥ Î©îÏùºÏùÄ Î∂ÑÍ∏∞ ÏãúÏûë 1Ï£ºÏùº Ï†ÑÏóê ÏûêÎèôÏúºÎ°ú Î∞úÏÜ°Îê©ÎãàÎã§.
            `;

            document.getElementById('email-preview-content').textContent = preview;
        }

        // ÌòÑÏû¨ Î∂ÑÍ∏∞ Í≥ÑÏÇ∞
        function getCurrentQuarter() {
            const month = new Date().getMonth() + 1;
            if (month <= 3) return 'Q1';
            if (month <= 6) return 'Q2';
            if (month <= 9) return 'Q3';
            return 'Q4';
        }

        // Îã§Ïùå Î∂ÑÍ∏∞ Í≥ÑÏÇ∞
        function getNextQuarter() {
            const current = getCurrentQuarter();
            const quarters = ['Q1', 'Q2', 'Q3', 'Q4'];
            const currentIndex = quarters.indexOf(current);
            return quarters[(currentIndex + 1) % 4];
        }

        // Ï†ÑÏó≠ Î≥ÄÏàòÎ°ú quarterly Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
        let globalQuarterlyData = {
            Q1: { count: 10, laws: [] },
            Q2: { count: 23, laws: [] },
            Q3: { count: 28, laws: [] },
            Q4: { count: 31, laws: [] }
        };

        // Î∂ÑÍ∏∞Î≥Ñ Îç∞Ïù¥ÌÑ∞ Í∞ÄÏ†∏Ïò§Í∏∞ (Ïã§Ï†ú Îç∞Ïù¥ÌÑ∞ ÌôúÏö©)
        function getQuarterlyData() {
            return globalQuarterlyData;
        }

        // quarterly_details.jsonÏóêÏÑú Ïã§Ï†ú Îç∞Ïù¥ÌÑ∞ Î°úÎìú
        function loadQuarterlyDataForEmail() {
            fetch('quarterly_details.json')
                .then(response => response.json())
                .then(data => {
                    globalQuarterlyData = {
                        Q1: { 
                            count: data.quarters.Q1.count, 
                            laws: data.quarters.Q1.laws.slice(0, 5) // ÏÉÅÏúÑ 5Í∞úÎßå
                        },
                        Q2: { 
                            count: data.quarters.Q2.count, 
                            laws: data.quarters.Q2.laws.slice(0, 5) 
                        },
                        Q3: { 
                            count: data.quarters.Q3.count, 
                            laws: data.quarters.Q3.laws.slice(0, 5) 
                        },
                        Q4: { 
                            count: data.quarters.Q4.count, 
                            laws: data.quarters.Q4.laws.slice(0, 5) 
                        }
                    };
                    updateEmailPreview(); // Îç∞Ïù¥ÌÑ∞ Î°úÎìú ÌõÑ ÎØ∏Î¶¨Î≥¥Í∏∞ ÏóÖÎç∞Ïù¥Ìä∏
                })
                .catch(e => {
                    console.log('quarterly_details.json Î°úÎìú Ïã§Ìå®, Í∏∞Î≥∏Í∞í ÏÇ¨Ïö©:', e);
                });
        }

        // ÌÖåÏä§Ìä∏ Ïù¥Î©îÏùº Î∞úÏÜ°
        function testEmailSending() {
            const settings = getEmailSettings();
            const recipients = document.getElementById('email-recipients').value
                .split('\n')
                .map(email => email.trim())
                .filter(email => email && isValidEmail(email));

            if (recipients.length === 0) {
                showNotification('error', 'Ïú†Ìö®Ìïú Ïù¥Î©îÏùº Ï£ºÏÜåÎ•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }

            if (!emailjsInitialized) {
                showNotification('error', 'EmailJS ÏÑ§Ï†ïÏù¥ ÌïÑÏöîÌï©ÎãàÎã§. Í¥ÄÎ¶¨ÏûêÏóêÍ≤å Î¨∏ÏùòÌïòÏÑ∏Ïöî.');
                return;
            }

            showNotification('success', 'ÌÖåÏä§Ìä∏ Ïù¥Î©îÏùºÏùÑ Î∞úÏÜ° Ï§ëÏûÖÎãàÎã§...');
            
            // Ïã§Ï†ú EmailJS Î∞úÏÜ° Î°úÏßÅÏùÄ API ÌÇ§ ÏÑ§Ï†ï ÌõÑ Íµ¨ÌòÑ
            setTimeout(() => {
                showNotification('success', `ÌÖåÏä§Ìä∏ Ïù¥Î©îÏùºÏù¥ ${recipients.length}Î™ÖÏóêÍ≤å Î∞úÏÜ°ÎêòÏóàÏäµÎãàÎã§.`);
            }, 2000);
        }

        // ÏïåÎ¶º Ïä§ÏºÄÏ§ÑÎßÅ (Ïã§Ï†úÎ°úÎäî ÏÑúÎ≤Ñ ÏÇ¨Ïù¥ÎìúÎÇò GitHub Actions ÌïÑÏöî)
        function scheduleNotifications() {
            const settings = getEmailSettings();
            console.log('üìß Ïù¥Î©îÏùº ÏïåÎ¶º Ïä§ÏºÄÏ§Ñ ÏÑ§Ï†ïÎê®:', settings);
            
            // Ìñ•ÌõÑ GitHub ActionsÎÇò Îã§Î•∏ Ïä§ÏºÄÏ§ÑÎßÅ ÏãúÏä§ÌÖúÍ≥º Ïó∞Îèô
            showNotification('success', 'ÏïåÎ¶º Ïä§ÏºÄÏ§ÑÏù¥ ÏÑ§Ï†ïÎêòÏóàÏäµÎãàÎã§.');
        }

        // Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà Ï∂îÍ∞Ä
        document.getElementById('settings-modal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeSettingsModal();
            }
        });

        // Ìèº Î≥ÄÍ≤Ω Ïãú ÎØ∏Î¶¨Î≥¥Í∏∞ ÏóÖÎç∞Ïù¥Ìä∏
        document.getElementById('sender-name').addEventListener('input', updateEmailPreview);
        
        // Ï¥àÍ∏∞Ìôî
        document.addEventListener('DOMContentLoaded', function() {
            // EmailJS Ï¥àÍ∏∞ÌôîÎäî ÏÇ¨Ïö©ÏûêÍ∞Ä Î≥ÑÎèÑÎ°ú ÏÑ§Ï†ïÌï¥Ïïº Ìï®
            console.log('üìß Ïù¥Î©îÏùº ÏïåÎ¶º ÏãúÏä§ÌÖú Ï¥àÍ∏∞Ìôî ÏôÑÎ£å');
            console.log('üí° EmailJS ÏÑ§Ï†ï Î∞©Î≤ï:');
            console.log('1. https://www.emailjs.com/ ÏóêÏÑú Í≥ÑÏ†ï ÏÉùÏÑ±');
            console.log('2. ÏÑúÎπÑÏä§ Î∞è ÌÖúÌîåÎ¶ø ÏÑ§Ï†ï');
            console.log('3. emailjs.init("YOUR_PUBLIC_KEY") Ï∂îÍ∞Ä');
        });
    </script>
</body>
</html>
