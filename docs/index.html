<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RegRader ¬∑ AIÎ•º ÌôúÏö©Ìïú Î≤ïÍ∑ú Í∞úÏ†ï Î™®ÎãàÌÑ∞ÎßÅ ÏãúÏä§ÌÖú</title>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta name="cache-version" content="2025.09.04.003">
    <link rel="shortcut icon" href="data:text/plain;base64,üèõÔ∏è">
    
    <!-- PWA ÏÑ§Ï†ï -->
    <link rel="manifest" href="./manifest.json">
    <meta name="theme-color" content="#667eea">
    <link rel="apple-touch-icon" href="./icon-192.png">
    
    <!-- Î™®Î∞îÏùº Í∏∞Í∏∞ Í∞êÏßÄ Î∞è ÏÑ†ÌÉùÏ†Å Î¶¨Îã§Ïù¥Î†âÏÖò -->
    <script>
        (function() {
            // Í∞ïÏ†úÎ°ú PC Î≤ÑÏ†ÑÏùÑ ÏõêÌïòÎäî Í≤ΩÏö∞ Ï≤¥ÌÅ¨
            var urlParams = new URLSearchParams(window.location.search);
            if (urlParams.get('desktop') === 'true' || localStorage.getItem('forceDesktop') === 'true') {
                console.log('Force desktop mode enabled');
                return;
            }
            
            // Ïù¥ÎØ∏ Î™®Î∞îÏùº ÌéòÏù¥ÏßÄÏóêÏÑú ÏôîÎäîÏßÄ ÌôïÏù∏ (Î¨¥Ìïú Î£®ÌîÑ Î∞©ÏßÄ)
            if (document.referrer && document.referrer.includes('mobile_v2.html')) {
                console.log('User came from mobile version, staying on desktop');
                localStorage.setItem('forceDesktop', 'true');
                return;
            }
            
            // Î™®Î∞îÏùº Í∏∞Í∏∞ Í∞êÏßÄ
            var isMobile = false;
            
            // 1. User Agent Ï≤¥ÌÅ¨ - Îçî ÏóÑÍ≤©Ìïú Î™®Î∞îÏùº Ï≤¥ÌÅ¨
            var mobileOnlyRegex = /Android|iPhone|iPod|BlackBerry|IEMobile|Opera Mini/i;
            var tabletRegex = /iPad|Android.*tablet|tablet.*Android/i;
            
            // ÌÉúÎ∏îÎ¶øÏùÄ PC Î≤ÑÏ†ÑÏúºÎ°ú Î≥¥ÎÇ¥Í∏∞
            if (tabletRegex.test(navigator.userAgent)) {
                console.log('Tablet detected, staying on desktop version');
                return;
            }
            
            // Î™®Î∞îÏùº Ìè∞Îßå Î™®Î∞îÏùº Î≤ÑÏ†ÑÏúºÎ°ú
            if (mobileOnlyRegex.test(navigator.userAgent)) {
                isMobile = true;
                console.log('Mobile phone detected by User Agent');
            }
            
            // 2. ÌôîÎ©¥ ÌÅ¨Í∏∞ Ï≤¥ÌÅ¨ - Îçî ÏóÑÍ≤©ÌïòÍ≤å (600px Ïù¥ÌïòÎßå)
            if (!isMobile && window.innerWidth <= 600) {
                isMobile = true;
                console.log('Small screen detected (<=600px)');
            }
            
            // 3. ÌÑ∞Ïπò ÏßÄÏõêÍ≥º ÌôîÎ©¥ ÌÅ¨Í∏∞ Ï°∞Ìï© - Îçî ÏóÑÍ≤©ÌïòÍ≤å
            var hasTouch = ('ontouchstart' in window) || (navigator.maxTouchPoints > 0);
            if (!isMobile && hasTouch && window.innerWidth <= 600 && window.orientation !== undefined) {
                isMobile = true;
                console.log('Mobile detected by touch + small screen + orientation');
            }
            
            // Î™®Î∞îÏùºÏù¥Î©¥ Î¶¨ÎîîÎ†âÏÖò
            if (isMobile) {
                console.log('Redirecting to mobile version...');
                // Ìïú Î≤àÎßå Î¶¨Îã§Ïù¥Î†âÌä∏ÎêòÎèÑÎ°ù ÌîåÎûòÍ∑∏ ÏÑ§Ï†ï
                sessionStorage.setItem('mobileRedirected', 'true');
                window.location.replace('./mobile_v2.html');
            }
        })();
    </script>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
    <script type="text/javascript">
        // EmailJS Ï¥àÍ∏∞Ìôî
        (function(){
            emailjs.init("Nt6PrPKpsL1ruZEIH");
        })();
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        :root {
            --primary: #667eea;
            --primary-light: #764ba2;
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary: #f093fb;
            --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --accent: #4facfe;
            --accent-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --success: #11998e;
            --success-gradient: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            --warning: #f093fb;
            --warning-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --danger: #fc466b;
            --danger-gradient: linear-gradient(135deg, #fc466b 0%, #3f5efb 100%);
            
            --glass-bg: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
            --glass-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
            
            --text-primary: #1a202c;
            --text-secondary: #4a5568;
            --text-muted: #718096;
            --text-white: #ffffff;
            
            --bg-primary: #f7fafc;
            --bg-secondary: #edf2f7;
            --bg-card: #ffffff;
            --bg-glass: rgba(255, 255, 255, 0.25);
            --border: #e2e8f0;
            --shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            
            --c-safety: #48bb78;
            --c-env: #38b2ac;
            --c-hr: #ed8936;
            --c-gov: #9f7aea;
            --c-fin: #4299e1;
            --c-sec: #f56565;
            --c-etc: #a0aec0;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --text-primary: #f7fafc;
                --text-secondary: #e2e8f0;
                --text-muted: #a0aec0;
                --bg-primary: #1a202c;
                --bg-secondary: #2d3748;
                --bg-card: #2d3748;
                --bg-glass: rgba(45, 55, 72, 0.25);
                --border: #4a5568;
                --glass-bg: rgba(45, 55, 72, 0.1);
            }
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            background-image: 
                radial-gradient(circle at 25% 25%, #667eea22 0%, transparent 50%),
                radial-gradient(circle at 75% 75%, #f093fb22 0%, transparent 50%);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 1rem;
        }

        /* Glassmorphism Header */
        .header {
            background: var(--primary-gradient);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 24px;
            padding: 3rem 2rem 1.5rem 2rem;
            margin-bottom: 2rem;
            text-align: center;
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-xl);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            min-height: 280px;
        }

        /* Settings Button */
        .settings-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 2;
            font-size: 1.2rem;
            color: white;
            text-decoration: none;
        }

        .settings-btn:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: scale(1.1);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }

        /* Update Button */
        .update-btn {
            position: absolute;
            top: 1rem;
            right: 5rem;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 2;
            font-size: 1.2rem;
            color: white;
            text-decoration: none;
        }

        .update-btn:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: scale(1.1);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }
        
        .update-btn svg, .settings-btn svg {
            width: 20px;
            height: 20px;
        }

        .update-btn:active {
            transform: scale(0.95);
        }

        .update-btn.loading {
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: float 20s infinite linear;
        }

        @keyframes float {
            0% { transform: translate(-50%, -50%) rotate(0deg); }
            100% { transform: translate(-50%, -50%) rotate(360deg); }
        }

        .header h1 {
            font-size: 3.5rem;
            font-weight: 900;
            color: white;
            margin-bottom: 0.3rem;
            position: relative;
            z-index: 1;
            text-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .header .subtitle {
            font-size: 1.4rem;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 0;
            margin-top: -0.5rem;
            position: relative;
            z-index: 1;
            font-weight: 500;
        }

        .header .header-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transform: translateY(-1rem);
        }

        .header .meta {
            font-size: 0.85rem;
            color: rgba(255, 255, 255, 0.75);
            position: relative;
            z-index: 1;
            margin-top: auto;
            padding-top: 1.5rem;
            border-top: 1px solid rgba(255, 255, 255, 0.15);
            line-height: 1.4;
            align-self: stretch;
        }

        /* Settings Button */
        .settings-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 2;
            font-size: 1.2rem;
            color: white;
            text-decoration: none;
        }

        .settings-btn:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: scale(1.1);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }

        /* Quarterly View Styles */
        .quarterly-view {
            background: var(--bg-glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: var(--glass-shadow);
        }

        .filter-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .quarterly-tabs {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .quarterly-tab {
            background: var(--bg-card);
            border: 2px solid var(--border);
            border-radius: 16px;
            padding: 1.2rem;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            gap: 1rem;
            position: relative;
            overflow: hidden;
        }

        .quarterly-tab::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--primary-gradient);
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 0;
        }

        .quarterly-tab:hover::before {
            opacity: 0.05;
        }

        .quarterly-tab:hover {
            transform: translateY(-8px);
            border-color: var(--primary);
            box-shadow: 0 20px 40px rgba(102, 126, 234, 0.3);
        }

        .quarter-icon {
            font-size: 3rem;
            position: relative;
            z-index: 1;
        }

        .quarter-info {
            position: relative;
            z-index: 1;
            flex: 1;
        }

        .quarter-title {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
            display: flex;
            align-items: baseline;
            gap: 0.5rem;
        }

        .quarter-period {
            font-size: 0.8rem;
            color: var(--text-muted);
            font-weight: 500;
        }

        .quarter-count {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--primary);
        }

        /* Quarter Download Button */
        .quarter-download-btn {
            position: absolute;
            bottom: 0.8rem;
            right: 0.8rem;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
            z-index: 2;
            color: white;
            font-size: 1.2rem;
            text-decoration: none;
            backdrop-filter: blur(10px);
            gap: 1px;
        }
        
        .quarter-download-btn .download-icon {
            font-size: 1.8rem;
            line-height: 1;
        }
        
        .quarter-download-btn .download-text {
            font-size: 0.55rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.3px;
            line-height: 1;
            opacity: 0.9;
            margin-top: 1px;
        }

        .quarter-download-btn:hover {
            transform: scale(1.1) translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.6);
            background: linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%);
            border-color: rgba(255, 255, 255, 0.4);
        }

        .quarter-download-btn:active {
            transform: scale(0.95);
        }

        /* Business Filter */
        .business-filter {
            background: var(--bg-glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: var(--glass-shadow);
        }

        .filter-tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
        }

        .filter-tab {
            padding: 0.75rem 1.25rem;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 0.9rem;
            font-weight: 500;
            white-space: nowrap;
        }

        .filter-tab:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .filter-tab.active {
            background: var(--primary-gradient);
            color: white;
            border-color: transparent;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        /* Main Content */
        .main-content {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .chart-card {
            background: var(--bg-glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 1.5rem;
            box-shadow: var(--glass-shadow);
            min-width: 300px;
        }

        .chart-header {
            margin-bottom: 1rem;
        }

        .chart-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }

        .chart-container {
            height: 250px;
            position: relative;
        }

        .category-legend {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.8rem;
        }

        .legend-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            flex-shrink: 0;
        }

        /* Law List Card */
        .law-card {
            background: var(--bg-glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            overflow: hidden;
            box-shadow: var(--glass-shadow);
        }

        .law-list-header {
            background: var(--primary-gradient);
            color: white;
            padding: 1.5rem;
        }

        .law-list-title {
            font-size: 1.3rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .law-count {
            background: rgba(255, 255, 255, 0.2);
            padding: 0.25rem 0.75rem;
            border-radius: 15px;
            font-size: 0.8rem;
            margin-left: auto;
        }

        .search-container {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border);
        }

        .search-box {
            display: flex;
            align-items: center;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 0.75rem 1rem;
            gap: 0.75rem;
            transition: all 0.2s ease;
        }

        .search-box:focus-within {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .search-input {
            flex: 1;
            border: none;
            background: none;
            outline: none;
            font-size: 0.9rem;
            color: var(--text-primary);
        }

        .search-input::placeholder {
            color: var(--text-muted);
        }

        .law-list {
            max-height: 600px;
            overflow-y: auto;
        }

        .law-item {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .law-item:hover {
            background: rgba(102, 126, 234, 0.05);
        }

        .law-item-header {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            margin-bottom: 0.75rem;
        }

        .law-title {
            flex: 1;
            font-weight: 600;
            color: var(--text-primary);
            line-height: 1.4;
            cursor: pointer;
        }

        .law-title:hover {
            color: var(--primary);
        }

        .date-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            white-space: nowrap;
        }

        .date-badge.urgent {
            background: var(--danger-gradient);
            color: white;
        }

        .date-badge.soon {
            background: var(--accent-gradient);
            color: white;
        }

        .date-badge.active {
            background: var(--success-gradient);
            color: white;
        }

        .law-meta {
            display: flex;
            gap: 1rem;
            align-items: center;
            flex-wrap: wrap;
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .category-tags {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            margin-top: 0.5rem;
        }

        .category-tag {
            padding: 0.25rem 0.5rem;
            border-radius: 8px;
            font-size: 0.7rem;
            font-weight: 500;
        }

        .category-tag.hr { background: rgba(237, 137, 54, 0.1); color: var(--c-hr); }
        .category-tag.fair { background: rgba(56, 178, 172, 0.1); color: var(--c-env); }
        .category-tag.sec { background: rgba(245, 101, 101, 0.1); color: var(--c-sec); }
        .category-tag.ip { background: rgba(159, 122, 234, 0.1); color: var(--c-gov); }
        .category-tag.fin { background: rgba(66, 153, 225, 0.1); color: var(--c-fin); }
        .category-tag.safety { background: rgba(72, 187, 120, 0.1); color: var(--c-safety); }
        .category-tag.env { background: rgba(56, 217, 169, 0.1); color: var(--c-env); }
        .category-tag.gov { background: rgba(128, 90, 213, 0.1); color: var(--c-gov); }
        .category-tag.etc { background: rgba(160, 174, 192, 0.1); color: var(--c-etc); }

        /* Enhanced Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(8px);
            z-index: 2000;
            animation: modalFadeIn 0.3s ease;
        }

        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        @keyframes modalFadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.5);
            border-radius: 24px;
            max-width: 1400px;
            max-height: 95vh;
            width: 98vw;
            overflow: hidden;
            box-shadow: var(--shadow-xl);
            animation: modalSlideIn 0.3s ease;
            color: var(--text-primary);
        }

        @keyframes modalSlideIn {
            from { transform: scale(0.9) translateY(20px); opacity: 0; }
            to { transform: scale(1) translateY(0); opacity: 1; }
        }

        .modal-header {
            background: var(--primary-gradient);
            color: white;
            padding: 2rem;
            position: relative;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            line-height: 1.3;
        }

        .modal-subtitle {
            opacity: 0.9;
            font-size: 1rem;
            font-weight: 500;
        }

        .modal-close {
            position: absolute;
            top: 1.5rem;
            right: 1.5rem;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-close:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        .modal-body {
            padding: 2rem;
            max-height: 70vh;
            overflow-y: auto;
            background: rgba(255, 255, 255, 0.9);
            color: #2d3748;
        }

        /* Settings Form Styles */
        .settings-form {
            max-width: 800px;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
            font-size: 0.95rem;
        }

        .form-input {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 2px solid var(--border);
            border-radius: 12px;
            font-size: 0.95rem;
            background: white;
            transition: all 0.2s ease;
            box-sizing: border-box;
        }

        .form-input:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-textarea {
            min-height: 120px;
            resize: vertical;
            font-family: inherit;
        }

        .form-checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .form-checkbox {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .form-checkbox input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--primary);
        }

        .form-checkbox label {
            font-size: 0.9rem;
            color: var(--text-secondary);
            cursor: pointer;
            margin-bottom: 0;
        }

        .email-preview {
            background: var(--bg-primary);
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1.5rem 0;
        }

        .email-preview h4 {
            margin: 0 0 1rem 0;
            color: var(--primary);
            font-size: 1rem;
        }

        .email-preview-content {
            background: white;
            padding: 1rem;
            border-radius: 8px;
            border: 1px solid var(--border);
            font-size: 0.9rem;
            line-height: 1.6;
            color: var(--text-secondary);
            white-space: pre-line;
        }

        .emailjs-config {
            background: var(--bg-primary);
            padding: 1.5rem;
            border-radius: 12px;
            border: 2px solid var(--border);
        }

        .form-buttons {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
            margin-top: 2rem;
            flex-wrap: wrap;
        }

        .btn-primary, .btn-secondary {
            padding: 0.75rem 1.5rem;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            border: none;
            font-size: 0.95rem;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-light);
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: var(--bg-card);
            color: var(--text-primary);
            border: 2px solid var(--border);
        }

        .btn-secondary:hover {
            background: var(--bg-secondary);
            border-color: var(--primary);
        }

        #notification-status {
            margin-top: 1rem;
            padding: 1rem;
            border-radius: 8px;
            font-size: 0.9rem;
            display: none;
        }

        #notification-status.success {
            background: rgba(17, 153, 142, 0.1);
            color: var(--success);
            border: 1px solid rgba(17, 153, 142, 0.2);
            display: block;
        }

        #notification-status.error {
            background: rgba(252, 70, 107, 0.1);
            color: var(--danger);
            border: 1px solid rgba(252, 70, 107, 0.2);
            display: block;
        }

        .summary-section {
            margin-bottom: 1.5rem;
        }

        .summary-section h4 {
            color: var(--primary);
            margin-bottom: 0.75rem;
            font-weight: 600;
            font-size: 1.1rem;
        }

        .summary-section p {
            margin-bottom: 0.5rem;
            line-height: 1.5;
        }

        .summary-section strong {
            color: var(--text-primary);
        }

        .amendment-box {
            background: rgba(102, 126, 234, 0.08);
            border-left: 4px solid var(--primary);
            padding: 1rem;
            border-radius: 8px;
            margin: 0.5rem 0;
        }

        .amendment-box p {
            margin-bottom: 0.75rem;
            color: #2d3748;
            line-height: 1.5;
        }

        .amendment-box ul {
            margin-left: 1rem;
            color: #2d3748;
            padding-left: 1rem;
        }

        .amendment-box ul li {
            margin-bottom: 0.5rem;
            line-height: 1.4;
        }

        .amendment-box em {
            color: #718096;
            font-size: 0.9rem;
        }
        
        .external-links {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }
        
        .external-link {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: rgba(102, 126, 234, 0.05);
            border: 1px solid rgba(102, 126, 234, 0.1);
            border-radius: 12px;
            text-decoration: none;
            color: #2d3748;
            transition: all 0.2s ease;
        }
        
        .external-link:hover {
            background: rgba(102, 126, 234, 0.1);
            border-color: rgba(102, 126, 234, 0.3);
            transform: translateX(4px);
        }
        
        .link-icon {
            font-size: 1.5rem;
            flex-shrink: 0;
        }
        
        .link-content {
            flex: 1;
        }
        
        .link-title {
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 0.25rem;
        }
        
        .link-desc {
            font-size: 0.8rem;
            color: #718096;
        }
        
        .link-arrow {
            font-size: 1.2rem;
            color: var(--primary);
            font-weight: bold;
        }

        /* Modal animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }

        @keyframes slideIn {
            from { 
                opacity: 0;
                transform: scale(0.9) translateY(-20px);
            }
            to { 
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        /* Quarterly Filter Tabs (similar to business filter tabs) */
        .quarterly-filter-tab {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 0.8rem 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            color: var(--text-primary);
            text-decoration: none;
            margin: 0.25rem;
        }

        .quarterly-filter-tab:hover {
            background: var(--bg-secondary);
            border-color: var(--primary);
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.15);
        }

        .quarterly-filter-tab.active {
            background: var(--primary-gradient);
            color: var(--text-white);
            border-color: var(--primary);
            box-shadow: 0 2px 12px rgba(102, 126, 234, 0.25);
        }

        .quarterly-filter-tab.active span {
            color: var(--text-white);
        }

        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                flex-direction: row;
                overflow-x: auto;
            }
            
            .chart-card {
                min-width: 300px;
            }
        }
        
        @media (max-width: 768px) {
            /* Ï∞®Ìä∏ ÏÑπÏÖòÏùÑ ÏÑ∏Î°úÎ°ú Î∞∞Ïπò */
            div[style*="grid-template-columns: 1fr 1fr"] {
                grid-template-columns: 1fr !important;
            }
            
            /* Î™®Î∞îÏùº ÏµúÏ†ÅÌôî */
            .container {
                padding: 0.5rem;
            }
            
            .header {
                padding: 1rem;
            }
            
            .header h1 {
                font-size: 1.5rem;
            }
            
            .tabs {
                flex-wrap: nowrap;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }
            
            .tab {
                min-width: 80px;
                padding: 0.5rem 1rem;
                font-size: 0.9rem;
            }
            
            .card {
                padding: 1rem;
            }
            
            .law-card {
                padding: 1rem;
            }
            
            .modal {
                padding: 1rem;
            }
            
            .modal-dialog {
                margin: 0.5rem;
                max-width: calc(100vw - 1rem);
            }
            
            .modal-content {
                max-height: calc(100vh - 2rem);
            }
            
            /* ÌÑ∞Ïπò ÏπúÌôîÏ†Å Î≤ÑÌäº ÌÅ¨Í∏∞ */
            button {
                min-height: 44px;
                min-width: 44px;
            }
            
            /* ÏûëÏùÄ ÌôîÎ©¥ÏóêÏÑú Í∑∏Î¶¨Îìú Îã®ÏàúÌôî */
            .law-grid {
                grid-template-columns: 1fr;
                gap: 0.75rem;
            }
            
            /* ÌÖçÏä§Ìä∏ ÌÅ¨Í∏∞ Ï°∞Ï†ï */
            body {
                font-size: 14px;
            }
            
            /* Ïä§ÌÅ¨Î°§ Í∞úÏÑ† */
            .content-container {
                -webkit-overflow-scrolling: touch;
                overflow-y: auto;
            }
        }

        .loading {
            text-align: center;
            padding: 3rem 2rem;
            color: var(--text-secondary);
        }

        .loading::before {
            content: '‚ö°';
            font-size: 2rem;
            display: block;
            margin-bottom: 1rem;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.7; }
        }

        .error {
            color: var(--danger);
            text-align: center;
            padding: 2rem;
            background: rgba(245, 101, 101, 0.1);
            border-radius: 12px;
            border: 1px solid rgba(245, 101, 101, 0.2);
        }



        /* Main Tab Navigation */
        .main-tab-navigation {
            background: var(--bg-glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 0.5rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow);
        }

        .main-tab-container {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 0.5rem;
        }

        .main-tab {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.8rem;
            padding: 1.2rem 1.5rem;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            font-size: 1rem;
            color: var(--text-secondary);
            background: transparent;
            border: 1px solid transparent;
        }

        .main-tab:hover {
            background: var(--glass-bg);
            color: var(--text-primary);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.15);
        }

        .main-tab.active {
            background: var(--primary-gradient);
            color: var(--text-white);
            border-color: var(--primary);
            box-shadow: 0 4px 16px rgba(102, 126, 234, 0.3);
        }

        .main-tab .tab-icon {
            font-size: 1.2rem;
        }

        .main-tab .tab-text {
            font-size: 0.95rem;
            white-space: nowrap;
        }

        /* Tab Content */
        .tab-content {
            position: relative;
        }

        .tab-pane {
            display: none;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.4s ease;
        }

        .tab-pane.active {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }

        /* Quarterly Detail Section - Sliding Animation */
        .quarterly-detail-section {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            margin-top: 1.5rem;
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            max-height: 0;
            opacity: 0;
        }

        .quarterly-detail-section.expanded {
            max-height: 2000px;
            opacity: 1;
            display: block !important;
        }

        .quarterly-detail-content {
            padding: 2rem;
        }

        /* Law Registry Tab Styles */
        .job-function-list {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .job-function-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            user-select: none;
        }

        .job-function-item:hover {
            background: var(--bg-secondary);
            border-color: var(--primary);
            transform: translateX(4px);
        }

        .job-function-item.active {
            background: var(--primary-gradient);
            color: white;
            border-color: transparent;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        .job-function-item .job-icon {
            font-size: 1.1rem;
            width: 1.5rem;
            text-align: center;
        }

        .job-function-item .job-name {
            flex: 1;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .job-function-item .job-count {
            background: var(--bg-glass);
            color: var(--text-secondary);
            padding: 0.2rem 0.6rem;
            border-radius: 10px;
            font-size: 0.8rem;
            font-weight: 700;
            min-width: 2rem;
            text-align: center;
        }

        .job-function-item.active .job-count {
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }

        .registry-law-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem 1.5rem;
            border-bottom: 1px solid var(--border);
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .registry-law-item:hover {
            background: var(--bg-secondary);
            transform: translateX(4px);
        }

        .registry-law-item:last-child {
            border-bottom: none;
        }

        .registry-law-number {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-muted);
            min-width: 2rem;
        }

        .registry-law-title {
            flex: 1;
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .registry-law-link {
            display: flex;
            align-items: center;
            gap: 0.3rem;
            font-size: 0.8rem;
            color: var(--primary);
            font-weight: 500;
        }

        .registry-law-link:hover {
            color: var(--primary-light);
        }

        /* Enhanced Quarterly Tab Selection */
        .quarterly-tab {
            transition: all 0.3s ease;
            position: relative;
        }

        .quarterly-tab.selected {
            background: var(--primary-gradient);
            color: var(--text-white);
            transform: scale(1.02);
            box-shadow: 0 8px 24px rgba(102, 126, 234, 0.3);
        }

        .quarterly-tab.selected .quarter-title,
        .quarterly-tab.selected .quarter-period,
        .quarterly-tab.selected .quarter-count {
            color: var(--text-white);
        }

        /* Detail Header */
        .quarterly-detail-header {
            background: var(--bg-glass);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border: 1px solid var(--glass-border);
        }

        .detail-title {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            margin-bottom: 0.8rem;
        }

        .detail-title h3 {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--text-primary);
            margin: 0;
            flex: 1;
        }

        .detail-icon {
            font-size: 1.6rem;
        }

        .close-detail-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--text-muted);
            cursor: pointer;
            padding: 0.2rem;
            border-radius: 6px;
            transition: all 0.2s ease;
        }

        .close-detail-btn:hover {
            background: var(--bg-secondary);
            color: var(--text-primary);
        }

        .detail-period {
            color: var(--text-secondary);
            font-size: 1rem;
            margin-bottom: 1rem;
        }

        .detail-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 1rem;
        }

        .stat-item {
            text-align: center;
            padding: 0.8rem;
            background: var(--bg-primary);
            border-radius: 8px;
            border: 1px solid var(--border);
        }

        .stat-number {
            display: block;
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 0.2rem;
        }

        .stat-label {
            font-size: 0.8rem;
            color: var(--text-muted);
            font-weight: 500;
        }

        /* Settings Modal Specific Styles */
        .settings-modal-content {
            max-width: 600px;
            width: 90vw;
        }

        .settings-form {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .form-label {
            font-weight: 600;
            color: var(--text-primary);
            font-size: 0.95rem;
        }

        .form-input {
            padding: 0.75rem 1rem;
            border: 2px solid var(--border);
            border-radius: 12px;
            font-size: 1rem;
            background: var(--bg-card);
            color: var(--text-primary);
            transition: all 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-textarea {
            min-height: 120px;
            resize: vertical;
            font-family: inherit;
        }

        .form-checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .form-checkbox {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .form-checkbox input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--primary);
        }

        .form-checkbox label {
            font-size: 0.95rem;
            color: var(--text-secondary);
        }

        .form-buttons {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
            margin-top: 1rem;
        }

        .btn-primary {
            background: var(--primary-gradient);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: var(--bg-secondary);
            color: var(--text-secondary);
            border: 2px solid var(--border);
            padding: 0.75rem 1.5rem;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-secondary:hover {
            background: var(--bg-card);
            border-color: var(--primary);
        }

        .notification-status {
            padding: 1rem;
            border-radius: 12px;
            margin-top: 1rem;
            font-size: 0.9rem;
        }

        .notification-status.success {
            background: rgba(72, 187, 120, 0.1);
            color: var(--c-safety);
            border: 1px solid rgba(72, 187, 120, 0.2);
        }

        .notification-status.error {
            background: rgba(245, 101, 101, 0.1);
            color: var(--c-sec);
            border: 1px solid rgba(245, 101, 101, 0.2);
        }

        .email-preview {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 1rem;
            margin-top: 1rem;
        }

        .email-preview h4 {
            margin: 0 0 0.5rem 0;
            color: var(--text-primary);
            font-size: 0.9rem;
        }

        .email-preview-content {
            font-size: 0.85rem;
            color: var(--text-secondary);
            line-height: 1.4;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Glassmorphism Header -->
        <div class="header">
            <button class="settings-btn" onclick="openDownloadModal()" title="Îç∞Ïù¥ÌÑ∞ Îã§Ïö¥Î°úÎìú" style="right: 8.5rem; background: linear-gradient(135deg, rgba(59, 130, 246, 0.5), rgba(147, 197, 253, 0.3), rgba(59, 130, 246, 0.2)); box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                    <polyline points="7 10 12 15 17 10"></polyline>
                    <line x1="12" y1="15" x2="12" y2="3"></line>
                </svg>
            </button>
            <button class="settings-btn" onclick="openEmailScheduler()" title="Ïù¥Î©îÏùº Î∞úÏÜ° ÏÑ§Ï†ï" style="right: 4.5rem; background: linear-gradient(135deg, rgba(251, 146, 60, 0.5), rgba(254, 215, 170, 0.3), rgba(251, 146, 60, 0.2)); box-shadow: 0 4px 15px rgba(251, 146, 60, 0.3);">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="2" y="4" width="20" height="16" rx="2"></rect>
                    <path d="m22 7-10 5L2 7"></path>
                </svg>
            </button>
            <button class="settings-btn" onclick="window.open('./law_updater.html', '_blank')" title="Î≤ïÍ∑ú Îç∞Ïù¥ÌÑ∞ ÏóÖÎç∞Ïù¥Ìä∏" style="right: 0.5rem; background: linear-gradient(135deg, rgba(34, 197, 94, 0.5), rgba(134, 239, 172, 0.3), rgba(34, 197, 94, 0.2)); box-shadow: 0 4px 15px rgba(34, 197, 94, 0.3);">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path>
                    <path d="M21 3v5h-5"></path>
                    <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path>
                    <path d="M8 16H3v5"></path>
                </svg>
            </button>
            <div class="header-content">
                <h1>RegRader</h1>
                <div class="subtitle">AIÎ•º ÌôúÏö©Ìïú Î≤ïÍ∑ú Í∞úÏ†ï Î™®ÎãàÌÑ∞ÎßÅ ÏãúÏä§ÌÖú</div>
            </div>
            <div class="meta">
                <span id="year">2025</span>ÎÖÑ Î≤ïÎ†π Í∞úÏ†ï ÌòÑÌô© ¬∑ 
                ÏµúÏ¢Ö ÏóÖÎç∞Ïù¥Ìä∏: <span id="timestamp">Î°úÎî© Ï§ë...</span>
            </div>
        </div>

        <!-- Main Tab Navigation -->
        <div class="main-tab-navigation">
            <div class="main-tab-container">
                <div class="main-tab active" data-tab="quarterly" onclick="switchMainTab('quarterly')">
                    <span class="tab-icon">üìÖ</span>
                    <span class="tab-text">Î∂ÑÍ∏∞Î≥Ñ Í∞úÏ†ï ÌòÑÌô©</span>
                </div>
                <div class="main-tab" data-tab="business" onclick="switchMainTab('business')">
                    <span class="tab-icon">üè¢</span>
                    <span class="tab-text">ÏßÅÎ¨¥Î≥Ñ Í∞úÏ†ï ÌòÑÌô©</span>
                </div>
                <div class="main-tab" data-tab="lawregistry" onclick="switchMainTab('lawregistry')">
                    <span class="tab-icon">üìö</span>
                    <span class="tab-text">Ï†ÅÏö©Î≤ïÍ∑ú</span>
                </div>
            </div>
        </div>

        <!-- Tab Content Wrapper -->
        <div class="tab-content">
            <!-- Quarterly Tab Content -->
            <div class="tab-pane active" id="quarterly-content">
                <!-- Quarterly View -->
        <div class="quarterly-view">


            <!-- 2025ÎÖÑ Ï†ÑÏ≤¥ Í∞úÏ†ï Î≤ïÍ∑ú ÌòÑÌô© -->
            <div style="background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%); backdrop-filter: blur(20px); border: 1px solid var(--glass-border); border-radius: 16px; padding: 1.5rem; margin-bottom: 1.5rem; box-shadow: var(--glass-shadow);">
                <div style="display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 1rem;">
                    <div style="display: flex; align-items: center; gap: 0.8rem;">
                        <span style="font-size: 1.5rem;">üìä</span>
                        <div>
                            <div style="font-size: 1.4rem; font-weight: 700; color: var(--text-primary);">2025ÎÖÑ Í∞úÏ†ï Î≤ïÍ∑ú ÌòÑÌô©</div>
                            <div style="font-size: 0.85rem; color: var(--text-muted); margin-top: 0.2rem;">Íµ≠Í∞ÄÎ≤ïÎ†πÏ†ïÎ≥¥ÏÑºÌÑ∞ ÏàòÏßë Îç∞Ïù¥ÌÑ∞</div>
                        </div>
                    </div>
                    <div style="display: flex; align-items: center; gap: 2rem; flex-wrap: wrap;">
                        <div style="text-align: center;">
                            <div style="font-size: 2rem; font-weight: 800; background: var(--primary-gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">2,971</div>
                            <div style="font-size: 0.85rem; color: var(--text-muted); font-weight: 500;">Ï†ÑÏ≤¥ Í∞úÏ†ï Î≤ïÎ†π</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Îß§Ïπ≠ Î∂ÑÏÑù ÏÉÅÏÑ∏ ÌòÑÌô© -->
            <div style="background: var(--bg-glass); backdrop-filter: blur(20px); border: 1px solid var(--glass-border); border-radius: 16px; padding: 1.2rem 1.5rem; margin-bottom: 1.5rem; box-shadow: var(--glass-shadow);">
                <div style="display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 1rem;">
                    <div style="display: flex; align-items: center; gap: 0.8rem;">
                        <span style="font-size: 1.3rem;">üéØ</span>
                        <div>
                            <div style="font-size: 1.3rem; font-weight: 700; color: var(--text-primary);">2025ÎÖÑ ÎãπÏÇ¨ Ï†ÅÏö© Î≤ïÍ∑ú Í∞úÏ†ï ÌòÑÌô©</div>
                            <div style="font-size: 0.85rem; color: var(--text-muted); margin-top: 0.2rem;">207Í∞ú Í∏∞Î≥∏ Î≤ïÍ∑ú Ï§ë Îß§Ïπ≠ Í≤∞Í≥º</div>
                        </div>
                    </div>
                    <div style="display: flex; align-items: center; gap: 1.5rem; flex-wrap: wrap;">
                        <div style="text-align: center;">
                            <div style="font-size: 1.6rem; font-weight: 800; color: var(--primary);" id="total-law-count">276</div>
                            <div style="font-size: 0.8rem; color: var(--text-muted); font-weight: 500;">Ï¥ù Îß§Ïπ≠ Î≤ïÍ∑ú</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 1.6rem; font-weight: 800; color: #48bb78;" id="implemented-law-count">255</div>
                            <div style="font-size: 0.8rem; color: var(--text-muted); font-weight: 500;">ÏãúÌñâÏôÑÎ£å</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 1.6rem; font-weight: 800; color: #f093fb;" id="amendment-law-count">21</div>
                            <div style="font-size: 0.8rem; color: var(--text-muted); font-weight: 500;">ÏãúÌñâÏòàÏ†ï</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Î∂ÑÍ∏∞Î≥Ñ ÌòÑÌô© Î∞ïÏä§ -->
            <div style="background: var(--bg-glass); backdrop-filter: blur(20px); border: 1px solid var(--glass-border); border-radius: 16px; padding: 1.2rem 1.5rem; margin-bottom: 1.5rem; box-shadow: var(--glass-shadow);">
                <div class="filter-title">
                    üìÖ 2025ÎÖÑ Î∂ÑÍ∏∞Î≥Ñ Í∞úÏ†ï ÌòÑÌô©
                </div>
                <div class="quarterly-tabs">
                <div class="quarterly-tab" onclick="showQuarterlyDetail('Q1')">
                    <div class="quarter-icon">üå±</div>
                    <div class="quarter-info">
                        <div class="quarter-title">
                            <span>1Î∂ÑÍ∏∞</span>
                            <span class="quarter-period">(1~3Ïõî)</span>
                        </div>
                        <div class="quarter-count" id="q1-count">134</div>
                    </div>
                    <button class="quarter-download-btn" onclick="downloadQuarterlyExcel('Q1', event)" title="ÌÅ¥Î¶≠ÌïòÎ©¥ 1Î∂ÑÍ∏∞ Î≤ïÎ†π ÏóëÏÖÄÌååÏùºÏù¥ Îã§Ïö¥Î°úÎìúÎê©ÎãàÎã§ üìÑ">
                        <span class="download-icon">üìÑ</span>
                        <span class="download-text">Download</span>
                    </button>
                </div>
                <div class="quarterly-tab" onclick="showQuarterlyDetail('Q2')">
                    <div class="quarter-icon">‚òÄÔ∏è</div>
                    <div class="quarter-info">
                        <div class="quarter-title">
                            <span>2Î∂ÑÍ∏∞</span>
                            <span class="quarter-period">(4~6Ïõî)</span>
                        </div>
                        <div class="quarter-count" id="q2-count">61</div>
                    </div>
                    <button class="quarter-download-btn" onclick="downloadQuarterlyExcel('Q2', event)" title="ÌÅ¥Î¶≠ÌïòÎ©¥ 2Î∂ÑÍ∏∞ Î≤ïÎ†π ÏóëÏÖÄÌååÏùºÏù¥ Îã§Ïö¥Î°úÎìúÎê©ÎãàÎã§ üìÑ">
                        <span class="download-icon">üìÑ</span>
                        <span class="download-text">Download</span>
                    </button>
                </div>
                <div class="quarterly-tab" onclick="showQuarterlyDetail('Q3')">
                    <div class="quarter-icon">üçÇ</div>
                    <div class="quarter-info">
                        <div class="quarter-title">
                            <span>3Î∂ÑÍ∏∞</span>
                            <span class="quarter-period">(7~9Ïõî)</span>
                        </div>
                        <div class="quarter-count" id="q3-count">67</div>
                    </div>
                    <button class="quarter-download-btn" onclick="downloadQuarterlyExcel('Q3', event)" title="ÌÅ¥Î¶≠ÌïòÎ©¥ 3Î∂ÑÍ∏∞ Î≤ïÎ†π ÏóëÏÖÄÌååÏùºÏù¥ Îã§Ïö¥Î°úÎìúÎê©ÎãàÎã§ üìÑ">
                        <span class="download-icon">üìÑ</span>
                        <span class="download-text">Download</span>
                    </button>
                </div>
                <div class="quarterly-tab" onclick="showQuarterlyDetail('Q4')">
                    <div class="quarter-icon">‚ùÑÔ∏è</div>
                    <div class="quarter-info">
                        <div class="quarter-title">
                            <span>4Î∂ÑÍ∏∞</span>
                            <span class="quarter-period">(10~12Ïõî)</span>
                        </div>
                        <div class="quarter-count" id="q4-count">14</div>
                    </div>
                    <button class="quarter-download-btn" onclick="downloadQuarterlyExcel('Q4', event)" title="ÌÅ¥Î¶≠ÌïòÎ©¥ 4Î∂ÑÍ∏∞ Î≤ïÎ†π ÏóëÏÖÄÌååÏùºÏù¥ Îã§Ïö¥Î°úÎìúÎê©ÎãàÎã§ üìÑ">
                        <span class="download-icon">üìÑ</span>
                        <span class="download-text">Download</span>
                    </button>
                </div>
            </div>
            </div>

                </div>
                
                <!-- Quarterly Detail Section (Sliding) -->
                <div class="quarterly-detail-section" id="quarterly-detail" style="display: none;">
                    <div class="quarterly-detail-content">
                        <!-- Dynamic quarterly content will be inserted here -->
                    </div>
                </div>
            </div>

            <!-- Business Tab Content -->
            <div class="tab-pane" id="business-content">
                <!-- Business Filter -->
        <div class="business-filter">
            <div class="filter-title">
                üè¢ ÏßÅÎ¨¥Î≥Ñ ÌòÑÌô©
            </div>
            <div class="filter-tabs">
                <div class="filter-tab active" data-filter="all">Ï†ÑÏ≤¥ (<span id="count-all">0</span>)</div>
                <div class="filter-tab" data-filter="Ïù∏ÏÇ¨ÎÖ∏Î¨¥">üë• Ïù∏ÏÇ¨ÎÖ∏Î¨¥ (<span id="count-Ïù∏ÏÇ¨ÎÖ∏Î¨¥">0</span>)</div>
                <div class="filter-tab" data-filter="Í≥µÏ†ïÍ±∞Îûò">‚öñÔ∏è Í≥µÏ†ïÍ±∞Îûò (<span id="count-Í≥µÏ†ïÍ±∞Îûò">0</span>)</div>
                <div class="filter-tab" data-filter="Ï†ïÎ≥¥Î≥¥Ìò∏">üîí Ï†ïÎ≥¥Î≥¥Ìò∏ (<span id="count-Ï†ïÎ≥¥Î≥¥Ìò∏">0</span>)</div>
                <div class="filter-tab" data-filter="ÏßÄÏãùÏû¨ÏÇ∞Í∂å">üí° ÏßÄÏãùÏû¨ÏÇ∞ (<span id="count-ÏßÄÏãùÏû¨ÏÇ∞Í∂å">0</span>)</div>
                <div class="filter-tab" data-filter="Ïû¨Î¨¥ÌöåÍ≥Ñ">üí∞ Ïû¨Î¨¥ÌöåÍ≥Ñ (<span id="count-Ïû¨Î¨¥ÌöåÍ≥Ñ">0</span>)</div>
                <div class="filter-tab" data-filter="ÏïàÏ†Ñ">üõ°Ô∏è ÏïàÏ†Ñ/Î≥¥Í±¥ (<span id="count-ÏïàÏ†Ñ">0</span>)</div>
                <div class="filter-tab" data-filter="ÌôòÍ≤Ω">üå± ÌôòÍ≤Ω/ÏóêÎÑàÏßÄ (<span id="count-ÌôòÍ≤Ω">0</span>)</div>
                <div class="filter-tab" data-filter="ÏßÄÎ∞∞Íµ¨Ï°∞">üèõÔ∏è ÏßÄÎ∞∞Íµ¨Ï°∞ (<span id="count-ÏßÄÎ∞∞Íµ¨Ï°∞">0</span>)</div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Sidebar with Charts -->
            <div class="sidebar">
                <!-- Category Distribution Chart -->
                <div class="chart-card">
                    <div class="chart-header">
                        <div class="chart-title">üìà ÏßÅÎ¨¥Î≥Ñ Î∂ÑÌè¨</div>
                    </div>
                    <div class="chart-container">
                        <canvas id="categoryChart"></canvas>
                    </div>
                    <div class="category-legend" id="categoryLegend">
                        <!-- Î≤îÎ°ÄÍ∞Ä Ïó¨Í∏∞Ïóê ÎèôÏ†ÅÏúºÎ°ú ÏÉùÏÑ±Îê©ÎãàÎã§ -->
                    </div>
                </div>

            </div>

            <!-- Law List -->
            <div class="law-card">
                <div class="law-list-header">
                    <div class="law-list-title">
                        üìã ÏãúÌñâ Î≤ïÎ†π Î™©Î°ù
                        <div class="law-count" id="law-count">Î°úÎî© Ï§ë...</div>
                    </div>
                </div>
                
                <div class="search-container">
                    <div class="search-box">
                        <span>üîç</span>
                        <input type="text" class="search-input" id="searchInput" placeholder="Î≤ïÎ†πÎ™Ö, Î∂ÄÏ≤òÎ™ÖÏúºÎ°ú Í≤ÄÏÉâ...">
                        <button onclick="searchLaws()" style="background: none; border: none; color: var(--primary); cursor: pointer;">Í≤ÄÏÉâ</button>
                    </div>
                </div>

                <div class="law-list" id="law-list">
                    <div class="loading">Îç∞Ïù¥ÌÑ∞Î•º Î°úÎî© Ï§ëÏûÖÎãàÎã§...</div>
                </div>
            </div>
                </div>
            </div>

            <!-- Law Registry Tab Content -->
            <div class="tab-pane" id="lawregistry-content">
                <div class="law-registry-view">
                    <!-- Header -->
                    <div style="background: var(--bg-glass); backdrop-filter: blur(20px); border: 1px solid var(--glass-border); border-radius: 16px; padding: 1.2rem 1.5rem; margin-bottom: 1.5rem; box-shadow: var(--glass-shadow);">
                        <div style="display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 1rem;">
                            <div style="display: flex; align-items: center; gap: 0.8rem;">
                                <span style="font-size: 1.3rem;">üìö</span>
                                <div>
                                    <div style="font-size: 1.1rem; font-weight: 700; color: var(--text-primary);">Ï†ÅÏö©Î≤ïÍ∑ú(Î≤ïÍ∑úÎì±Î°ùÎ∂Ä)</div>
                                    <div style="font-size: 0.9rem; color: var(--text-muted);">ÏßÅÎ¨¥Î≥Ñ Ï†ÅÏö©ÎêòÎäî Î≤ïÍ∑ú Î¶¨Ïä§Ìä∏</div>
                                </div>
                            </div>
                            <div style="display: flex; align-items: center; gap: 1.5rem; flex-wrap: wrap;">
                                <div style="text-align: center;">
                                    <div style="font-size: 1.6rem; font-weight: 800; color: var(--primary);" id="registry-total-count">0</div>
                                    <div style="font-size: 0.8rem; color: var(--text-muted); font-weight: 500;">Ï¥ù Î≤ïÍ∑ú Ïàò</div>
                                </div>


                            </div>
                        </div>
                    </div>

                    <!-- Main Content with Sidebar and Panel -->
                    <div style="display: grid; grid-template-columns: 320px 1fr; gap: 1.5rem; min-height: 600px;">
                        <!-- Left Sidebar: Job Functions -->
                        <div style="background: var(--bg-glass); backdrop-filter: blur(20px); border: 1px solid var(--glass-border); border-radius: 16px; padding: 1.2rem; box-shadow: var(--glass-shadow);">
                            <div style="font-size: 1.1rem; font-weight: 700; color: var(--text-primary); margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                                <span>üëî</span> ÏßÅÎ¨¥ Î∂ÑÏïº
                            </div>
                            
                            <div class="job-function-list" id="job-function-list">
                                <div class="job-function-item active" data-job="all" onclick="showJobFunctionLaws('all', 'Ï†ÑÏ≤¥')">
                                    <span class="job-icon">üìã</span>
                                    <span class="job-name">Ï†ÑÏ≤¥</span>
                                    <span class="job-count" id="job-count-all">100</span>
                                </div>
                                <div class="job-function-item" data-job="Ïù∏ÏÇ¨ÎÖ∏Î¨¥" onclick="showJobFunctionLaws('Ïù∏ÏÇ¨ÎÖ∏Î¨¥', 'üë• Ïù∏ÏÇ¨ÎÖ∏Î¨¥')">
                                    <span class="job-icon">üë•</span>
                                    <span class="job-name">Ïù∏ÏÇ¨ÎÖ∏Î¨¥</span>
                                    <span class="job-count" id="job-count-Ïù∏ÏÇ¨ÎÖ∏Î¨¥">0</span>
                                </div>
                                <div class="job-function-item" data-job="Ï†ïÎ≥¥Î≥¥Ìò∏" onclick="showJobFunctionLaws('Ï†ïÎ≥¥Î≥¥Ìò∏', 'üîí Ï†ïÎ≥¥Î≥¥Ìò∏')">
                                    <span class="job-icon">üîí</span>
                                    <span class="job-name">Ï†ïÎ≥¥Î≥¥Ìò∏</span>
                                    <span class="job-count" id="job-count-Ï†ïÎ≥¥Î≥¥Ìò∏">0</span>
                                </div>
                                <div class="job-function-item" data-job="ÏïàÏ†Ñ" onclick="showJobFunctionLaws('ÏïàÏ†Ñ', 'üõ°Ô∏è ÏïàÏ†ÑÎ≥¥Í±¥')">
                                    <span class="job-icon">üõ°Ô∏è</span>
                                    <span class="job-name">ÏïàÏ†ÑÎ≥¥Í±¥</span>
                                    <span class="job-count" id="job-count-ÏïàÏ†Ñ">0</span>
                                </div>
                                <div class="job-function-item" data-job="ÌôòÍ≤Ω" onclick="showJobFunctionLaws('ÌôòÍ≤Ω', 'üå± ÌôòÍ≤ΩÏóêÎÑàÏßÄ')">
                                    <span class="job-icon">üå±</span>
                                    <span class="job-name">ÌôòÍ≤ΩÏóêÎÑàÏßÄ</span>
                                    <span class="job-count" id="job-count-ÌôòÍ≤Ω">0</span>
                                </div>
                                <div class="job-function-item" data-job="Ïû¨Î¨¥ÌöåÍ≥Ñ" onclick="showJobFunctionLaws('Ïû¨Î¨¥ÌöåÍ≥Ñ', 'üí∞ Ïû¨Î¨¥ÌöåÍ≥Ñ')">
                                    <span class="job-icon">üí∞</span>
                                    <span class="job-name">Ïû¨Î¨¥ÌöåÍ≥Ñ</span>
                                    <span class="job-count" id="job-count-Ïû¨Î¨¥ÌöåÍ≥Ñ">0</span>
                                </div>
                                <div class="job-function-item" data-job="Í≥µÏ†ïÍ±∞Îûò" onclick="showJobFunctionLaws('Í≥µÏ†ïÍ±∞Îûò', '‚öñÔ∏è Í≥µÏ†ïÍ±∞Îûò')">
                                    <span class="job-icon">‚öñÔ∏è</span>
                                    <span class="job-name">Í≥µÏ†ïÍ±∞Îûò</span>
                                    <span class="job-count" id="job-count-Í≥µÏ†ïÍ±∞Îûò">0</span>
                                </div>
                                <div class="job-function-item" data-job="ÏßÄÎ∞∞Íµ¨Ï°∞" onclick="showJobFunctionLaws('ÏßÄÎ∞∞Íµ¨Ï°∞', 'üèõÔ∏è ÏßÄÎ∞∞Íµ¨Ï°∞')">
                                    <span class="job-icon">üèõÔ∏è</span>
                                    <span class="job-name">ÏßÄÎ∞∞Íµ¨Ï°∞</span>
                                    <span class="job-count" id="job-count-ÏßÄÎ∞∞Íµ¨Ï°∞">0</span>
                                </div>
                                <div class="job-function-item" data-job="ÏßÄÏãùÏû¨ÏÇ∞Í∂å" onclick="showJobFunctionLaws('ÏßÄÏãùÏû¨ÏÇ∞Í∂å', 'üí° ÏßÄÏãùÏû¨ÏÇ∞')">
                                    <span class="job-icon">üí°</span>
                                    <span class="job-name">ÏßÄÏãùÏû¨ÏÇ∞</span>
                                    <span class="job-count" id="job-count-ÏßÄÏãùÏû¨ÏÇ∞Í∂å">0</span>
                                </div>
                            </div>
                        </div>

                        <!-- Right Panel: Laws for Selected Job Function -->
                        <div style="background: var(--bg-glass); backdrop-filter: blur(20px); border: 1px solid var(--glass-border); border-radius: 16px; overflow: hidden; box-shadow: var(--glass-shadow);">
                            <div style="padding: 1.2rem; background: var(--primary-gradient); color: white; display: flex; align-items: center; gap: 0.5rem;">
                                <span id="job-function-icon">üìã</span>
                                <h3 style="margin: 0; font-size: 1.1rem;" id="job-function-title">Ï†ÑÏ≤¥ Ï†ÅÏö© Î≤ïÍ∑ú</h3>
                                <div style="margin-left: auto; background: rgba(255, 255, 255, 0.2); padding: 0.25rem 0.75rem; border-radius: 15px; font-size: 0.8rem;" id="job-function-count">100Í±¥</div>
                            </div>
                            
                            <div style="max-height: 500px; overflow-y: auto; padding: 0;" id="job-function-laws">
                                <div style="padding: 2rem; text-align: center; color: var(--text-muted);">
                                    ÏôºÏ™ΩÏóêÏÑú ÏßÅÎ¨¥Î•º ÏÑ†ÌÉùÌïòÎ©¥ Ìï¥Îãπ Î≤ïÍ∑ú Î™©Î°ùÏù¥ ÌëúÏãúÎê©ÎãàÎã§.
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Enhanced Modal -->
    <div id="law-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title" id="modal-title">Î≤ïÎ†π Ï†úÎ™©</div>
                <div class="modal-subtitle" id="modal-subtitle">Î≤ïÎ†π Ï†ïÎ≥¥</div>
                <button class="modal-close" onclick="closeLawModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div id="modal-summary">
                    <!-- AI Ïä§ÌÉÄÏùº ÏöîÏïΩÏù¥ Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§ -->
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <!-- Download Modal -->
    <div class="modal" id="download-modal" onclick="if(event.target === this) closeDownloadModal()">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h2 style="margin: 0; color: var(--text-primary); font-size: 1.5rem; display: flex; align-items: center; gap: 0.5rem;">
                    <span>üì•</span>
                    <span>Îç∞Ïù¥ÌÑ∞ Îã§Ïö¥Î°úÎìú</span>
                </h2>
            </div>
            <div class="modal-body" style="padding: 1.5rem;">
                <div style="display: grid; gap: 1rem;">
                    <!-- 2025ÎÖÑ Ï†ÑÏ≤¥ Î≤ïÎ†π -->
                    <div class="download-item" style="background: linear-gradient(135deg, rgba(102, 126, 234, 0.05) 0%, rgba(118, 75, 162, 0.05) 100%); padding: 1.2rem; border-radius: 12px; cursor: pointer; transition: all 0.3s; border: 2px solid rgba(102, 126, 234, 0.2);" onclick="downloadAllLaws()" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(102, 126, 234, 0.2)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <h3 style="margin: 0 0 0.5rem 0; color: var(--text-primary); font-size: 1.1rem; display: flex; align-items: center; gap: 0.5rem;">
                                    <span style="font-size: 1.5rem;">üìä</span>
                                    2025ÎÖÑ Ï†ÑÏ≤¥ Î≤ïÎ†π (2,971Í∞ú)
                                </h3>
                                <p style="margin: 0; color: var(--text-muted); font-size: 0.9rem;">
                                    2025ÎÖÑ Íµ≠Í∞ÄÎ≤ïÎ†πÏ†ïÎ≥¥ÏÑºÌÑ∞ÏóêÏÑú ÏàòÏßëÌïú Î™®Îì† Í∞úÏ†ï Î≤ïÎ†π
                                </p>
                                <p style="margin: 0.3rem 0 0 0; color: var(--text-secondary); font-size: 0.85rem;">
                                    <strong>ÌååÏùºÎ™Ö:</strong> 2025_laws_complete.xlsx
                                </p>
                            </div>
                            <span style="font-size: 2rem; color: var(--primary);">‚¨á</span>
                        </div>
                    </div>
                    
                    <!-- Îß§Ïπ≠ Í≤∞Í≥º -->
                    <div class="download-item" style="background: linear-gradient(135deg, rgba(72, 187, 120, 0.05) 0%, rgba(56, 178, 172, 0.05) 100%); padding: 1.2rem; border-radius: 12px; cursor: pointer; transition: all 0.3s; border: 2px solid rgba(72, 187, 120, 0.2);" onclick="downloadMatchedLaws()" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(72, 187, 120, 0.2)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <h3 style="margin: 0 0 0.5rem 0; color: var(--text-primary); font-size: 1.1rem; display: flex; align-items: center; gap: 0.5rem;">
                                    <span style="font-size: 1.5rem;">üéØ</span>
                                    Îß§Ïπ≠ Í≤∞Í≥º (276Í±¥)
                                </h3>
                                <p style="margin: 0; color: var(--text-muted); font-size: 0.9rem;">
                                    ÎãπÏÇ¨ 207Í∞ú Ï§ë 121Í∞ú Î≤ïÍ∑úÏôÄ 100% Ï†ïÌôï Îß§Ïπ≠Îêú 2025ÎÖÑ Î≤ïÎ†π
                                </p>
                                <p style="margin: 0.3rem 0 0 0; color: var(--text-secondary); font-size: 0.85rem;">
                                    <strong>ÌååÏùºÎ™Ö:</strong> matched_laws_2025.xlsx
                                </p>
                            </div>
                            <span style="font-size: 2rem; color: var(--success);">‚¨á</span>
                        </div>
                    </div>
                    
                    <!-- Í∏∞Î≥∏ Ï†ÅÏö©Î≤ïÍ∑ú -->
                    <div class="download-item" style="background: linear-gradient(135deg, rgba(237, 137, 54, 0.05) 0%, rgba(246, 173, 85, 0.05) 100%); padding: 1.2rem; border-radius: 12px; cursor: pointer; transition: all 0.3s; border: 2px solid rgba(237, 137, 54, 0.2);" onclick="downloadBaseLaws()" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(237, 137, 54, 0.2)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <h3 style="margin: 0 0 0.5rem 0; color: var(--text-primary); font-size: 1.1rem; display: flex; align-items: center; gap: 0.5rem;">
                                    <span style="font-size: 1.5rem;">üìö</span>
                                    ÎãπÏÇ¨ Ï†ÅÏö©Î≤ïÍ∑ú (207Í∞ú)
                                </h3>
                                <p style="margin: 0; color: var(--text-muted); font-size: 0.9rem;">
                                    ÎãπÏÇ¨ Í∏∞Î≥∏ Ï†ÅÏö©Î≤ïÍ∑ú Î™©Î°ù (Í∏∞Ï§Ä Î≤ïÍ∑ú)
                                </p>
                                <p style="margin: 0.3rem 0 0 0; color: var(--text-secondary); font-size: 0.85rem;">
                                    <strong>ÌååÏùºÎ™Ö:</strong> base_laws_207.xlsx
                                </p>
                            </div>
                            <span style="font-size: 2rem; color: var(--warning);">‚¨á</span>
                        </div>
                    </div>
                </div>
                
                <div style="margin-top: 1.5rem; padding-top: 1rem; border-top: 1px solid var(--border);">
                    <p style="color: var(--text-muted); font-size: 0.85rem; text-align: center; margin: 0;">
                        ‚ö†Ô∏è Îã§Ïö¥Î°úÎìúÎêú ÌååÏùºÏùÄ ÏóÖÎ¨¥ Î™©Ï†ÅÏúºÎ°úÎßå ÏÇ¨Ïö©Ìï¥Ï£ºÏÑ∏Ïöî
                    </p>
                </div>
            </div>
        </div>
    </div>

    <div id="settings-modal" class="modal">
        <div class="modal-content settings-modal-content">
            <div class="modal-header">
                <div class="modal-title">Ïù¥Î©îÏùº ÏïåÎ¶º ÏÑ§Ï†ï</div>
                <div class="modal-subtitle">Î∂ÑÍ∏∞Î≥Ñ Î≤ïÎ†π Í∞úÏ†ï ÏïåÎ¶ºÏùÑ Î∞õÏúºÏÑ∏Ïöî</div>
                <button class="modal-close" onclick="closeSettingsModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form class="settings-form" id="email-settings-form">
                    <div class="form-group">
                        <label class="form-label" for="email-recipients">ÏàòÏã†Ïûê Ïù¥Î©îÏùº Ï£ºÏÜå</label>
                        <textarea 
                            class="form-input form-textarea" 
                            id="email-recipients" 
                            placeholder="example1@company.com&#10;example2@company.com&#10;example3@company.com&#10;&#10;Ïó¨Îü¨ Ïù¥Î©îÏùº Ï£ºÏÜåÎ•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî (Ìïú Ï§ÑÏóê ÌïòÎÇòÏî©)"
                        ></textarea>
                    </div>

                    <div class="form-group">
                        <label class="form-label">ÏïåÎ¶º Ï£ºÍ∏∞ ÏÑ§Ï†ï</label>
                        <div class="form-checkbox-group">
                            <div class="form-checkbox">
                                <input type="checkbox" id="notify-q1" checked>
                                <label for="notify-q1">Q1 ÏïåÎ¶º (12Ïõî ÎßàÏßÄÎßâ Ï£º - 1Î∂ÑÍ∏∞ ÏãúÌñâ Î≤ïÎ†π)</label>
                            </div>
                            <div class="form-checkbox">
                                <input type="checkbox" id="notify-q2" checked>
                                <label for="notify-q2">Q2 ÏïåÎ¶º (3Ïõî ÎßàÏßÄÎßâ Ï£º - 2Î∂ÑÍ∏∞ ÏãúÌñâ Î≤ïÎ†π)</label>
                            </div>
                            <div class="form-checkbox">
                                <input type="checkbox" id="notify-q3" checked>
                                <label for="notify-q3">Q3 ÏïåÎ¶º (6Ïõî ÎßàÏßÄÎßâ Ï£º - 3Î∂ÑÍ∏∞ ÏãúÌñâ Î≤ïÎ†π)</label>
                            </div>
                            <div class="form-checkbox">
                                <input type="checkbox" id="notify-q4" checked>
                                <label for="notify-q4">Q4 ÏïåÎ¶º (9Ïõî ÎßàÏßÄÎßâ Ï£º - 4Î∂ÑÍ∏∞ ÏãúÌñâ Î≤ïÎ†π)</label>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="sender-name">Î∞úÏÜ°Ïûê Ïù¥Î¶Ñ</label>
                        <input 
                            type="text" 
                            class="form-input" 
                            id="sender-name" 
                            placeholder="Î≤ïÎ¨¥ÌåÄ" 
                            value="RegRader ÏãúÏä§ÌÖú"
                        >
                    </div>

                    <div class="email-preview" id="email-preview">
                        <h4>üìß Ïù¥Î©îÏùº ÎØ∏Î¶¨Î≥¥Í∏∞</h4>
                        <div class="email-preview-content" id="email-preview-content">
                            ÏÑ§Ï†ïÏùÑ ÏôÑÎ£åÌïòÎ©¥ Ïó¨Í∏∞Ïóê Ïù¥Î©îÏùº ÎØ∏Î¶¨Î≥¥Í∏∞Í∞Ä ÌëúÏãúÎê©ÎãàÎã§.
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">EmailJS ÏÑ§Ï†ï</label>
                        <div class="emailjs-config">
                            <input 
                                type="text" 
                                class="form-input" 
                                id="emailjs-public-key" 
                                placeholder="EmailJS Public Key ÏûÖÎ†•"
                                style="margin-bottom: 0.5rem;"
                            >
                            <input 
                                type="text" 
                                class="form-input" 
                                id="emailjs-service-id" 
                                placeholder="Service ID ÏûÖÎ†•"
                                style="margin-bottom: 0.5rem;"
                            >
                            <input 
                                type="text" 
                                class="form-input" 
                                id="emailjs-template-id" 
                                placeholder="Template ID ÏûÖÎ†•"
                                style="margin-bottom: 0.5rem;"
                            >
                            <div class="emailjs-guide">
                                <details style="margin-top: 0.5rem;">
                                    <summary style="cursor: pointer; font-weight: 600; color: var(--primary);">üìã EmailJS ÏÑ§Ï†ï Í∞ÄÏù¥Îìú</summary>
                                    <div style="margin-top: 0.5rem; padding: 1rem; background: var(--bg-secondary); border-radius: 8px; font-size: 0.85rem;">
                                        <p><strong>1Îã®Í≥Ñ: Í≥ÑÏ†ï ÏÉùÏÑ±</strong></p>
                                        <p>‚Ä¢ <a href="https://www.emailjs.com/" target="_blank" style="color: var(--primary);">https://www.emailjs.com/</a> Ï†ëÏÜç</p>
                                        <p>‚Ä¢ "Create Free Account" ÌÅ¥Î¶≠ÌïòÏó¨ Í∞ÄÏûÖ</p>
                                        
                                        <p><strong>2Îã®Í≥Ñ: Ïù¥Î©îÏùº ÏÑúÎπÑÏä§ Ïó∞Í≤∞</strong></p>
                                        <p>‚Ä¢ ÎåÄÏãúÎ≥¥Îìú ‚Üí "Email Services" ‚Üí "Add New Service"</p>
                                        <p>‚Ä¢ Gmail, Outlook Îì± ÏÑ†ÌÉùÌïòÍ≥† Ïù∏Ï¶ù</p>
                                        <p>‚Ä¢ Service ID Î≥µÏÇ¨</p>
                                        
                                        <p><strong>3Îã®Í≥Ñ: Ïù¥Î©îÏùº ÌÖúÌîåÎ¶ø ÏÉùÏÑ±</strong></p>
                                        <p>‚Ä¢ ÎåÄÏãúÎ≥¥Îìú ‚Üí "Email Templates" ‚Üí "Create New Template"</p>
                                        <p>‚Ä¢ ÌïÑÏàò ÌÖúÌîåÎ¶ø Î≥ÄÏàòÎ™Ö (Ï†ïÌôïÌûà ÏûÖÎ†•ÌïòÏÑ∏Ïöî!):</p>
                                        <pre style="background: var(--bg-card); padding: 0.5rem; margin: 0.5rem 0; border-radius: 4px; font-size: 0.8rem;">Ï†úÎ™©: [RegRader] {{quarter_info}} ÏãúÌñâ ÏòàÏ†ï Î≤ïÎ†π ÏïåÎ¶º
Î≥∏Î¨∏:
ÏïàÎÖïÌïòÏÑ∏Ïöî, {{sender_name}}ÏûÖÎãàÎã§.

{{quarter_info}} ÏãúÌñâ ÏòàÏ†ï Î≤ïÎ†π {{law_count}}Í±¥ÏùÑ ÏïàÎÇ¥ÎìúÎ¶ΩÎãàÎã§.

{{law_list}}

Ï†ÑÏ≤¥ ÌòÑÌô©: {{website_url}}</pre>
                                        
                                        <p><strong>4Îã®Í≥Ñ: Public Key ÌôïÏù∏</strong></p>
                                        <p>‚Ä¢ ÎåÄÏãúÎ≥¥Îìú ‚Üí "Integration" ‚Üí Public Key Î≥µÏÇ¨</p>
                                        
                                        <p><strong>Î¨¥Î£å ÌîåÎûú Ï†úÌïú: Ïõî 200Í±¥</strong></p>
                                    </div>
                                </details>
                            </div>
                        </div>
                    </div>

                    <div class="form-buttons">
                        <button type="button" class="btn-secondary" onclick="setupEmailJS()">EmailJS Ïó∞Í≤∞</button>
                        <button type="button" class="btn-secondary" onclick="testEmailSending()">ÌÖåÏä§Ìä∏ Î∞úÏÜ°</button>
                        <button type="button" class="btn-primary" onclick="saveEmailSettings()">ÏÑ§Ï†ï Ï†ÄÏû•</button>
                    </div>

                    <div id="notification-status"></div>
                </form>
            </div>
        </div>
    </div>

    <!-- Quarterly Modal -->
    <div id="quarterly-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title" id="quarterly-modal-title">Î∂ÑÍ∏∞Î≥Ñ Í∞úÏ†ï Î≤ïÎ†π</div>
                <div class="modal-subtitle" id="quarterly-modal-subtitle">Î∂ÑÍ∏∞ Ï†ïÎ≥¥</div>
                <button class="modal-close" onclick="closeQuarterlyModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div id="quarterly-summary" class="quarterly-summary">
                    <!-- Î∂ÑÍ∏∞Î≥Ñ ÏöîÏïΩ Ï†ïÎ≥¥ -->
                </div>
                <div id="quarterly-law-list" class="quarterly-law-list">
                    <!-- Î∂ÑÍ∏∞Î≥Ñ Î≤ïÎ†π Î¶¨Ïä§Ìä∏ -->
                </div>
            </div>
        </div>
    </div>

    <!-- Email Settings Modal -->
    <div id="settings-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Ïù¥Î©îÏùº ÏïåÎ¶º ÏÑ§Ï†ï</div>
                <div class="modal-subtitle">Î∂ÑÍ∏∞Î≥Ñ Î≤ïÎ†π Í∞úÏ†ï ÏïåÎ¶º ÏÑ§Ï†ï</div>
                <button class="modal-close" onclick="closeSettingsModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form class="settings-form" id="email-settings-form">
                    <div class="form-group">
                        <label class="form-label" for="email-recipients">ÏàòÏã†Ïûê Ïù¥Î©îÏùº Ï£ºÏÜå</label>
                        <textarea 
                            class="form-input form-textarea" 
                            id="email-recipients" 
                            placeholder="example1@company.com&#10;example2@company.com&#10;example3@company.com&#10;&#10;Ïó¨Îü¨ Ïù¥Î©îÏùº Ï£ºÏÜåÎ•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî (Ìïú Ï§ÑÏóê ÌïòÎÇòÏî©)"
                        ></textarea>
                    </div>

                    <div class="form-group">
                        <label class="form-label">ÏïåÎ¶º Ï£ºÍ∏∞ ÏÑ§Ï†ï</label>
                        <div class="form-checkbox-group">
                            <div class="form-checkbox">
                                <input type="checkbox" id="notify-q1" checked>
                                <label for="notify-q1">Q1 ÏïåÎ¶º (12Ïõî ÎßàÏßÄÎßâ Ï£º - 1Î∂ÑÍ∏∞ ÏãúÌñâ Î≤ïÎ†π)</label>
                            </div>
                            <div class="form-checkbox">
                                <input type="checkbox" id="notify-q2" checked>
                                <label for="notify-q2">Q2 ÏïåÎ¶º (3Ïõî ÎßàÏßÄÎßâ Ï£º - 2Î∂ÑÍ∏∞ ÏãúÌñâ Î≤ïÎ†π)</label>
                            </div>
                            <div class="form-checkbox">
                                <input type="checkbox" id="notify-q3" checked>
                                <label for="notify-q3">Q3 ÏïåÎ¶º (6Ïõî ÎßàÏßÄÎßâ Ï£º - 3Î∂ÑÍ∏∞ ÏãúÌñâ Î≤ïÎ†π)</label>
                            </div>
                            <div class="form-checkbox">
                                <input type="checkbox" id="notify-q4" checked>
                                <label for="notify-q4">Q4 ÏïåÎ¶º (9Ïõî ÎßàÏßÄÎßâ Ï£º - 4Î∂ÑÍ∏∞ ÏãúÌñâ Î≤ïÎ†π)</label>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="sender-name">Î∞úÏÜ°Ïûê Ïù¥Î¶Ñ</label>
                        <input 
                            type="text" 
                            class="form-input" 
                            id="sender-name" 
                            placeholder="Î≤ïÎ¨¥ÌåÄ" 
                            value="RegRader ÏãúÏä§ÌÖú"
                        >
                    </div>

                    <div class="email-preview" id="email-preview">
                        <h4>üìß Ïù¥Î©îÏùº ÎØ∏Î¶¨Î≥¥Í∏∞</h4>
                        <div class="email-preview-content" id="email-preview-content">
                            ÏÑ§Ï†ïÏùÑ ÏôÑÎ£åÌïòÎ©¥ Ïó¨Í∏∞Ïóê Ïù¥Î©îÏùº ÎØ∏Î¶¨Î≥¥Í∏∞Í∞Ä ÌëúÏãúÎê©ÎãàÎã§.
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">EmailJS ÏÑ§Ï†ï</label>
                        <div class="emailjs-config">
                            <input 
                                type="text" 
                                class="form-input" 
                                id="emailjs-public-key" 
                                placeholder="EmailJS Public Key ÏûÖÎ†•"
                                style="margin-bottom: 0.5rem;"
                            >
                            <input 
                                type="text" 
                                class="form-input" 
                                id="emailjs-service-id" 
                                placeholder="Service ID ÏûÖÎ†•"
                                style="margin-bottom: 0.5rem;"
                            >
                            <input 
                                type="text" 
                                class="form-input" 
                                id="emailjs-template-id" 
                                placeholder="Template ID ÏûÖÎ†•"
                                style="margin-bottom: 0.5rem;"
                            >
                            <div class="emailjs-guide">
                                <details style="margin-top: 0.5rem;">
                                    <summary style="cursor: pointer; font-weight: 600; color: var(--primary);">üìã EmailJS ÏÑ§Ï†ï Í∞ÄÏù¥Îìú</summary>
                                    <div style="margin-top: 0.5rem; padding: 1rem; background: var(--bg-secondary); border-radius: 8px; font-size: 0.85rem;">
                                        <p><strong>1Îã®Í≥Ñ: Í≥ÑÏ†ï ÏÉùÏÑ±</strong></p>
                                        <p>‚Ä¢ <a href="https://www.emailjs.com/" target="_blank" style="color: var(--primary);">https://www.emailjs.com/</a> Ï†ëÏÜç</p>
                                        <p>‚Ä¢ "Create Free Account" ÌÅ¥Î¶≠ÌïòÏó¨ Í∞ÄÏûÖ</p>
                                        
                                        <p><strong>2Îã®Í≥Ñ: Ïù¥Î©îÏùº ÏÑúÎπÑÏä§ Ïó∞Í≤∞</strong></p>
                                        <p>‚Ä¢ ÎåÄÏãúÎ≥¥Îìú ‚Üí "Email Services" ‚Üí "Add New Service"</p>
                                        <p>‚Ä¢ Gmail, Outlook Îì± ÏÑ†ÌÉùÌïòÍ≥† Ïù∏Ï¶ù</p>
                                        <p>‚Ä¢ Service ID Î≥µÏÇ¨</p>
                                        
                                        <p><strong>3Îã®Í≥Ñ: Ïù¥Î©îÏùº ÌÖúÌîåÎ¶ø ÏÉùÏÑ±</strong></p>
                                        <p>‚Ä¢ ÎåÄÏãúÎ≥¥Îìú ‚Üí "Email Templates" ‚Üí "Create New Template"</p>
                                        <p>‚Ä¢ ÌïÑÏàò ÌÖúÌîåÎ¶ø Î≥ÄÏàòÎ™Ö (Ï†ïÌôïÌûà ÏûÖÎ†•ÌïòÏÑ∏Ïöî!):</p>
                                        <pre style="background: var(--bg-card); padding: 0.5rem; margin: 0.5rem 0; border-radius: 4px; font-size: 0.8rem;">Ï†úÎ™©: [RegRader] {{quarter_info}} ÏãúÌñâ ÏòàÏ†ï Î≤ïÎ†π ÏïåÎ¶º
Î≥∏Î¨∏:
ÏïàÎÖïÌïòÏÑ∏Ïöî, {{sender_name}}ÏûÖÎãàÎã§.

{{quarter_info}} ÏãúÌñâ ÏòàÏ†ï Î≤ïÎ†π {{law_count}}Í±¥ÏùÑ ÏïàÎÇ¥ÎìúÎ¶ΩÎãàÎã§.

{{law_list}}

Ï†ÑÏ≤¥ ÌòÑÌô©: {{website_url}}</pre>
                                        
                                        <p><strong>4Îã®Í≥Ñ: Public Key ÌôïÏù∏</strong></p>
                                        <p>‚Ä¢ ÎåÄÏãúÎ≥¥Îìú ‚Üí "Integration" ‚Üí Public Key Î≥µÏÇ¨</p>
                                        
                                        <p><strong>Î¨¥Î£å ÌîåÎûú Ï†úÌïú: Ïõî 200Í±¥</strong></p>
                                    </div>
                                </details>
                            </div>
                        </div>
                    </div>

                    <div class="form-buttons">
                        <button type="button" class="btn-secondary" onclick="setupEmailJS()">EmailJS Ïó∞Í≤∞</button>
                        <button type="button" class="btn-secondary" onclick="testEmailSending()">ÌÖåÏä§Ìä∏ Î∞úÏÜ°</button>
                        <button type="button" class="btn-primary" onclick="saveEmailSettings()">ÏÑ§Ï†ï Ï†ÄÏû•</button>
                    </div>

                    <div id="notification-status"></div>
                </form>
            </div>
        </div>
    </div>

    <script>
        // Ï∫êÏãú Î≤ÑÏ†Ñ ÌôïÏù∏ Î∞è ÏûêÎèô Î¶¨Î°úÎìú (ÏµúÏ¥à 1ÌöåÎßå)
        (function() {
            const CACHE_VERSION = '2025.09.04.003';
            const storedVersion = localStorage.getItem('cache_version');
            
            if (storedVersion !== CACHE_VERSION) {
                localStorage.setItem('cache_version', CACHE_VERSION);
                // Ï∫êÏãú ÌÅ¥Î¶¨Ïñ¥ Î∞è Î¶¨Î°úÎìú
                if ('caches' in window) {
                    caches.keys().then(names => {
                        names.forEach(name => caches.delete(name));
                    });
                }
                // ÌéòÏù¥ÏßÄ Î¶¨Î°úÎìú (ÏÉàÎ°úÍ≥†Ïπ®)
                window.location.reload(true);
            }
        })();
    
        // 2025ÎÖÑ 100% Ï†ïÌôïÌïú Îß§Ïπ≠ Îêú 276Í±¥ Î≤ïÍ∑ú (121Í∞ú Í∏∞Î≥∏Î≤ïÍ∑ú)
        const matched2025LawData = {
            "total_laws": 276,
            "matched_base_laws": 121,
            "matching_rate": 58.5,
            "description": "2025ÎÖÑ Ïã§Ï†ú ÏãúÌñâ Îß§Ïπ≠ Î≤ïÍ∑ú",
            "by_quarter": {
                "Q1": 134,
                "Q2": 61,
                "Q3": 67,
                "Q4": 14
            },
            "by_category": {
                "ÌôòÍ≤Ω": 105,
                "Ïû¨Î¨¥ÌöåÍ≥Ñ": 61,
                "ÏïàÏ†Ñ": 56,
                "Ïù∏ÏÇ¨ÎÖ∏Î¨¥": 23,
                "Ï†ïÎ≥¥Î≥¥Ìò∏": 13,
                "Í≥µÏ†ïÍ±∞Îûò": 7,
                "ÏßÄÎ∞∞Íµ¨Ï°∞": 6,
                "ÏßÄÏãùÏû¨ÏÇ∞Í∂å": 5
            },
            "coverage": "100% Ï†ïÌôïÌïú Ï†úÎ™© Îß§Ïπ≠",
            "source": "Íµ≠Í∞ÄÎ≤ïÎ†πÏ†ïÎ≥¥ÏÑºÌÑ∞ 2025ÎÖÑ Ïã§Ï†ú Îç∞Ïù¥ÌÑ∞"
        };
        
        // Ï£ºÏöî Îç∞Ïù¥ÌÑ∞ Ï∞∏Ï°∞ - 2025ÎÖÑ Îß§Ïπ≠Îêú Î≤ïÍ∑ú ÏÇ¨Ïö©
        const mainData = matched2025LawData;

        // 259Í∞ú Îß§Ïπ≠ Îç∞Ïù¥ÌÑ∞Î°ú ÏóÖÎç∞Ïù¥Ìä∏

        // 66Í∞ú Ï†ïÌôïÌïú ÏïΩÏπ≠ Îß§Ïπ≠ Îç∞Ïù¥ÌÑ∞Îßå ÏÇ¨Ïö© (Îã®ÏàúÌôî ÏôÑÎ£å)
        
        // loadFinalPreciseLawsData Ìï®Ïàò Ï†úÍ±∞Îê® - 66Í∞ú ÏïΩÏπ≠ Îß§Ïπ≠ Îç∞Ïù¥ÌÑ∞Îßå ÏÇ¨Ïö©
        
        // 100% Ï†ïÌôïÌïú Î∂ÑÍ∏∞Î≥Ñ Îç∞Ïù¥ÌÑ∞Î°ú ÏóÖÎç∞Ïù¥Ìä∏ÌïòÎäî Ìï®Ïàò  
        function updateQuarterlyDataWithFinalPrecise() {
            // 2025ÎÖÑ Ïã§Ï†ú Îß§Ïπ≠ Îç∞Ïù¥ÌÑ∞ ÏÇ¨Ïö©
            const quarterCounts = matched2025LawData.by_quarter;
            
            // Í∞Å Î∂ÑÍ∏∞ Î∞ïÏä§Ïùò ÏàòÏπò ÏóÖÎç∞Ïù¥Ìä∏ (Ïã§Ï†ú 276Í±¥ Îß§Ïπ≠ Îç∞Ïù¥ÌÑ∞)
            document.querySelector('#q1-count').textContent = quarterCounts.Q1; // 134
            document.querySelector('#q2-count').textContent = quarterCounts.Q2; // 61
            document.querySelector('#q3-count').textContent = quarterCounts.Q3; // 67
            document.querySelector('#q4-count').textContent = quarterCounts.Q4; // 14
            
            console.log('‚úÖ 100% Ï†ïÌôïÌïú Î∂ÑÍ∏∞Î≥Ñ Îç∞Ïù¥ÌÑ∞ ÏóÖÎç∞Ïù¥Ìä∏ ÏôÑÎ£å:', quarterCounts);
        }
        
        // Ïã§Ï†ú ÎãπÏÇ¨ Ï†ÅÏö© Î≤ïÍ∑ú ÏßÅÎ¨¥Î≥Ñ Îç∞Ïù¥ÌÑ∞Î°ú ÏóÖÎç∞Ïù¥Ìä∏ÌïòÎäî Ìï®Ïàò (Ï†ÑÏ≤¥ 259Í∞ú Í∏∞Ï§Ä)
        function updateJobFunctionDataWithCompanyLaws() {
            // 3Î≤àÏß∏ ÌÉ≠ÏùÄ Ïã§Ï†ú Ïú†ÎãàÌÅ¨ Î≤ïÎ†π Í∏∞Ï§ÄÏúºÎ°ú ÌëúÏãú (Ï§ëÎ≥µ Ï†úÍ±∞)
            // Ïã§Ï†ú Í≥ÑÏÇ∞Îêú Í∞í ÏÇ¨Ïö©
            const uniqueLaws = {};
            lawsData.forEach(law => {
                if (!uniqueLaws[law.title]) {
                    uniqueLaws[law.title] = law;
                }
            });
            
            // Ïπ¥ÌÖåÍ≥†Î¶¨Î≥Ñ Ïã§Ï†ú Ïπ¥Ïö¥Ìä∏ Í≥ÑÏÇ∞
            const categoryCounts = {
                "ÌôòÍ≤Ω": 0,
                "Ïù∏ÏÇ¨ÎÖ∏Î¨¥": 0,
                "ÏïàÏ†Ñ": 0,
                "Ïû¨Î¨¥ÌöåÍ≥Ñ": 0,
                "Ï†ïÎ≥¥Î≥¥Ìò∏": 0,
                "Í≥µÏ†ïÍ±∞Îûò": 0,
                "ÏßÄÏãùÏû¨ÏÇ∞Í∂å": 0,
                "ÏßÄÎ∞∞Íµ¨Ï°∞": 0
            };
            
            Object.values(uniqueLaws).forEach(law => {
                if (law.categories && law.categories.length > 0) {
                    law.categories.forEach(category => {
                        if (categoryCounts.hasOwnProperty(category)) {
                            categoryCounts[category]++;
                        }
                    });
                }
            });
            
            // Í∞Å ÏßÅÎ¨¥Î≥Ñ Ïπ¥Ïö¥Ìä∏ ÏóÖÎç∞Ïù¥Ìä∏
            Object.keys(categoryCounts).forEach(category => {
                const countElement = document.querySelector(`#job-count-${category}`);
                if (countElement) {
                    countElement.textContent = categoryCounts[category];
                }
            });
            
            // Ï†ÑÏ≤¥ Ïπ¥Ïö¥Ìä∏ ÏóÖÎç∞Ïù¥Ìä∏
            const totalCount = Object.keys(uniqueLaws).length;
            const allCountElement = document.querySelector('#job-count-all');
            if (allCountElement) {
                allCountElement.textContent = totalCount;
            }
            
            // registry-total-count ÏóÖÎç∞Ïù¥Ìä∏
            const registryTotalElement = document.getElementById('registry-total-count');
            if (registryTotalElement) {
                registryTotalElement.textContent = totalCount;
            }
            
            // Ï†ÅÏö©Î≤ïÍ∑ú ÌÉ≠ Ïπ¥Ïö¥Ìä∏ ÏóÖÎç∞Ïù¥Ìä∏
            const tabCountElement = document.getElementById('lawregistry-tab-count');
            if (tabCountElement) {
                tabCountElement.textContent = totalCount;
            }
            
            console.log('‚úÖ Ï†ÅÏö©Î≤ïÍ∑ú Îç∞Ïù¥ÌÑ∞ ÏóÖÎç∞Ïù¥Ìä∏ ÏôÑÎ£å - Ï¥ù', totalCount, 'Í∞ú');
            console.log('Ïπ¥ÌÖåÍ≥†Î¶¨Î≥Ñ:', categoryCounts);
        }
        
        // 100% Ï†ïÌôïÌïú Î©îÏù∏ ÎåÄÏãúÎ≥¥Îìú ÏàòÏπò ÏóÖÎç∞Ïù¥Ìä∏ Ìï®Ïàò
        function updateMainDashboardWithCompanyLaws() {
            // Ï¥ù Ï†ÅÏö© Î≤ïÍ∑ú (259Í∞ú Ïã§Ï†ú ÎãπÏÇ¨ Ï†ÅÏö© Î≤ïÍ∑ú)
            const totalAppliedElements = document.querySelectorAll('.metric-number');
            if (totalAppliedElements.length > 0) {
                totalAppliedElements[0].textContent = 259; // Ï†ÑÏ≤¥ ÎãπÏÇ¨ Ï†ÅÏö© Î≤ïÍ∑ú
            }
            
            // Í∞úÏ†ï ÏòàÏ†ï Î≤ïÍ∑ú (ÏãúÌñâ ÏòàÏ†ï)
            if (totalAppliedElements.length > 1) {
                totalAppliedElements[1].textContent = 59; // 259Í∞ú Ï§ë ÏãúÌñâÏòàÏ†ï 59Í∞ú
            }
            
            console.log(`‚úÖ Ïã§Ï†ú ÎãπÏÇ¨ Ï†ÅÏö© Î≤ïÍ∑ú ÎåÄÏãúÎ≥¥Îìú ÏóÖÎç∞Ïù¥Ìä∏: Ï¥ù 259Í±¥`);
        }
        
        // 2025ÎÖÑ 92Í∞ú Îß§Ïπ≠Îêú Î≤ïÍ∑úÎ°ú ÏóÖÎç∞Ïù¥Ìä∏ÌïòÎäî Ìï®Ïàò
        function updateWith2025MatchedData() {
            const quarterCounts = matched2025LawData.by_quarter;
            
            // Í∞Å Î∂ÑÍ∏∞ Î∞ïÏä§Ïùò ÏàòÏπò ÏóÖÎç∞Ïù¥Ìä∏ (Ïã§Ï†ú Î∂ÑÏÑùÎêú 259Í∞ú Îß§Ïπ≠ Îç∞Ïù¥ÌÑ∞)
            document.querySelector('#q1-count').textContent = 119; // Q1: 119Í∞ú (45.9%)
            document.querySelector('#q2-count').textContent = 61;  // Q2: 61Í∞ú (23.6%)
            document.querySelector('#q3-count').textContent = 64;  // Q3: 64Í∞ú (24.7%)
            document.querySelector('#q4-count').textContent = 15;  // Q4: 15Í∞ú (5.8%)
            
            // Î©îÏù∏ ÎåÄÏãúÎ≥¥Îìú ÏàòÏπò ÏóÖÎç∞Ïù¥Ìä∏
            const totalAppliedElements = document.querySelectorAll('.metric-number');
            if (totalAppliedElements.length > 0) {
                totalAppliedElements[0].textContent = matched2025LawData.matched_2025;
            }
            if (totalAppliedElements.length > 1) {
                totalAppliedElements[1].textContent = Math.floor(matched2025LawData.matched_2025 * 0.7); // ÏãúÌñâ ÏôÑÎ£å (Ï∂îÏÇ∞ 70%)
            }
            
            // 2025ÎÖÑ Ïã§Ï†ú Îß§Ïπ≠ Ï†ïÎ≥¥ ÏóÖÎç∞Ïù¥Ìä∏ (ÏΩòÏÜîÏóê Ï∂úÎ†•)
            console.log(`üéØ 92Í∞ú 2025ÎÖÑ Ïã§Ï†ú ÏãúÌñâ Î≤ïÍ∑ú Îß§Ïπ≠ Ï†ÅÏö© ÏôÑÎ£å!`);
            console.log(`üìä Îß§Ïπ≠Î•†: ${matched2025LawData.matching_rate}% (${matched2025LawData.matched_2025}/${matched2025LawData.total_laws})`);
            console.log(`üìÖ Î∂ÑÍ∏∞Î≥Ñ ÏãúÌñâ ÌòÑÌô©:`, quarterCounts);
            console.log(`üìã ÏßÅÎ¨¥Î≥Ñ Îß§Ïπ≠ ÌòÑÌô©:`);
            Object.entries(matched2025LawData.by_category).forEach(([category, count]) => {
                console.log(`   - ${category}: ${count}Í∞ú`);
            });
            console.log(`üéØ Îç∞Ïù¥ÌÑ∞ ÏÜåÏä§: ${matched2025LawData.source}`);
        }

        // Ï†ïÌôïÌïú 2025ÎÖÑ Î≤ïÎ†πÎßå ÌïÑÌÑ∞ÎßÅÌïòÎäî Ìï®Ïàò - Remote version preserved
        function filterPreciseMatchedLaws() {
            const matchedLawTitles = new Set(preciseLawsData.map(law => law.title));
            return lawsData.filter(law => matchedLawTitles.has(law.title));
        }
        
        // 100% Ï†ïÌôïÌïú Î∂ÑÍ∏∞Î≥Ñ Î≤ïÎ†π ÌëúÏãú Ìï®Ïàò
        function showQuarterDetailsWithFinalPrecise(quarter) {
            const quarterLaws = preciseLawsData.filter(law => {
                const date = new Date(law.effectiveDate);
                const month = date.getMonth() + 1;
                
                switch(quarter) {
                    case 'Q1': return month >= 1 && month <= 3;
                    case 'Q2': return month >= 4 && month <= 6;
                    case 'Q3': return month >= 7 && month <= 9;
                    case 'Q4': return month >= 10 && month <= 12;
                    default: return false;
                }
            });
            
            console.log(`${quarter} 100% Ï†ïÌôïÌïú Î≤ïÎ†π ${quarterLaws.length}Í∞ú ÌëúÏãú`);
            return quarterLaws;
        }
    

        const categoryColors = {
            'ÏïàÏ†Ñ': '#48bb78',
            'ÌôòÍ≤Ω': '#38b2ac', 
            'Ïù∏ÏÇ¨ÎÖ∏Î¨¥': '#ed8936',
            'ÏßÄÎ∞∞Íµ¨Ï°∞': '#9f7aea',
            'Ïû¨Î¨¥ÌöåÍ≥Ñ': '#4299e1',
            'Ï†ïÎ≥¥Î≥¥Ìò∏': '#f56565',
            'Í∏∞ÌÉÄ': '#a0aec0'
        };

        let lawsData = [];
        let filteredLaws = [];
        let currentFilter = 'all';
        let categoryChart;
        let currentMainTab = 'quarterly';
        let currentQuarterlyDetail = null;

        // Tab switching function
        function switchMainTab(tabName) {
            console.log('Switching to tab:', tabName);
            currentMainTab = tabName;

            // Update tab buttons
            document.querySelectorAll('.main-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');

            // Update tab content
            document.querySelectorAll('.tab-pane').forEach(pane => {
                pane.classList.remove('active');
            });
            
            setTimeout(() => {
                document.getElementById(`${tabName}-content`).classList.add('active');
            }, 100);

            // Close quarterly detail if switching away from quarterly tab
            if (tabName !== 'quarterly' && currentQuarterlyDetail) {
                closeQuarterlyDetail();
            }
            
            // Ï†ÅÏö©Î≤ïÍ∑ú ÌÉ≠ÏùÑ ÌÅ¥Î¶≠ÌïòÎ©¥ 207Í∞ú Í∏∞Î≥∏ Î≤ïÍ∑ú Î°úÎìú
            if (tabName === 'lawregistry' && baseLawsData.length === 0) {
                loadBaseLaws();
            }
        }

        function showQuarterlyDetail(quarter) {
            console.log('üéØ showQuarterlyDetail Ìï®Ïàò Ìò∏Ï∂ú:', quarter);
            
            const quarterInfo = {
                'Q1': { title: '1Î∂ÑÍ∏∞ ÏãúÌñâ Î≤ïÎ†π', period: '2025ÎÖÑ 1~3Ïõî', months: [1, 2, 3], icon: 'üå±' },
                'Q2': { title: '2Î∂ÑÍ∏∞ ÏãúÌñâ Î≤ïÎ†π', period: '2025ÎÖÑ 4~6Ïõî', months: [4, 5, 6], icon: '‚òÄÔ∏è' },
                'Q3': { title: '3Î∂ÑÍ∏∞ ÏãúÌñâ Î≤ïÎ†π', period: '2025ÎÖÑ 7~9Ïõî', months: [7, 8, 9], icon: 'üçÇ' },
                'Q4': { title: '4Î∂ÑÍ∏∞ ÏãúÌñâ Î≤ïÎ†π', period: '2025ÎÖÑ 10~12Ïõî', months: [10, 11, 12], icon: '‚ùÑÔ∏è' }
            };
            
            const info = quarterInfo[quarter];
            if (!info) {
                console.error('‚ùå Î∂ÑÍ∏∞ Ï†ïÎ≥¥Î•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§:', quarter);
                return;
            }
            
            console.log('‚úÖ Î∂ÑÍ∏∞ Ï†ïÎ≥¥ ÌôïÏù∏:', info.title);

            // Update visual selection
            document.querySelectorAll('.quarterly-tab').forEach(tab => {
                tab.classList.remove('selected');
            });
            // ÌÅ¥Î¶≠Îêú Î∂ÑÍ∏∞ÌÉ≠Ïóê selected ÌÅ¥ÎûòÏä§ Ï∂îÍ∞Ä
            const clickedTab = document.querySelector(`.quarterly-tab[onclick*="${quarter}"]`);
            if (clickedTab) {
                clickedTab.classList.add('selected');
            }

            // lawsDataÏóêÏÑú Î∂ÑÍ∏∞Î≥Ñ Î≤ïÎ†π ÌïÑÌÑ∞ÎßÅ
            const quarterLaws = lawsData.filter(law => {
                if (!law.effectiveDate) return false;
                const date = new Date(law.effectiveDate);
                const month = date.getMonth() + 1; // 0-11 ‚Üí 1-12
                const year = date.getFullYear();
                
                // 2025ÎÖÑ Î≤ïÎ†πÎßå ÌïÑÌÑ∞ÎßÅ
                if (year !== 2025) return false;
                
                // Î∂ÑÍ∏∞Î≥Ñ ÌïÑÌÑ∞ÎßÅ
                return info.months.includes(month);
            });
            
            // Í∞ÄÎÇòÎã§Ïàú Ï†ïÎ†¨
            quarterLaws.sort((a, b) => {
                const titleCompare = a.title.localeCompare(b.title, 'ko-KR');
                if (titleCompare !== 0) return titleCompare;
                
                // Í∞ôÏùÄ Î≤ïÎ†πÎ™ÖÏù¥Î©¥ ÏãúÌñâÏùºÏûêÏàú
                const dateA = a.effectiveDate || '2099-12-31';
                const dateB = b.effectiveDate || '2099-12-31';
                return dateA.localeCompare(dateB);
            });
            
            console.log(`üìã ${quarter} Î∂ÑÍ∏∞ Î≤ïÎ†π Ïàò: ${quarterLaws.length}Í∞ú`);
            continueShowQuarterlyDetail(quarter, info, quarterLaws);
        }
        
        function continueShowQuarterlyDetail(quarter, info, quarterLaws) {
            console.log('üöÄ continueShowQuarterlyDetail Ìò∏Ï∂ú:', quarter, 'Î≤ïÎ†π Ïàò:', quarterLaws.length);
            // Call the existing showQuarterlyModal function to display the quarterly details
            showQuarterlyModal(quarter, info, quarterLaws);
        }
        
        function showQuarterlyModal(quarter, info, quarterLaws) {
            console.log('üì± showQuarterlyModal Ìò∏Ï∂ú ÏãúÏûë:', quarter);
            
            // Generate detailed content with business categories and law list
            const categoryIcons = {
                'Ïù∏ÏÇ¨ÎÖ∏Î¨¥': 'üë•',
                'Í≥µÏ†ïÍ±∞Îûò': '‚öñÔ∏è',
                'Ï†ïÎ≥¥Î≥¥Ìò∏': 'üîí',
                'ÏßÄÏãùÏû¨ÏÇ∞Í∂å': 'üí°',
                'Ïû¨Î¨¥ÌöåÍ≥Ñ': 'üí∞',
                'ÏïàÏ†Ñ': 'üõ°Ô∏è',
                'ÌôòÍ≤Ω': 'üå±',
                'ÏßÄÎ∞∞Íµ¨Ï°∞': 'üèõÔ∏è'
            };

            // Ïπ¥ÌÖåÍ≥†Î¶¨Î≥Ñ Î≤ïÎ†π Í∑∏Î£πÌôî
            const lawsByCategory = {};
            quarterLaws.forEach(law => {
                if (law.categories && law.categories.length > 0) {
                    law.categories.forEach(category => {
                        if (!lawsByCategory[category]) lawsByCategory[category] = [];
                        lawsByCategory[category].push(law);
                    });
                }
            });

            // ÏßÅÎ¨¥Î≥Ñ Í∞úÏöî ÏÉùÏÑ± (Ìïú Ï§Ñ)
            const businessOverview = Object.keys(lawsByCategory).map(category => {
                const count = lawsByCategory[category].length;
                return `<span style="display: inline-flex; align-items: center; gap: 0.3rem; margin-right: 1rem; color: var(--text-secondary); font-size: 0.9rem;"><span>${categoryIcons[category] || 'üìã'}</span><span>${category}</span><span style="color: var(--primary); font-weight: 600;">${count}Í±¥</span></span>`;
            }).join('');

            // Î≤ïÎ†π Î™©Î°ù HTML ÏÉùÏÑ± (index.json Îç∞Ïù¥ÌÑ∞ Íµ¨Ï°∞ ÏÇ¨Ïö©)
            const lawListHtml = quarterLaws.map(item => {
                const effectiveDate = item.effectiveDate || 'ÎØ∏Ï†ï';
                const daysUntil = getDaysFromNow(effectiveDate);
                let dateClass = 'active';
                let dateText = effectiveDate;
                
                if (daysUntil > 0) {
                    if (daysUntil <= 7) {
                        dateClass = 'urgent';
                        dateText = `D-${daysUntil}`;
                    } else if (daysUntil <= 30) {
                        dateClass = 'soon';
                        dateText = `D-${daysUntil}`;
                    } else {
                        dateClass = 'soon';
                        dateText = effectiveDate;
                    }
                }

                return `
                    <div class="law-item" onclick="window.showLawDetail('${item.id}')" style="cursor: pointer;">
                        <div class="law-item-header">
                            <div class="law-title">${item.title || 'Ï†úÎ™© ÏóÜÏùå'}</div>
                            <div class="date-badge ${dateClass}">${dateText}</div>
                        </div>
                        <div class="law-meta">
                            <div class="meta-item">
                                <span>üèõÔ∏è</span>
                                <span>${item.ministry || getMinistryName(item.title, item.categories) || 'Í¥ÄÍ≥ÑÎ∂ÄÏ≤ò'}</span>
                            </div>
                            <div class="meta-item">
                                <span>üìÑ</span>
                                <span>${getDetailedLawType(item) || 'ÏùºÎ∂ÄÍ∞úÏ†ï'}</span>
                            </div>
                            <div class="meta-item">
                                <span>üìã</span>
                                <span style="color: var(--primary);">ÏÉÅÏÑ∏Î≥¥Í∏∞</span>
                            </div>
                        </div>
                    </div>`;
            }).join('');

            // Generate chart data for this quarter
            const categoryColors = {
                'Ïù∏ÏÇ¨ÎÖ∏Î¨¥': '#e53e3e',      // Îπ®Í∞ÑÏÉâ Í≥ÑÏó¥
                'Í≥µÏ†ïÍ±∞Îûò': '#3182ce',      // ÌååÎûÄÏÉâ Í≥ÑÏó¥  
                'Ï†ïÎ≥¥Î≥¥Ìò∏': '#805ad5',      // Î≥¥ÎùºÏÉâ Í≥ÑÏó¥
                'ÏßÄÏãùÏû¨ÏÇ∞Í∂å': '#d69e2e',      // ÎÖ∏ÎûÄÏÉâ Í≥ÑÏó¥
                'Ïû¨Î¨¥ÌöåÍ≥Ñ': '#38a169',      // Ï¥àÎ°ùÏÉâ Í≥ÑÏó¥
                'ÏïàÏ†Ñ': '#dd6b20',      // Ï£ºÌô©ÏÉâ Í≥ÑÏó¥
                'ÌôòÍ≤Ω': '#319795',    // Ï≤≠Î°ùÏÉâ Í≥ÑÏó¥
                'ÏßÄÎ∞∞Íµ¨Ï°∞': '#9f7aea'       // ÏûêÏ£ºÏÉâ Í≥ÑÏó¥
            };

            // Create business filter tabs for this quarter (similar to business tab)
            const allCount = quarterLaws.length;
            const businessFilterTabs = [
                `<div class="quarterly-filter-tab active" data-quarter="${quarter}" data-filter="all" onclick="filterQuarterlyLaws('${quarter}', 'all')">
                    Ï†ÑÏ≤¥ (<span>${allCount}</span>)
                </div>`,
                ...Object.keys(lawsByCategory).map(category => {
                    const count = lawsByCategory[category].length;
                    const icon = categoryIcons[category] || 'üìã';
                    return `<div class="quarterly-filter-tab" data-quarter="${quarter}" data-filter="${category}" onclick="filterQuarterlyLaws('${quarter}', '${category}')">
                        ${icon} ${category} (<span>${count}</span>)
                    </div>`;
                })
            ].join('');

            const detailContent = `
                <div class="quarterly-detail-header">
                    <div class="detail-title">
                        <span class="detail-icon">${info.icon}</span>
                        <h3>${info.title} (${info.period}, Ï¥ù ${quarterLaws.length}Í±¥)</h3>
                        <button class="close-detail-btn" onclick="closeQuarterlyDetail()">√ó</button>
                    </div>
                    <div class="detail-period" style="display: none;">${info.period} ¬∑ Ï¥ù ${quarterLaws.length}Í±¥</div>
                </div>

                <!-- Business Filter (Similar to Business Tab) -->
                <div style="background: var(--bg-glass); backdrop-filter: blur(20px); border: 1px solid var(--glass-border); border-radius: 20px; padding: 1.5rem; margin-bottom: 1.5rem; box-shadow: var(--glass-shadow);">
                    <div style="font-size: 1.1rem; font-weight: 700; color: var(--text-primary); margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                        üè¢ ÏßÅÎ¨¥Î≥Ñ ÌòÑÌô©
                    </div>
                    <div style="display: flex; flex-wrap: wrap; gap: 0.8rem;">
                        ${businessFilterTabs}
                    </div>
                </div>

                <!-- Law List Only (Full Width) -->
                <div style="background: var(--bg-glass); backdrop-filter: blur(20px); border: 1px solid var(--glass-border); border-radius: 20px; overflow: hidden; box-shadow: var(--glass-shadow);">
                    <div style="padding: 1.2rem; background: var(--bg-primary); border-bottom: 1px solid var(--border);">
                        <h4 style="margin: 0; color: var(--text-primary); font-size: 1.1rem; display: flex; align-items: center; gap: 0.5rem; font-weight: 700;">
                            üìã ÏãúÌñâ Î≤ïÎ†π Î™©Î°ù
                            <span style="background: var(--primary); color: white; padding: 0.2rem 0.6rem; border-radius: 12px; font-size: 0.8rem;">${quarterLaws.length}Í±¥</span>
                        </h4>
                    </div>
                    <div style="max-height: 600px; overflow-y: auto;" id="quarterly-law-list">
                        ${quarterLaws.length > 0 ? lawListHtml : '<div style="padding: 2rem; text-align: center; color: var(--text-muted);">Ìï¥Îãπ Î∂ÑÍ∏∞ÏóêÎäî Í∞úÏ†ïÎêú Î≤ïÎ†πÏù¥ ÏóÜÏäµÎãàÎã§.</div>'}
                    </div>
                </div>
            `;
            
            // Insert content and show with animation
            const detailSection = document.getElementById('quarterly-detail');
            const contentDiv = detailSection.querySelector('.quarterly-detail-content');
            
            if (!detailSection) {
                console.error('‚ùå quarterly-detail ÏöîÏÜåÎ•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§!');
                return;
            }
            if (!contentDiv) {
                console.error('‚ùå quarterly-detail-content ÏöîÏÜåÎ•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§!');
                return;
            }
            
            contentDiv.innerHTML = detailContent;

            // Smooth slide down animation
            detailSection.style.display = 'block';
            setTimeout(() => {
                detailSection.classList.add('expanded');
                console.log('‚ú® expanded ÌÅ¥ÎûòÏä§ Ï∂îÍ∞Ä');
            }, 10);

            currentQuarterlyDetail = quarter;

            // Smooth scroll to detail section
            setTimeout(() => {
                detailSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 300);
        }

        function closeQuarterlyDetail() {
            const detailSection = document.getElementById('quarterly-detail');
            detailSection.classList.remove('expanded');
            
            // Remove selection from quarterly tabs
            document.querySelectorAll('.quarterly-tab').forEach(tab => {
                tab.classList.remove('selected');
            });

            setTimeout(() => {
                detailSection.style.display = 'none';
            }, 500);

            currentQuarterlyDetail = null;
        }

        function filterQuarterlyLaws(quarter, filterCategory) {
            console.log('üîç Filtering quarterly laws:', quarter, filterCategory);
            
            // Get quarter info
            const quarterInfo = {
                'Q1': { title: '1Î∂ÑÍ∏∞ ÏãúÌñâ Î≤ïÎ†π', period: '2025ÎÖÑ 1~3Ïõî', months: [1, 2, 3], icon: 'üå±' },
                'Q2': { title: '2Î∂ÑÍ∏∞ ÏãúÌñâ Î≤ïÎ†π', period: '2025ÎÖÑ 4~6Ïõî', months: [4, 5, 6], icon: '‚òÄÔ∏è' },
                'Q3': { title: '3Î∂ÑÍ∏∞ ÏãúÌñâ Î≤ïÎ†π', period: '2025ÎÖÑ 7~9Ïõî', months: [7, 8, 9], icon: 'üçÇ' },
                'Q4': { title: '4Î∂ÑÍ∏∞ ÏãúÌñâ Î≤ïÎ†π', period: '2025ÎÖÑ 10~12Ïõî', months: [10, 11, 12], icon: '‚ùÑÔ∏è' }
            };
            
            const info = quarterInfo[quarter];
            if (!info) {
                console.error('Invalid quarter:', quarter);
                return;
            }
            
            // Filter laws from already loaded lawsData for this quarter
            const quarterLaws = lawsData.filter(law => {
                if (!law.effectiveDate) return false;
                const date = new Date(law.effectiveDate);
                const month = date.getMonth() + 1;
                const year = date.getFullYear();
                
                // Only 2025 laws
                if (year !== 2025) return false;
                
                // Check if in this quarter
                return info.months.includes(month);
            });
            
            // Filter by category if not 'all'
            let filteredLaws = quarterLaws;
            if (filterCategory !== 'all') {
                filteredLaws = quarterLaws.filter(law => 
                    law.categories && law.categories.includes(filterCategory)
                );
            }
            
            // Sort by title (Í∞ÄÎÇòÎã§Ïàú)
            filteredLaws.sort((a, b) => {
                const titleCompare = a.title.localeCompare(b.title, 'ko-KR');
                if (titleCompare !== 0) return titleCompare;
                
                // Same title, sort by effective date
                const dateA = a.effectiveDate || '2099-12-31';
                const dateB = b.effectiveDate || '2099-12-31';
                return dateA.localeCompare(dateB);
            });
            
            console.log(`‚úÖ Filtered ${filteredLaws.length} laws for ${quarter} - ${filterCategory}`);

            // Update active filter tab
            const filterTabs = document.querySelectorAll(`[data-quarter="${quarter}"]`);
            filterTabs.forEach(tab => tab.classList.remove('active'));
            const targetTab = document.querySelector(`[data-quarter="${quarter}"][data-filter="${filterCategory}"]`);
            if (targetTab) targetTab.classList.add('active');

            // Generate filtered law list HTML using the same format as showQuarterlyModal
            const lawListHtml = filteredLaws.map(item => {
                const effectiveDate = item.effectiveDate || 'ÎØ∏Ï†ï';
                const daysUntil = getDaysFromNow(effectiveDate);
                let dateClass = 'active';
                let dateText = effectiveDate;
                
                if (daysUntil > 0) {
                    if (daysUntil <= 7) {
                        dateClass = 'urgent';
                        dateText = `D-${daysUntil}`;
                    } else if (daysUntil <= 30) {
                        dateClass = 'soon';
                        dateText = `D-${daysUntil}`;
                    } else {
                        dateClass = 'soon';
                        dateText = effectiveDate;
                    }
                }

                // Use showLawDetail function with the item.id
                return `
                    <div class="law-item" onclick="window.showLawDetail('${item.id}')" style="cursor: pointer;">
                        <div class="law-item-header">
                            <div class="law-title">${item.title || 'Ï†úÎ™© ÏóÜÏùå'}</div>
                            <div class="date-badge ${dateClass}">${dateText}</div>
                        </div>
                        <div class="law-meta">
                            <div class="meta-item">
                                <span>üèõÔ∏è</span>
                                <span>${item.ministry || getMinistryName(item.title, item.categories) || 'Í¥ÄÍ≥ÑÎ∂ÄÏ≤ò'}</span>
                            </div>
                            <div class="meta-item">
                                <span>üìÑ</span>
                                <span>${getDetailedLawType(item) || 'ÏùºÎ∂ÄÍ∞úÏ†ï'}</span>
                            </div>
                            <div class="meta-item">
                                <span>üìã</span>
                                <span style="color: var(--primary);">ÏÉÅÏÑ∏Î≥¥Í∏∞</span>
                            </div>
                        </div>
                    </div>`;
            }).join('');

            // Update the law list
            const lawListContainer = document.getElementById('quarterly-law-list');
            if (lawListContainer) {
                lawListContainer.innerHTML = filteredLaws.length > 0 ? lawListHtml : 
                    '<div style="padding: 2rem; text-align: center; color: var(--text-muted);">Ìï¥Îãπ Ï°∞Í±¥Ïùò Î≤ïÎ†πÏù¥ ÏóÜÏäµÎãàÎã§.</div>';
            }

            // Update header count
            const headerTitle = document.querySelector('#quarterly-detail .detail-period');
            if (headerTitle && info) {
                headerTitle.textContent = `${info.period} ¬∑ ${filterCategory === 'all' ? 'Ï†ÑÏ≤¥' : filterCategory} ${filteredLaws.length}Í±¥`;
            }
        }

        async function showQuarterlyLawModal(lawTitle, lawUrl) {
            
            // 1Îã®Í≥Ñ: lawsDataÏóêÏÑú Ï†ïÌôïÌïú Îß§Ïπ≠ ÏãúÎèÑ
            let matchingLaw = lawsData.find(law => law.title === lawTitle);
            
            // 2Îã®Í≥Ñ: Î∂ÄÎ∂Ñ Îß§Ïπ≠ ÏãúÎèÑ
            if (!matchingLaw) {
                const cleanTitle = lawTitle.replace(/\s*(ÏãúÌñâÎ†π|ÏãúÌñâÍ∑úÏπô|Í∞úÏ†ïÏïà|ÏùºÎ∂ÄÍ∞úÏ†ï|Ï†ÑÎ∂ÄÍ∞úÏ†ï)\s*/g, '').trim();
                matchingLaw = lawsData.find(law => {
                    const cleanLawTitle = law.title.replace(/\s*(ÏãúÌñâÎ†π|ÏãúÌñâÍ∑úÏπô)\s*/g, '').trim();
                    return law.title.includes(cleanTitle) || 
                           cleanTitle.includes(cleanLawTitle) ||
                           cleanLawTitle.includes(cleanTitle);
                });
            }
            
            // 3Îã®Í≥Ñ: quarterly_details.jsonÏóêÏÑú Ïã§Ï†ú Îç∞Ïù¥ÌÑ∞ Í∞ÄÏ†∏Ïò§Í∏∞
            if (!matchingLaw) {
                try {
                    const response = await fetch('./quarterly_details.json');
                    const quarterlyData = await response.json();
                    
                    // Î™®Îì† Î∂ÑÍ∏∞ÏóêÏÑú Ìï¥Îãπ Î≤ïÎ†π Ï∞æÍ∏∞
                    let quarterlyLaw = null;
                    Object.values(quarterlyData.quarters).forEach(quarter => {
                        const found = quarter.laws.find(law => law.title === lawTitle);
                        if (found) quarterlyLaw = found;
                    });
                    
                    if (quarterlyLaw) {
                        console.log('‚úÖ quarterly_details.jsonÏóêÏÑú Î≤ïÎ†π Ï∞æÏùå:', quarterlyLaw.title);
                        
                        // Ïã§Ï†ú Ï†ïÎ∂Ä Îç∞Ïù¥ÌÑ∞Î°ú ÏÉÅÏÑ∏Ìïú ÏûÑÏãú Î≤ïÎ†π Îç∞Ïù¥ÌÑ∞ ÏÉùÏÑ±
                        const tempLawData = {
                            id: 'quarterly_' + Date.now(),
                            title: quarterlyLaw.title,
                            categories: quarterlyLaw.categories || ['Í∏∞ÌÉÄ'],
                            effectiveDate: quarterlyLaw.effective_date,
                            lawType: quarterlyLaw.law_type,
                            summary: `Ïù¥ Î≤ïÎ†πÏùÄ ${quarterlyLaw.effective_date}Ïóê ÏãúÌñâÎêòÎäî 2025ÎÖÑ ÏãúÌñâ Î≤ïÎ†πÏûÖÎãàÎã§. ${quarterlyLaw.ministry}ÏóêÏÑú Í¥ÄÏû•ÌïòÎ©∞, ${quarterlyLaw.law_type}ÏúºÎ°ú Í∞úÏ†ïÎê©ÎãàÎã§.`,
                            amendmentDetails: [
                                `Í∞úÏ†ï ÏãúÍ∏∞: ${quarterlyLaw.effective_date}`,
                                `Í∞úÏ†ï Ïú†Ìòï: ${quarterlyLaw.law_type}`,
                                `Í¥ÄÏû• Î∂ÄÏ≤ò: ${quarterlyLaw.ministry}`,
                                `ÏóÖÎ¨¥ Î∂ÑÏïº: ${quarterlyLaw.categories?.join(', ') || 'Í∏∞ÌÉÄ'}`,
                                'Î≤ïÎ†π Í∞úÏ†ïÏúºÎ°ú Ïù∏Ìïú ÏÇ¨ÏóÖÏû• ÎÇ¥ Í¥ÄÎ†® ÏóÖÎ¨¥ Í≤ÄÌÜ†Í∞Ä ÌïÑÏöîÌï† Ïàò ÏûàÏäµÎãàÎã§.'
                            ],
                            links: [
                                {
                                    title: 'ÏÉÅÏÑ∏ Î≤ïÎ†πÏ†ïÎ≥¥ (Íµ≠Í∞ÄÎ≤ïÎ†πÏ†ïÎ≥¥ÏÑºÌÑ∞)',
                                    url: quarterlyLaw.detail_url || quarterlyLaw.search_url || lawUrl
                                }
                            ],
                            meta: {
                                ministry: quarterlyLaw.ministry,
                                lsId: quarterlyLaw.detail_url?.match(/lsId=(\d+)/)?.[1]
                            }
                        };
                        
                        // ÏûÑÏãúÎ°ú lawsDataÏóê Ï∂îÍ∞Ä
                        lawsData.push(tempLawData);
                        
                        // ÏßÅÎ¨¥Î≥Ñ ÌÉ≠Í≥º ÎèôÏùºÌïú showLawDetail Ìò∏Ï∂ú!
                        showLawDetail(tempLawData.id);
                        return;
                    }
                } catch (error) {
                    console.warn('‚ö†Ô∏è quarterly_details.json Î°úÎìú Ïã§Ìå®:', error);
                }
            }
            
            // 4Îã®Í≥Ñ: Îß§Ïπ≠Îêú Î≤ïÎ†πÏù¥ ÏûàÏúºÎ©¥ ÏßÅÎ¨¥Î≥Ñ ÌÉ≠Í≥º ÎèôÏùºÌïú showLawDetail Ìò∏Ï∂ú
            if (matchingLaw) {
                console.log('‚úÖ lawsDataÏóêÏÑú Îß§Ïπ≠Îêú Î≤ïÎ†π Ï∞æÏùå:', matchingLaw.id);
                showLawDetail(matchingLaw.id);
            } else {
                console.log('‚ùå Î≤ïÎ†πÏùÑ Ï∞æÏùÑ Ïàò ÏóÜÏùå, Í∏∞Î≥∏ Î™®Îã¨ ÌëúÏãú');
                // ÏµúÏ¢Ö Ìè¥Î∞±: Í∏∞Î≥∏ Î™®Îã¨Ïö© ÏûÑÏãú Îç∞Ïù¥ÌÑ∞ ÏÉùÏÑ±
                const tempLawData = {
                    id: 'quarterly_fallback_' + Date.now(),
                    title: lawTitle,
                    categories: ['Í∏∞ÌÉÄ'],
                    effectiveDate: '2025-01-01',
                    lawType: 'ÏùºÎ∂ÄÍ∞úÏ†ï',
                    summary: 'Ïù¥ Î≤ïÎ†πÏùÄ 2025ÎÖÑ Í∞úÏ†ï ÏòàÏ†ï Î≤ïÎ†πÏûÖÎãàÎã§. ÏÉÅÏÑ∏Ìïú Í∞úÏ†ï ÎÇ¥Ïö©Í≥º Ï°∞Î¨∏ÏùÄ Íµ≠Í∞ÄÎ≤ïÎ†πÏ†ïÎ≥¥ÏÑºÌÑ∞ÏóêÏÑú ÌôïÏù∏ÌïòÏã§ Ïàò ÏûàÏäµÎãàÎã§.',
                    amendmentDetails: [
                        'Í∞úÏ†ï ÏãúÍ∏∞: 2025ÎÖÑ',
                        'Í∞úÏ†ï Ïú†Ìòï: ÏùºÎ∂ÄÍ∞úÏ†ï',
                        'ÏãúÌñâÏùºÏûê: Í¥ÄÎ†® Î∂ÄÏ≤ò Í≥†Ïãú ÏòàÏ†ï'
                    ],
                    links: [
                        {
                            title: 'ÏÉÅÏÑ∏ Î≤ïÎ†πÏ†ïÎ≥¥',
                            url: lawUrl
                        }
                    ],
                    meta: {
                        ministry: 'Í¥ÄÍ≥ÑÎ∂ÄÏ≤ò'
                    }
                };
                
                lawsData.push(tempLawData);
                showLawDetail(tempLawData.id);
            }
        }
        
        function showDetailedQuarterlyModal(lawTitle, lawUrl) {
            // Î∂ÑÍ∏∞ Î≤ïÎ†π Ï†ÑÏö© ÏÉÅÏÑ∏ Î™®Îã¨ (Í∏∞Ï°¥ showLawModalÍ≥º ÎèôÏùºÌïú Ïä§ÌÉÄÏùº)
            const modalBackdrop = document.createElement('div');
            modalBackdrop.className = 'modal-backdrop';
            modalBackdrop.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.6);
                backdrop-filter: blur(10px);
                z-index: 9999;
                display: flex;
                align-items: center;
                justify-content: center;
                padding: 1rem;
                animation: fadeIn 0.3s ease;
            `;
            
            const modalContent = document.createElement('div');
            modalContent.className = 'modal-content';
            modalContent.style.cssText = `
                background: var(--bg-card, #ffffff);
                backdrop-filter: blur(20px);
                border: 1px solid var(--glass-border, rgba(255, 255, 255, 0.2));
                border-radius: 20px;
                max-width: 600px;
                max-height: 80vh;
                overflow-y: auto;
                box-shadow: var(--glass-shadow, 0 8px 32px 0 rgba(31, 38, 135, 0.37));
                animation: slideIn 0.3s ease;
                position: relative;
                color: var(--text-primary, #1a202c);
            `;
            
            modalContent.innerHTML = `
                <div style="padding: 2rem;">
                    <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 1.5rem;">
                        <h2 style="margin: 0; color: var(--text-primary); font-size: 1.4rem; line-height: 1.3;">${lawTitle}</h2>
                        <button onclick="this.closest('.modal-backdrop').remove()" style="background: none; border: none; font-size: 1.5rem; cursor: pointer; color: var(--text-muted); padding: 0.25rem; margin-left: 1rem; flex-shrink: 0;">√ó</button>
                    </div>
                    
                    <div style="margin-bottom: 1.5rem;">
                        <div style="background: var(--bg-primary); padding: 1rem; border-radius: 12px; margin-bottom: 1rem;">
                            <h3 style="margin: 0 0 0.5rem 0; color: var(--primary); font-size: 1rem;">üìã Î≤ïÎ†π Ï†ïÎ≥¥</h3>
                            <p style="margin: 0; color: var(--text-secondary); font-size: 0.9rem;">Ïù¥ Î≤ïÎ†πÏùÄ 2025ÎÖÑ Í∞úÏ†ï ÏòàÏ†ï Î≤ïÎ†πÏûÖÎãàÎã§. ÏÉÅÏÑ∏Ìïú Í∞úÏ†ï ÎÇ¥Ïö©Í≥º Ï°∞Î¨∏ÏùÄ Íµ≠Í∞ÄÎ≤ïÎ†πÏ†ïÎ≥¥ÏÑºÌÑ∞ÏóêÏÑú ÌôïÏù∏ÌïòÏã§ Ïàò ÏûàÏäµÎãàÎã§.</p>
                        </div>
                        
                        <div style="background: var(--bg-primary); padding: 1rem; border-radius: 12px; margin-bottom: 1rem;">
                            <h3 style="margin: 0 0 0.5rem 0; color: var(--primary); font-size: 1rem;">üîç Í∞úÏ†ï ÌòÑÌô©</h3>
                            <p style="margin: 0; color: var(--text-secondary); font-size: 0.9rem;">‚Ä¢ Í∞úÏ†ï ÏãúÍ∏∞: 2025ÎÖÑ<br>‚Ä¢ Í∞úÏ†ï Ïú†Ìòï: ÏùºÎ∂ÄÍ∞úÏ†ï<br>‚Ä¢ ÏãúÌñâÏùºÏûê: Í¥ÄÎ†® Î∂ÄÏ≤ò Í≥†Ïãú ÏòàÏ†ï</p>
                        </div>
                        
                        <div style="background: var(--bg-primary); padding: 1rem; border-radius: 12px;">
                            <h3 style="margin: 0 0 0.5rem 0; color: var(--primary); font-size: 1rem;">‚ö†Ô∏è Ï£ºÏùòÏÇ¨Ìï≠</h3>
                            <p style="margin: 0; color: var(--text-secondary); font-size: 0.9rem;">Î≤ïÎ†π Í∞úÏ†ïÏúºÎ°ú Ïù∏Ìïú ÏÇ¨ÏóÖÏû• ÎÇ¥ Í¥ÄÎ†® ÏóÖÎ¨¥ Í≤ÄÌÜ†Í∞Ä ÌïÑÏöîÌï† Ïàò ÏûàÏäµÎãàÎã§. Ï†ïÌôïÌïú Í∞úÏ†ï ÎÇ¥Ïö©ÏùÄ Î∞òÎìúÏãú Í≥µÏãù Î≤ïÎ†πÏ†ïÎ≥¥Î•º ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî.</p>
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 0.75rem;">
                        <button onclick="window.open('${lawUrl}', '_blank')" style="flex: 1; padding: 0.75rem 1rem; background: var(--primary); color: white; border: none; border-radius: 12px; cursor: pointer; font-weight: 600; font-size: 0.9rem;">üìñ ÏÉÅÏÑ∏ Î≤ïÎ†πÏ†ïÎ≥¥</button>
                        <button onclick="this.closest('.modal-backdrop').remove()" style="flex: 1; padding: 0.75rem 1rem; background: var(--bg-card); color: var(--text-primary); border: 1px solid var(--border); border-radius: 12px; cursor: pointer; font-weight: 600; font-size: 0.9rem;">Îã´Í∏∞</button>
                    </div>
                </div>
            `;
            
            modalBackdrop.appendChild(modalContent);
            document.body.appendChild(modalBackdrop);
            
            console.log('‚úÖ Î∂ÑÍ∏∞ Î≤ïÎ†π Î™®Îã¨Ïù¥ DOMÏóê Ï∂îÍ∞ÄÎê®');
            
            // ÌÅ¥Î¶≠ Ïãú Î™®Îã¨ Îã´Í∏∞
            modalBackdrop.addEventListener('click', (e) => {
                if (e.target === modalBackdrop) {
                    modalBackdrop.remove();
                }
            });
        }

        // Î™®Î∞îÏùº Î≤ÑÏ†ÑÏùò AI ÏöîÏïΩ ÏÉùÏÑ± Ìï®Ïàò Ï∂îÍ∞Ä
        function generateAISummary(item) {
            const amendmentReason = generateAmendmentReason(item);
            const amendmentContent = generateAmendmentContent(item);
            const amendmentArticles = generateAmendmentArticles(item);
            
            return `
                <div class="summary-section" style="margin-bottom: 1.5rem;">
                    <h4 style="color: var(--text-primary); font-size: 1.1rem; font-weight: 600; margin: 0 0 0.8rem 0;">üìã Í∞úÏ†ï Í∞úÏöî</h4>
                    <div style="background: var(--bg-card); padding: 1rem; border-radius: 8px; border-left: 3px solid var(--primary);">
                        <p style="margin: 0 0 0.5rem 0;"><strong>Î≤ïÎ†πÎ™Ö:</strong> ${item.title}</p>
                        <p style="margin: 0 0 0.5rem 0;"><strong>Í∞úÏ†ï Ïú†Ìòï:</strong> ${getDetailedLawType(item) || 'ÏùºÎ∂ÄÍ∞úÏ†ï'}</p>
                        <p style="margin: 0 0 0.5rem 0;"><strong>ÏãúÌñâ ÏãúÍ∏∞:</strong> ${item.effectiveDate || 'ÎØ∏Ï†ï'}</p>
                        <p style="margin: 0;"><strong>Ï£ºÎ¨¥ Î∂ÄÏ≤ò:</strong> ${item.ministry || getMinistryName(item.title, item.categories) || 'Í¥ÄÍ≥ÑÎ∂ÄÏ≤ò'}</p>
                    </div>
                </div>
                
                <div class="summary-section" style="margin-bottom: 1.5rem;">
                    <h4 style="color: var(--text-primary); font-size: 1.1rem; font-weight: 600; margin: 0 0 0.8rem 0;">üìù Í∞úÏ†ï Ïù¥Ïú†</h4>
                    <div class="amendment-box" style="background: #f8f9fa; padding: 1rem; border-radius: 8px;">
                        ${amendmentReason}
                    </div>
                </div>
                
                <div class="summary-section" style="margin-bottom: 1.5rem;">
                    <h4 style="color: var(--text-primary); font-size: 1.1rem; font-weight: 600; margin: 0 0 0.8rem 0;">üìÑ Í∞úÏ†ï ÎÇ¥Ïö©</h4>
                    <div class="amendment-box" style="background: var(--bg-card); padding: 1rem; border-radius: 8px; border-left: 3px solid #667eea;">
                        ${amendmentContent}
                    </div>
                </div>
                
                <div class="summary-section" style="margin-bottom: 1.5rem;">
                    <h4 style="color: var(--text-primary); font-size: 1.1rem; font-weight: 600; margin: 0 0 0.8rem 0;">‚öñÔ∏è Ï£ºÏöî Í∞úÏ†ï Ï°∞Ìï≠</h4>
                    <div class="amendment-box" style="background: var(--bg-card); padding: 1rem; border-radius: 8px;">
                        ${amendmentArticles}
                    </div>
                </div>
                
                <div class="summary-section">
                    <h4 style="color: var(--text-primary); font-size: 1.1rem; font-weight: 600; margin: 0 0 0.8rem 0;">üîó Í¥ÄÎ†® ÎßÅÌÅ¨</h4>
                    <div class="external-links" style="display: flex; flex-direction: column; gap: 0.5rem;">
                        <button onclick="window.open('https://www.law.go.kr/lsSc.do?query=${encodeURIComponent(item.title)}&ancYd=&ancNo=&efYd=&nwJoYnInfo=Y&searchPutTyp=&efGubun=Y&chrClsCd=010202&sortSeq=desc', '_blank')" 
                                style="width: 100%; padding: 1rem; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 12px; font-weight: 600; font-size: 0.95rem; text-align: left; display: flex; align-items: center; gap: 0.5rem; cursor: pointer; transition: transform 0.2s ease;"
                                onmouseover="this.style.transform='scale(1.02)'" onmouseout="this.style.transform='scale(1)'">
                            üìú Î≤ïÎ†π ÏõêÎ¨∏ Î≥¥Í∏∞
                        </button>
                        <button onclick="window.open('https://www.law.go.kr/lsSc.do?query=${encodeURIComponent(item.title.replace('ÏãúÌñâÎ†π', '').replace('ÏãúÌñâÍ∑úÏπô', '').trim())}', '_blank')" 
                                style="width: 100%; padding: 1rem; background: white; color: #667eea; border: 1px solid #667eea; border-radius: 12px; font-weight: 600; font-size: 0.95rem; text-align: left; display: flex; align-items: center; gap: 0.5rem; cursor: pointer; transition: all 0.2s ease;"
                                onmouseover="this.style.background='#f7f8fa'" onmouseout="this.style.background='white'">
                            üîç Í¥ÄÎ†® Î≤ïÎ†π Í≤ÄÏÉâ
                        </button>
                    </div>
                </div>
            `;
        }
        
        // Î∂ÄÏ≤òÎ™Ö Ï∂îÏ∂ú Ìï®Ïàò
        function getMinistryName(title, categories) {
            if (!title) return 'Í¥ÄÍ≥ÑÎ∂ÄÏ≤ò';
            
            const category = (categories && categories[0]) || '';
            
            // Î≤ïÎ†πÎ™Ö Í∏∞Î∞ò Î∂ÄÏ≤ò Îß§Ìïë
            if (title.includes('Í∑ºÎ°úÍ∏∞Ï§ÄÎ≤ï') || title.includes('ÏµúÏ†ÄÏûÑÍ∏àÎ≤ï') || title.includes('ÏÇ∞ÏóÖÏïàÏ†ÑÎ≥¥Í±¥Î≤ï')) {
                return 'Í≥†Ïö©ÎÖ∏ÎèôÎ∂Ä';
            } else if (title.includes('Í∞úÏù∏Ï†ïÎ≥¥Î≥¥Ìò∏Î≤ï') || title.includes('Ï†ïÎ≥¥ÌÜµÏã†')) {
                return 'Í∞úÏù∏Ï†ïÎ≥¥Î≥¥Ìò∏ÏúÑÏõêÌöå';
            } else if (title.includes('Í≥µÏ†ïÍ±∞ÎûòÎ≤ï') || title.includes('ÎèÖÏ†êÍ∑úÏ†ú')) {
                return 'Í≥µÏ†ïÍ±∞ÎûòÏúÑÏõêÌöå';
            } else if (title.includes('ÌôòÍ≤Ω') || title.includes('ÎåÄÍ∏∞') || title.includes('ÌèêÍ∏∞Î¨º')) {
                return 'ÌôòÍ≤ΩÎ∂Ä';
            } else if (title.includes('ÏÉÅÎ≤ï') || title.includes('Ï£ºÏãùÌöåÏÇ¨')) {
                return 'Î≤ïÎ¨¥Î∂Ä';
            } else if (title.includes('Î≤ïÏù∏ÏÑ∏') || title.includes('Î∂ÄÍ∞ÄÍ∞ÄÏπòÏÑ∏')) {
                return 'Í∏∞ÌöçÏû¨Ï†ïÎ∂Ä';
            } else if (title.includes('ÌäπÌóà') || title.includes('ÏÉÅÌëú') || title.includes('Ï†ÄÏûëÍ∂å')) {
                return 'ÌäπÌóàÏ≤≠';
            }
            
            // Ïπ¥ÌÖåÍ≥†Î¶¨ Í∏∞Î∞ò Î∂ÄÏ≤ò Îß§Ìïë
            const ministryMap = {
                'Ïù∏ÏÇ¨ÎÖ∏Î¨¥': 'Í≥†Ïö©ÎÖ∏ÎèôÎ∂Ä',
                'Ï†ïÎ≥¥Î≥¥Ìò∏': 'Í∞úÏù∏Ï†ïÎ≥¥Î≥¥Ìò∏ÏúÑÏõêÌöå',
                'Í≥µÏ†ïÍ±∞Îûò': 'Í≥µÏ†ïÍ±∞ÎûòÏúÑÏõêÌöå',
                'ÏïàÏ†Ñ': 'Í≥†Ïö©ÎÖ∏ÎèôÎ∂Ä',
                'ÌôòÍ≤Ω': 'ÌôòÍ≤ΩÎ∂Ä',
                'ÏßÄÎ∞∞Íµ¨Ï°∞': 'Î≤ïÎ¨¥Î∂Ä',
                'Ïû¨Î¨¥ÌöåÍ≥Ñ': 'Í∏∞ÌöçÏû¨Ï†ïÎ∂Ä',
                'ÏßÄÏãùÏû¨ÏÇ∞Í∂å': 'ÌäπÌóàÏ≤≠'
            };
            
            return ministryMap[category] || 'Í¥ÄÍ≥ÑÎ∂ÄÏ≤ò';
        }
        
        // ÌÜµÌï©Îêú Í∞úÏ†ïÏú†Ìòï Ï∂îÏ∂ú Ìï®Ïàò - Ïã§Ï†ú Îç∞Ïù¥ÌÑ∞ÏóêÏÑú ÏùΩÏñ¥Ïò¥
        function getDetailedLawType(item) {
            // itemÏù¥ Í∞ùÏ≤¥Ïù∏ Í≤ΩÏö∞ amendmentsÏóêÏÑú amendmentTypeÏùÑ ÏùΩÏùå
            if (typeof item === 'object' && item !== null) {
                if (item.amendments && item.amendments.length > 0 && item.amendments[0].amendmentType) {
                    return item.amendments[0].amendmentType;
                }
                // ÎßåÏïΩ item.lawTypeÏù¥ ÏûàÎã§Î©¥ Í∑∏Í≤ÉÏùÑ ÏÇ¨Ïö©
                if (item.lawType) {
                    return item.lawType;
                }
            }
            
            // itemÏù¥ Î¨∏ÏûêÏó¥Ïù¥Í±∞ÎÇò Îã§Î•∏ Í≤ΩÏö∞ (ÌïòÏúÑ Ìò∏ÌôòÏÑ±)
            // Ïù¥ Í≤ΩÏö∞Îäî Ï†êÏßÑÏ†ÅÏúºÎ°ú Ï†úÍ±∞Îê† ÏòàÏ†ï
            if (typeof item === 'string') {
                // Í∏∞Ï°¥ Î°úÏßÅÏùÑ Ìè¥Î∞±ÏúºÎ°ú Ïú†ÏßÄ (ÌïòÏúÑ Ìò∏ÌôòÏÑ±)
                const title = item;
                if (title.includes('ÏãúÌñâÎ†π')) {
                    return 'ÏùºÎ∂ÄÍ∞úÏ†ï';
                } else if (title.includes('ÏãúÌñâÍ∑úÏπô')) {
                    return 'ÏùºÎ∂ÄÍ∞úÏ†ï';
                } else if (title.includes('Í∑úÏ†ï') || title.includes('Í∑úÏπô')) {
                    return 'ÏùºÎ∂ÄÍ∞úÏ†ï';
                } else if (title.includes('Í≥†Ïãú')) {
                    return 'ÏùºÎ∂ÄÍ∞úÏ†ï';
                } else if (title.includes('ÏßÄÏπ®') || title.includes('Í∏∞Ï§Ä')) {
                    return 'ÏùºÎ∂ÄÍ∞úÏ†ï';
                } else if (title.includes('Î≤ï') && !title.includes('ÏãúÌñâ')) {
                    return 'ÏùºÎ∂ÄÍ∞úÏ†ï';
                }
            }
            
            // Í∏∞Î≥∏Í∞í
            return 'ÏùºÎ∂ÄÍ∞úÏ†ï';
        }

        function showLawModal(lawId) {
            const law = lawsData.find(l => l.id === lawId);
            if (!law) {
                console.error('Î≤ïÎ†πÏùÑ Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§:', lawId);
                return;
            }

            // Create modal backdrop
            const modalBackdrop = document.createElement('div');
            modalBackdrop.className = 'modal-backdrop';
            modalBackdrop.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.6);
                backdrop-filter: blur(10px);
                z-index: 9999;
                display: flex;
                align-items: center;
                justify-content: center;
                padding: 1rem;
                animation: fadeIn 0.3s ease;
            `;

            // Create modal content
            const modalContent = document.createElement('div');
            modalContent.className = 'modal-content';
            modalContent.style.cssText = `
                background: var(--bg-card, #ffffff);
                backdrop-filter: blur(20px);
                border: 1px solid var(--glass-border, rgba(255, 255, 255, 0.2));
                border-radius: 20px;
                max-width: 700px;
                width: 90%;
                max-height: 85vh;
                overflow-y: auto;
                box-shadow: var(--glass-shadow, 0 8px 32px 0 rgba(31, 38, 135, 0.37));
                animation: slideIn 0.3s ease;
                position: relative;
                color: var(--text-primary, #1a202c);
            `;

            // Î™®Î∞îÏùº Î≤ÑÏ†ÑÍ≥º ÎèôÏùºÌïú AI ÏöîÏïΩ ÏÇ¨Ïö©
            const summaryHtml = generateAISummary(law);
            
            modalContent.innerHTML = `
                <div style="padding: 2rem;">
                    <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 1.5rem;">
                        <div>
                            <h2 style="color: var(--text-primary); font-size: 1.5rem; font-weight: 700; margin: 0 0 0.5rem 0; line-height: 1.4;">
                                ${law.title}
                            </h2>
                        </div>
                        <button onclick="closeLawModal()" style="background: none; border: none; font-size: 1.5rem; color: var(--text-muted); cursor: pointer; padding: 0.5rem; border-radius: 50%; transition: all 0.2s ease;" onmouseover="this.style.background='var(--bg-secondary)'" onmouseout="this.style.background='none'">√ó</button>
                    </div>
                    ${summaryHtml}
                </div>
            `;

            modalBackdrop.appendChild(modalContent);
            document.body.appendChild(modalBackdrop);

            // Close modal when clicking backdrop
            modalBackdrop.addEventListener('click', function(e) {
                if (e.target === modalBackdrop) {
                    closeLawModal();
                }
            });

            // Close modal with ESC key
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    closeLawModal();
                }
            });

            // Store reference for closing
            window.currentModal = modalBackdrop;
        }

        function closeLawModal() {
            if (window.currentModal) {
                window.currentModal.style.animation = 'fadeOut 0.3s ease';
                setTimeout(() => {
                    if (window.currentModal && window.currentModal.parentNode) {
                        window.currentModal.parentNode.removeChild(window.currentModal);
                    }
                    window.currentModal = null;
                }, 300);
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', async function() {
            await loadData();
            initializeFilters();
            initializeSearch();
            updateTodayDate();
            
            // Î≤ïÍ∑ú ÌÅ¥Î¶≠ Ïù¥Î≤§Ìä∏ ÏúÑÏûÑ Ï≤òÎ¶¨ (Î™®Îì† law-itemÏóê ÎåÄÌï¥)
            document.addEventListener('click', function(e) {
                const lawItem = e.target.closest('.law-item[onclick*="showLawDetail"]');
                if (lawItem) {
                    e.preventDefault();
                    const onclickAttr = lawItem.getAttribute('onclick');
                    const match = onclickAttr.match(/showLawDetail\(['"]([^'"]+)['"]\)/);
                    if (match && match[1]) {
                        console.log('üéØ Law item clicked, ID:', match[1]);
                        if (typeof window.showLawDetail === 'function') {
                            window.showLawDetail(match[1]);
                        } else {
                            console.error('‚ùå showLawDetail function not found!');
                        }
                    }
                }
            });
        });
        
        function updateTodayDate() {
            // 2025ÎÖÑ ÏãúÎÆ¨Î†àÏù¥ÏÖòÏùÑ ÏúÑÌïú ÎÇ†Ïßú ÏÑ§Ï†ï
            const today = new Date('2025-09-04');
            const month = today.getMonth() + 1;
            const day = today.getDate();
            const dateElement = document.getElementById('today-date');
            if (dateElement) {
                dateElement.textContent = `(${month}/${day} Í∏∞Ï§Ä)`;
            }
        }


        async function updateLawsWithRealEffectiveDates() {
            try {
                console.log('üìÖ Ïã§Ï†ú ÏãúÌñâÏùºÏûê Îç∞Ïù¥ÌÑ∞ Î°úÎî© Ï§ë...');
                const response = await fetch('./quarterly_details.json');
                if (!response.ok) return;
                
                const quarterlyData = await response.json();
                const realEffectiveDates = {};
                
                // Î™®Îì† Î∂ÑÍ∏∞Ïùò Ïã§Ï†ú ÏãúÌñâÏùºÏûê Îç∞Ïù¥ÌÑ∞ ÏàòÏßë
                Object.values(quarterlyData.quarters).forEach(quarter => {
                    quarter.laws.forEach(law => {
                        if (law.effective_date && law.title) {
                            realEffectiveDates[law.title] = law.effective_date;
                            // ÏãúÌñâÎ†π, ÏãúÌñâÍ∑úÏπô Îì±Ïùò Î≥ÄÌòïÎèÑ Í≥†Î†§
                            const baseTitle = law.title.replace(/\s*(ÏãúÌñâÎ†π|ÏãúÌñâÍ∑úÏπô)\s*$/, '');
                            realEffectiveDates[baseTitle] = law.effective_date;
                        }
                    });
                });
                
                // lawsDataÏùò ÏãúÌñâÏùºÏûê ÏóÖÎç∞Ïù¥Ìä∏
                let updatedCount = 0;
                lawsData.forEach(law => {
                    if (realEffectiveDates[law.title]) {
                        law.effectiveDate = realEffectiveDates[law.title];
                        updatedCount++;
                    } else {
                        // Î∂ÄÎ∂Ñ Îß§Ïπ≠ ÏãúÎèÑ
                        const baseTitle = law.title.replace(/\s*(ÏãúÌñâÎ†π|ÏãúÌñâÍ∑úÏπô)\s*$/, '');
                        if (realEffectiveDates[baseTitle]) {
                            law.effectiveDate = realEffectiveDates[baseTitle];
                            updatedCount++;
                        }
                    }
                });
                
                console.log(`‚úÖ ${updatedCount}Í∞ú Î≤ïÎ†πÏùò Ïã§Ï†ú ÏãúÌñâÏùºÏûê ÏóÖÎç∞Ïù¥Ìä∏ ÏôÑÎ£å`);
                
            } catch (error) {
                console.warn('‚ö†Ô∏è Ïã§Ï†ú ÏãúÌñâÏùºÏûê ÏóÖÎç∞Ïù¥Ìä∏ Ïã§Ìå®:', error);
            }
        }

        async function loadData() {
            try {
                let data;
                
                // 1. index.json Î°úÎìú (Î™®Î∞îÏùºÍ≥º ÎèôÏùºÌïòÍ≤å - ÏÉÅÏÑ∏Ìïú Îç∞Ïù¥ÌÑ∞Í∞Ä ÏûàÏùå)
                const version = new Date().getTime();
                const cacheBuster = Math.random().toString(36).substring(7);
                try {
                    const response = await fetch(`./index.json?v=${version}&cb=${cacheBuster}`, {
                        cache: 'no-store',
                        headers: {
                            'Cache-Control': 'no-cache',
                            'Pragma': 'no-cache'
                        }
                    });
                    if (response.ok) {
                        data = await response.json();
                        console.log('‚úÖ index.json Îç∞Ïù¥ÌÑ∞ Î°úÎìú:', data.items ? data.items.length : 0, 'Í±¥');
                        console.log('üìÑ ÏÉÅÏÑ∏Ìïú Í∞úÏ†ï Ïù¥Ïú†ÏôÄ ÎÇ¥Ïö©Ïù¥ Ìè¨Ìï®Îêú Îç∞Ïù¥ÌÑ∞ ÏÇ¨Ïö©');
                    }
                } catch (e) {
                    console.log('‚ùå index.json Î°úÎìú Ïã§Ìå®:', e);
                }
                
                // 2. localStorageÏóêÏÑú ÏóÖÎç∞Ïù¥Ìä∏Îêú Î≤ïÍ∑ú Îç∞Ïù¥ÌÑ∞ ÌôïÏù∏ (Ìè¥Î∞±)
                if (!data) {
                    const updatedFlag = localStorage.getItem('laws_updated_flag');
                    const updatedData = localStorage.getItem('updated_laws_data');
                    
                    if (updatedFlag === 'true' && updatedData) {
                        console.log('Loading updated laws from localStorage...');
                        try {
                            data = JSON.parse(updatedData);
                            console.log('Updated data loaded:', data.items ? data.items.length : 0, 'Í∞ú');
                        } catch (e) {
                            console.error('Failed to parse localStorage data:', e);
                            data = null;
                        }
                    }
                }
                
                // 3. index.jsonÏùÑ Î™ª Î∂àÎü¨ÏôîÏùÑ ÎïåÎßå matched_index_2025.json ÏÇ¨Ïö© (Ìè¥Î∞±)
                if (!data) {
                    const version2 = new Date().getTime();
                    const cacheBuster2 = Math.random().toString(36).substring(7);
                    console.log('index.json Ïã§Ìå®, matched_index_2025.json ÏãúÎèÑ...');
                    try {
                        const matchedResponse = await fetch(`./matched_index_2025.json?v=${version2}&cb=${cacheBuster2}`, {
                            cache: 'no-store',
                            headers: {
                                'Cache-Control': 'no-cache',
                                'Pragma': 'no-cache'
                            }
                        });
                        if (matchedResponse.ok) {
                            data = await matchedResponse.json();
                            console.log('üìÑ matched_index_2025.json ÏÇ¨Ïö© (ÏÉÅÏÑ∏ ÎÇ¥Ïö© ÏóÜÏùå)');
                        }
                    } catch (e) {
                        console.log('‚ùå matched_index_2025.jsonÎèÑ Ïã§Ìå®');
                    }
                }
                
                if (data.items && Array.isArray(data.items)) {
                    console.log('üìã Îç∞Ïù¥ÌÑ∞ Î°úÎìú ÏôÑÎ£å:', data.items.length, 'Í±¥');
                    lawsData = data.items;
                    window.lawsData = data.items; // Ï†ÑÏó≠ Î≥ÄÏàòÎ°úÎèÑ ÏÑ§Ï†ï
                } else {
                    console.error('‚ùå data.itemsÍ∞Ä Î∞∞Ïó¥Ïù¥ ÏïÑÎãôÎãàÎã§:', data.items);
                    lawsData = [];
                    window.lawsData = [];
                }
                
                filteredLaws = [...lawsData];
                
                
                // Ìó§Îçî Ï†ïÎ≥¥ ÏóÖÎç∞Ïù¥Ìä∏
                document.getElementById('year').textContent = data.year || 2025;
                const date = new Date((data.generatedAt || 0) * 1000);
                document.getElementById('timestamp').textContent = date.toLocaleString('ko-KR');

                // Ïã§Ï†ú 2025ÎÖÑ ÏãúÌñâÏùºÏûê Îç∞Ïù¥ÌÑ∞Î•º Î≥ëÌï© - Ï§ëÎ≥µ Î¨∏Ï†úÎ°ú ÎπÑÌôúÏÑ±Ìôî
                // await updateLawsWithRealEffectiveDates();
                
                displayLawList(filteredLaws);
                updateTabCounts();
                updateQuarterlyCounts();
                updateJobFunctionCounts();
                
                // Ïã§Ï†ú 276Í±¥ Îß§Ïπ≠ Îç∞Ïù¥ÌÑ∞Î°ú ÏóÖÎç∞Ïù¥Ìä∏
                updateQuarterlyDataWithFinalPrecise(); // Î∂ÑÍ∏∞Î≥Ñ Îç∞Ïù¥ÌÑ∞ ÏóÖÎç∞Ïù¥Ìä∏
                updateJobFunctionDataWithCompanyLaws();
                updateMainDashboardWithCompanyLaws();
                
                // Ï†ïÌôïÌïú Î≤ïÎ†π ÏÉÅÏÑ∏ Îç∞Ïù¥ÌÑ∞ Î°úÎìú
                // 66Í∞ú ÏïΩÏπ≠ Îß§Ïπ≠ Îç∞Ïù¥ÌÑ∞Î•º ÏÇ¨Ïö©ÌïòÏó¨ Îã®ÏàúÌôî
                
                // Ï†ÑÏ≤¥ Î≤ïÍ∑ú Í∞úÏàò ÏóÖÎç∞Ïù¥Ìä∏ (276Í±¥ Îß§Ïπ≠ Îç∞Ïù¥ÌÑ∞)
                const totalLawCountElement = document.getElementById('total-law-count');
                if (totalLawCountElement) {
                    totalLawCountElement.textContent = matched2025LawData.total_laws; // 276Í±¥
                }
                
                // 2025ÎÖÑ Î≤ïÍ∑ú Î∂ÑÎ•ò Î∞è Í∞úÏàò ÏóÖÎç∞Ïù¥Ìä∏
                const currentDate = new Date('2025-08-26'); // ÌòÑÏû¨ ÎÇ†Ïßú
                const currentDateStr = '2025-08-26';
                
                // 276Í∞ú Îß§Ïπ≠ Î≤ïÍ∑ú Í∏∞Ï§ÄÏúºÎ°ú ÏãúÌñâÏôÑÎ£å/ÏãúÌñâÏòàÏ†ï Í≥ÑÏÇ∞
                // quarterly_details.jsonÏóêÏÑú Ïã§Ï†ú 276Í∞ú Îç∞Ïù¥ÌÑ∞Î•º Í∞ÄÏ†∏ÏôÄÏÑú Í≥ÑÏÇ∞
                fetch('quarterly_details.json')
                    .then(response => response.json())
                    .then(quarterlyData => {
                        // Î™®Îì† Î∂ÑÍ∏∞Ïùò Î≤ïÍ∑úÎ•º ÌïòÎÇòÎ°ú Ìï©Ïπ® ÎòêÎäî items ÏÇ¨Ïö©
                        let allMatchedLaws = quarterlyData.items || [];
                        if (allMatchedLaws.length === 0) {
                            // itemsÍ∞Ä ÏóÜÏúºÎ©¥ quartersÏóêÏÑú Ï∂îÏ∂ú
                            Object.values(quarterlyData.quarters || {}).forEach(quarter => {
                                allMatchedLaws = allMatchedLaws.concat(quarter.laws || []);
                            });
                        }
                        
                        console.log('üìä Îß§Ïπ≠ Î≤ïÍ∑ú Î°úÎìú ÏôÑÎ£å:', allMatchedLaws.length, 'Í∞ú');
                        
                        // ÏãúÌñâ ÏôÑÎ£å/ÏòàÏ†ï ÌòÑÌô© ÎèôÏ†Å Í≥ÑÏÇ∞
                        const today = new Date('2025-09-04'); // 2025ÎÖÑ ÏãúÎÆ¨Î†àÏù¥ÏÖò
                        let implementedCount = 0;
                        let pendingCount = 0;
                        
                        if (lawsData && lawsData.length > 0) {
                            lawsData.forEach(law => {
                                const effectiveDate = new Date(law.effectiveDate);
                                if (effectiveDate <= today) {
                                    implementedCount++;
                                } else {
                                    pendingCount++;
                                }
                            });
                        }
                        
                        const implementedLawCountElement = document.getElementById('implemented-law-count');
                        if (implementedLawCountElement) {
                            implementedLawCountElement.textContent = implementedCount;
                            console.log('‚úÖ ÏãúÌñâÏôÑÎ£å (9/4 Í∏∞Ï§Ä):', implementedCount);
                        }
                        
                        const amendmentLawCountElement = document.getElementById('amendment-law-count');
                        if (amendmentLawCountElement) {
                            amendmentLawCountElement.textContent = pendingCount;
                            console.log('‚úÖ ÏãúÌñâÏòàÏ†ï (9Ïõî Ïù¥ÌõÑ):', pendingCount);
                        }
                    })
                    .catch(error => {
                        console.error('‚ùå Îß§Ïπ≠ Îç∞Ïù¥ÌÑ∞ Î°úÎìú Ïã§Ìå®:', error);
                        // Ìè¥Î∞±: lawsDataÎ•º ÏÇ¨Ïö©ÌïòÏó¨ ÎèôÏ†Å Í≥ÑÏÇ∞
                        const today = new Date('2025-09-04');
                        let implementedCount = 0;
                        let pendingCount = 0;
                        
                        if (lawsData && lawsData.length > 0) {
                            lawsData.forEach(law => {
                                const effectiveDate = new Date(law.effectiveDate);
                                if (effectiveDate <= today) {
                                    implementedCount++;
                                } else {
                                    pendingCount++;
                                }
                            });
                        }
                        
                        const implementedLawCountElement = document.getElementById('implemented-law-count');
                        if (implementedLawCountElement) {
                            implementedLawCountElement.textContent = implementedCount;
                        }
                        
                        const amendmentLawCountElement = document.getElementById('amendment-law-count');
                        if (amendmentLawCountElement) {
                            amendmentLawCountElement.textContent = pendingCount;
                        }
                    });
                
                // Chart.jsÍ∞Ä Î°úÎî©Îêú ÌõÑ Ï∞®Ìä∏ ÏÉùÏÑ±
                setTimeout(() => {
                    if (typeof Chart !== 'undefined') {
                        createCategoryChart();
                    } else {
                        console.log('Chart.jsÎ•º ÏÇ¨Ïö©Ìï† Ïàò ÏóÜÏñ¥ Ï∞®Ìä∏ ÏÉùÏÑ±ÏùÑ Í±¥ÎÑàÎúÅÎãàÎã§.');
                    }
                }, 500);
                
                console.log('‚úÖ Îç∞Ïù¥ÌÑ∞ ÌëúÏãú ÏôÑÎ£å');
            } catch (error) {
                console.error('‚ùå Îç∞Ïù¥ÌÑ∞ Î°úÎî© Ïã§Ìå®:', error);
                // Î™®Î∞îÏùºÏóêÏÑú Îçî ÏûêÏÑ∏Ìïú ÏóêÎü¨ ÌëúÏãú
                const userAgent = navigator.userAgent;
                const errorDetails = `
                    <div style="text-align: left; padding: 20px;">
                        <h3>Îç∞Ïù¥ÌÑ∞ Î°úÎî© Ïò§Î•ò</h3>
                        <p>Ïò§Î•ò: ${error.message}</p>
                        <p>URL: ${window.location.href}</p>
                        <p>Í∏∞Í∏∞: ${userAgent.includes('Mobile') ? 'Mobile' : 'Desktop'}</p>
                        <p>Î∏åÎùºÏö∞Ï†Ä: ${userAgent}</p>
                        <hr>
                        <p>Ìï¥Í≤∞ Î∞©Î≤ï:</p>
                        <ul>
                            <li>ÌéòÏù¥ÏßÄÎ•º ÏÉàÎ°úÍ≥†Ïπ® Ìï¥Î≥¥ÏÑ∏Ïöî</li>
                            <li>Î∏åÎùºÏö∞Ï†Ä Ï∫êÏãúÎ•º ÏÇ≠Ï†úÌï¥Î≥¥ÏÑ∏Ïöî</li>
                            <li>Îã§Î•∏ Î∏åÎùºÏö∞Ï†ÄÎ•º ÏÇ¨Ïö©Ìï¥Î≥¥ÏÑ∏Ïöî</li>
                        </ul>
                    </div>
                `;
                showError(errorDetails);
            }
        }

        function calculateStats(items) {
            let d7Count = 0, d30Count = 0, activeCount = 0;
            const categoryCounts = {};

            items.forEach(item => {
                const daysUntil = getDaysFromNow(item.effectiveDate);
                
                if (daysUntil <= 7 && daysUntil > 0) d7Count++;
                else if (daysUntil <= 30 && daysUntil > 0) d30Count++;
                else if (daysUntil <= 0) activeCount++;

                // Ïπ¥ÌÖåÍ≥†Î¶¨Î≥Ñ ÏßëÍ≥Ñ
                if (item.categories) {
                    item.categories.forEach(category => {
                        categoryCounts[category] = (categoryCounts[category] || 0) + 1;
                    });
                }
            });

            return {
                total: items.length,
                d7: d7Count,
                d30: d30Count,
                active: activeCount,
                categories: categoryCounts
            };
        }

        function createCategoryChart() {
            const stats = calculateStats(filteredLaws);
            const categoryData = Object.entries(stats.categories)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 7);

            const ctx = document.getElementById('categoryChart').getContext('2d');
            
            if (categoryChart) {
                categoryChart.destroy();
            }

            categoryChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: categoryData.map(([category]) => category),
                    datasets: [{
                        data: categoryData.map(([, count]) => count),
                        backgroundColor: categoryData.map(([category]) => categoryColors[category] || '#a0aec0'),
                        borderWidth: 0,
                        hoverOffset: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    cutout: '60%',
                    animation: {
                        animateRotate: true,
                        duration: 1000
                    }
                }
            });

            // Update legend
            updateCategoryLegend(categoryData);
        }

        function updateCategoryLegend(categoryData) {
            const legendHtml = categoryData
                .map(([category, count]) => {
                    const color = categoryColors[category] || categoryColors['Í∏∞ÌÉÄ'];
                    const icons = {
                        'ÏïàÏ†Ñ': 'üõ°Ô∏è',
                        'ÌôòÍ≤Ω': 'üå±',
                        'Ïù∏ÏÇ¨ÎÖ∏Î¨¥': 'üë•',
                        'ÏßÄÎ∞∞Íµ¨Ï°∞': 'üèõÔ∏è', 
                        'Ïû¨Î¨¥ÌöåÍ≥Ñ': 'üí∞',
                        'Ï†ïÎ≥¥Î≥¥Ìò∏': 'üîí',
                        'Í∏∞ÌÉÄ': 'üìã'
                    };
                    return `
                        <div class="legend-item">
                            <div class="legend-dot" style="background: ${color};"></div>
                            <div class="legend-text">${category} (${count})</div>
                        </div>
                    `;
                }).join('');

            document.getElementById('categoryLegend').innerHTML = legendHtml || '<div style="color: var(--text-muted); text-align: center;">Îç∞Ïù¥ÌÑ∞ ÏóÜÏùå</div>';
        }

        function initializeFilters() {
            const filterTabs = document.querySelectorAll('.filter-tab');
            
            filterTabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    // Update active tab
                    filterTabs.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Filter laws
                    currentFilter = this.dataset.filter;
                    filterLaws();
                });
            });
        }
        
        function updateTabCounts() {
            console.log('üìä Updating tab counts...');
            
            // Update total count
            const totalCount = lawsData.length;
            const allCountElement = document.getElementById('count-all');
            if (allCountElement) {
                allCountElement.textContent = totalCount;
            }
            
            // Update category counts
            const categories = ['Ïù∏ÏÇ¨ÎÖ∏Î¨¥', 'Í≥µÏ†ïÍ±∞Îûò', 'Ï†ïÎ≥¥Î≥¥Ìò∏', 'ÏßÄÏãùÏû¨ÏÇ∞Í∂å', 'Ïû¨Î¨¥ÌöåÍ≥Ñ', 'ÏïàÏ†Ñ', 'ÌôòÍ≤Ω', 'ÏßÄÎ∞∞Íµ¨Ï°∞'];
            
            categories.forEach(category => {
                const count = lawsData.filter(law => 
                    law.categories && law.categories.includes(category)
                ).length;
                
                const countElement = document.getElementById(`count-${category}`);
                if (countElement) {
                    countElement.textContent = count;
                }
            });
            
            console.log('‚úÖ Tab counts updated');
        }

        function updateQuarterlyCounts() {
            const quarters = {
                'Q1': { months: [1, 2, 3], count: 0 },
                'Q2': { months: [4, 5, 6], count: 0 },
                'Q3': { months: [7, 8, 9], count: 0 },
                'Q4': { months: [10, 11, 12], count: 0 }
            };
            
            // Only count laws with 2025 effective dates to match summary statistics
            lawsData.forEach(law => {
                if (law.effectiveDate && law.effectiveDate.startsWith('2025')) {
                    const date = new Date(law.effectiveDate);
                    const month = date.getMonth() + 1;
                    
                    Object.keys(quarters).forEach(quarter => {
                        if (quarters[quarter].months.includes(month)) {
                            quarters[quarter].count++;
                        }
                    });
                }
            });
            
            // Update UI
            document.getElementById('q1-count').textContent = quarters.Q1.count;
            document.getElementById('q2-count').textContent = quarters.Q2.count;
            document.getElementById('q3-count').textContent = quarters.Q3.count;
            document.getElementById('q4-count').textContent = quarters.Q4.count;
        }

        function filterLaws() {
            console.log('üîç Filtering laws for:', currentFilter);
            if (currentFilter === 'all') {
                filteredLaws = [...lawsData];
            } else {
                filteredLaws = lawsData.filter(law => 
                    law.categories && law.categories.includes(currentFilter)
                );
            }
            console.log(`‚úÖ Filtered ${filteredLaws.length} laws for ${currentFilter}`);
            displayLawList(filteredLaws);
            setTimeout(() => {
                if (typeof Chart !== 'undefined') {
                    createCategoryChart();
                }
            }, 100);
        }

        function initializeSearch() {
            const searchInput = document.getElementById('searchInput');
            searchInput.addEventListener('keyup', function(e) {
                if (e.key === 'Enter') {
                    searchLaws();
                }
            });
        }

        function searchLaws() {
            const query = document.getElementById('searchInput').value.trim().toLowerCase();
            
            if (!query) {
                filteredLaws = [...lawsData];
                displayLawList(filteredLaws);
                return;
            }
            
            filteredLaws = lawsData.filter(item => {
                const title = (item.title || '').toLowerCase();
                const ministry = (item.meta?.ministry || '').toLowerCase();
                const categories = (item.categories || []).join(' ').toLowerCase();
                
                return title.includes(query) || 
                       ministry.includes(query) || 
                       categories.includes(query);
            });
            
            displayLawList(filteredLaws);
            setTimeout(() => {
                if (typeof Chart !== 'undefined') {
                    createCategoryChart();
                }
            }, 100);
        }

        function displayLawList(items) {
            console.log(`üìã Displaying ${items.length} laws`);
            
            const sortedItems = items
                .sort((a, b) => {
                    // Î≤ïÎ†πÎ™Ö Í∞ÄÎÇòÎã§Ïàú Ï†ïÎ†¨
                    const titleCompare = a.title.localeCompare(b.title, 'ko-KR');
                    if (titleCompare !== 0) return titleCompare;
                    
                    // Í∞ôÏùÄ Î≤ïÎ†πÎ™ÖÏù¥Î©¥ ÏãúÌñâÏùºÏûêÏàú
                    const dateA = a.effectiveDate || '1900-01-01';
                    const dateB = b.effectiveDate || '1900-01-01';
                    return dateA.localeCompare(dateB);
                });

            // Show all items, not just first 100
            const displayItems = sortedItems;
            
            document.getElementById('law-count').textContent = `${items.length.toLocaleString()}Í±¥`;

            if (displayItems.length === 0) {
                document.getElementById('law-list').innerHTML = '<div class="error">Ìï¥Îãπ Ï°∞Í±¥Ïùò Î≤ïÎ†πÏù¥ ÏóÜÏäµÎãàÎã§.</div>';
                return;
            }

            const lawListHtml = displayItems.map(item => {
                const daysUntil = getDaysFromNow(item.effectiveDate);
                let dateClass = 'active';
                let dateText = item.effectiveDate || 'ÎØ∏Ï†ï';
                
                if (daysUntil > 0) {
                    if (daysUntil <= 7) {
                        dateClass = 'urgent';
                        dateText = `D-${daysUntil}`;
                    } else if (daysUntil <= 30) {
                        dateClass = 'soon';
                        dateText = `D-${daysUntil}`;
                    } else {
                        dateClass = 'soon';
                        dateText = item.effectiveDate || 'ÎØ∏Ï†ï';
                    }
                }



                return `
                    <div class="law-item">
                        <div class="law-item-header">
                            <div class="law-title" onclick="window.showLawDetail('${item.id}')">${item.title || 'Ï†úÎ™© ÏóÜÏùå'}</div>
                            <div class="date-badge ${dateClass}">${dateText}</div>
                        </div>
                        <div class="law-meta">
                            <div class="meta-item">
                                <span>üèõÔ∏è</span>
                                <span>${item.ministry || getMinistryName(item.title, item.categories) || 'Í¥ÄÍ≥ÑÎ∂ÄÏ≤ò'}</span>
                            </div>
                            <div class="meta-item">
                                <span>üìÑ</span>
                                <span>${getDetailedLawType(item) || 'ÏùºÎ∂ÄÍ∞úÏ†ï'}</span>
                            </div>
                        </div>

                    </div>
                `;
            }).join('');

            document.getElementById('law-list').innerHTML = lawListHtml;
        }

        function getCategoryClass(category) {
            const classMap = {
                'Ïù∏ÏÇ¨ÎÖ∏Î¨¥': 'hr',
                'Í≥µÏ†ïÍ±∞Îûò': 'fair',
                'Ï†ïÎ≥¥Î≥¥Ìò∏': 'sec',
                'ÏßÄÏãùÏû¨ÏÇ∞Í∂å': 'ip',
                'Ïû¨Î¨¥ÌöåÍ≥Ñ': 'fin',
                'ÏïàÏ†Ñ': 'safety',
                'ÌôòÍ≤Ω': 'env',
                'ÏßÄÎ∞∞Íµ¨Ï°∞': 'gov'
            };
            return classMap[category] || 'etc';
        }
        
        // Î≤ïÎ†πÎ™ÖÍ≥º Ïπ¥ÌÖåÍ≥†Î¶¨ Í∏∞Î∞òÏúºÎ°ú Íµ¨Ï≤¥Ï†ÅÏù∏ Í¥ÄÍ≥ÑÎ∂ÄÏ≤ò Î∞òÌôò
        function getMinistryName(title, categories) {
            if (!title) return 'Í¥ÄÍ≥ÑÎ∂ÄÏ≤ò';
            
            const category = (categories && categories[0]) || '';
            
            // Î≤ïÎ†πÎ™Ö Í∏∞Î∞ò Î∂ÄÏ≤ò Îß§Ìïë
            if (title.includes('Í∑ºÎ°úÍ∏∞Ï§ÄÎ≤ï') || title.includes('ÏµúÏ†ÄÏûÑÍ∏àÎ≤ï') || title.includes('ÌååÍ≤¨Í∑ºÎ°úÏûê') || title.includes('Í≥†Ïö©Î≥¥ÌóòÎ≤ï')) {
                return 'Í≥†Ïö©ÎÖ∏ÎèôÎ∂Ä';
            } else if (title.includes('Í∞úÏù∏Ï†ïÎ≥¥Î≥¥Ìò∏Î≤ï') || title.includes('Ï†ïÎ≥¥ÌÜµÏã†')) {
                return 'Í∞úÏù∏Ï†ïÎ≥¥Î≥¥Ìò∏ÏúÑÏõêÌöå';
            } else if (title.includes('Í≥µÏ†ïÍ±∞ÎûòÎ≤ï') || title.includes('ÎèÖÏ†êÍ∑úÏ†ú')) {
                return 'Í≥µÏ†ïÍ±∞ÎûòÏúÑÏõêÌöå';
            } else if (title.includes('ÏÇ∞ÏóÖÏïàÏ†ÑÎ≥¥Í±¥Î≤ï') || title.includes('Ï§ëÎåÄÏû¨Ìï¥')) {
                return 'Í≥†Ïö©ÎÖ∏ÎèôÎ∂Ä';
            } else if (title.includes('ÌôòÍ≤ΩÏòÅÌñ•ÌèâÍ∞ÄÎ≤ï') || title.includes('ÎåÄÍ∏∞ÌôòÍ≤ΩÎ≥¥Ï†ÑÎ≤ï') || title.includes('ÌèêÍ∏∞Î¨ºÍ¥ÄÎ¶¨Î≤ï')) {
                return 'ÌôòÍ≤ΩÎ∂Ä';
            } else if (title.includes('ÏÉÅÎ≤ï') || title.includes('Ï£ºÏãùÌöåÏÇ¨')) {
                return 'Î≤ïÎ¨¥Î∂Ä';
            } else if (title.includes('Î≤ïÏù∏ÏÑ∏Î≤ï') || title.includes('Î∂ÄÍ∞ÄÍ∞ÄÏπòÏÑ∏Î≤ï')) {
                return 'Í∏∞ÌöçÏû¨Ï†ïÎ∂Ä';
            } else if (title.includes('ÌäπÌóàÎ≤ï') || title.includes('ÏÉÅÌëúÎ≤ï') || title.includes('Ï†ÄÏûëÍ∂åÎ≤ï')) {
                return 'ÌäπÌóàÏ≤≠';
            }
            
            // Ïπ¥ÌÖåÍ≥†Î¶¨ Í∏∞Î∞ò Î∂ÄÏ≤ò Îß§Ìïë
            switch(category) {
                case 'Ïù∏ÏÇ¨ÎÖ∏Î¨¥': return 'Í≥†Ïö©ÎÖ∏ÎèôÎ∂Ä';
                case 'Ï†ïÎ≥¥Î≥¥Ìò∏': return 'Í∞úÏù∏Ï†ïÎ≥¥Î≥¥Ìò∏ÏúÑÏõêÌöå';
                case 'Í≥µÏ†ïÍ±∞Îûò': return 'Í≥µÏ†ïÍ±∞ÎûòÏúÑÏõêÌöå';
                case 'ÏïàÏ†Ñ': return 'Í≥†Ïö©ÎÖ∏ÎèôÎ∂Ä';
                case 'ÌôòÍ≤Ω': return 'ÌôòÍ≤ΩÎ∂Ä';
                case 'ÏßÄÎ∞∞Íµ¨Ï°∞': return 'Î≤ïÎ¨¥Î∂Ä';
                case 'Ïû¨Î¨¥ÌöåÍ≥Ñ': return 'Í∏∞ÌöçÏû¨Ï†ïÎ∂Ä';
                case 'ÏßÄÏãùÏû¨ÏÇ∞Í∂å': return 'ÌäπÌóàÏ≤≠';
                default: return 'Í¥ÄÍ≥ÑÎ∂ÄÏ≤ò';
            }
        }
        
        // Ïù¥ Ìï®ÏàòÎäî ÏúÑÏóêÏÑú Ïù¥ÎØ∏ Ï†ïÏùòÎê® (Ï§ëÎ≥µ Ï†úÍ±∞)
        // getDetailedLawType Ìï®ÏàòÎäî 3315ÌñâÏóêÏÑú ÌÜµÌï© Î≤ÑÏ†ÑÏúºÎ°ú Ï†ïÏùòÎêòÏñ¥ ÏûàÏùå

        // Ï†ÑÏó≠ Ìï®ÏàòÎ°ú ÏÑ§Ï†ïÌïòÏó¨ ÌÅ¥Î¶≠ Ïù¥Î≤§Ìä∏Í∞Ä Ìï≠ÏÉÅ ÏûëÎèôÌïòÎèÑÎ°ù Î≥¥Ïû•
        window.showLawDetail = function showLawDetail(lawId) {
            console.log('üîç showLawDetail called with lawId:', lawId);
            
            // lawsDataÍ∞Ä ÏóÜÏúºÎ©¥ window.lawsData ÏÇ¨Ïö©
            const dataSource = window.lawsData || lawsData;
            console.log('üìÅ dataSource length:', dataSource ? dataSource.length : 'undefined');
            
            if (!dataSource || dataSource.length === 0) {
                console.error('‚ö†Ô∏è Data is empty or undefined!');
                alert('Î≤ïÎ†π Îç∞Ïù¥ÌÑ∞Î•º Î°úÎìúÌïòÎäî Ï§ëÏûÖÎãàÎã§. Ïû†Ïãú ÌõÑ Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }
            
            const item = dataSource.find(law => law.id === lawId);
            if (!item) {
                console.error('‚ùå Law not found with id:', lawId);
                console.log('üîç Available IDs:', dataSource.slice(0, 5).map(l => l.id));
                return;
            }
            console.log('‚úÖ Found law item:', item);

            document.getElementById('modal-title').textContent = item.title || 'Î≤ïÎ†π Ï†úÎ™©';
            document.getElementById('modal-subtitle').textContent = 
                `${item.ministry || getMinistryName(item.title, item.categories) || 'Í¥ÄÍ≥ÑÎ∂ÄÏ≤ò'} ‚Ä¢ ${getDetailedLawType(item.title, item.lawType) || 'ÏùºÎ∂ÄÍ∞úÏ†ï'} ‚Ä¢ ${item.effectiveDate || 'ÎØ∏Ï†ï'}`;

            generateAISummary(item);
            document.getElementById('law-modal').classList.add('show');
        }

        function generateAISummary(item) {
            const amendmentReason = generateAmendmentReason(item);
            const amendmentContent = generateAmendmentContent(item);
            const amendmentArticles = generateAmendmentArticles(item);
            
            const summaryHtml = `
                <div class="summary-section">
                    <h4>üìã Í∞úÏ†ï Í∞úÏöî</h4>
                    <p><strong>Î≤ïÎ†πÎ™Ö:</strong> ${item.title}</p>
                    <p><strong>Í∞úÏ†ï Ïú†Ìòï:</strong> ${getDetailedLawType(item.title, item.lawType) || 'ÏùºÎ∂ÄÍ∞úÏ†ï'}</p>
                    <p><strong>ÏãúÌñâ ÏãúÍ∏∞:</strong> ${item.effectiveDate || 'ÎØ∏Ï†ï'}</p>
                    <p><strong>Ï£ºÎ¨¥ Î∂ÄÏ≤ò:</strong> ${item.ministry || getMinistryName(item.title, item.categories) || 'Í¥ÄÍ≥ÑÎ∂ÄÏ≤ò'}</p>
                </div>
                
                <div class="summary-section">
                    <h4>üìù Í∞úÏ†ï Ïù¥Ïú†</h4>
                    <div class="amendment-box">
                        ${amendmentReason}
                    </div>
                </div>
                
                <div class="summary-section">
                    <h4>üìÑ Í∞úÏ†ï ÎÇ¥Ïö©</h4>
                    <div class="amendment-box">
                        ${amendmentContent}
                    </div>
                </div>
                
                <div class="summary-section">
                    <h4>‚öñÔ∏è Ï£ºÏöî Í∞úÏ†ï Ï°∞Ìï≠</h4>
                    <div class="amendment-box">
                        ${amendmentArticles}
                    </div>
                </div>
                
                <div class="summary-section">
                    <h4>üîó Í¥ÄÎ†® ÎßÅÌÅ¨</h4>
                    <div class="external-links">
                        <a href="https://www.law.go.kr/lsSc.do?query=${encodeURIComponent(item.title)}&ancYd=&ancNo=&efYd=&nwJoYnInfo=Y&searchPutTyp=&efGubun=Y&chrClsCd=010202&sortSeq=desc" target="_blank" class="external-link law-link">
                            <div class="link-icon">üìú</div>
                            <div class="link-content">
                                <div class="link-title">Î≤ïÎ†π ÏõêÎ¨∏ Î≥¥Í∏∞</div>
                                <div class="link-desc">Íµ≠Í∞ÄÎ≤ïÎ†πÏ†ïÎ≥¥ÏÑºÌÑ∞ÏóêÏÑú ÌôïÏù∏</div>
                            </div>
                            <div class="link-arrow">‚Üí</div>
                        </a>
                        <a href="https://www.law.go.kr/lsSc.do?query=${encodeURIComponent(item.title.replace('ÏãúÌñâÎ†π', '').replace('ÏãúÌñâÍ∑úÏπô', '').trim())}" target="_blank" class="external-link search-link">
                            <div class="link-icon">üîç</div>
                            <div class="link-content">
                                <div class="link-title">Í¥ÄÎ†® Î≤ïÎ†π Í≤ÄÏÉâ</div>
                                <div class="link-desc">Í¥ÄÎ†® Î≤ïÎ•†/ÏãúÌñâÎ†π/Í∑úÏπô Í≤ÄÏÉâ</div>
                            </div>
                            <div class="link-arrow">‚Üí</div>
                        </a>
                    </div>
                </div>
            `;

            document.getElementById('modal-summary').innerHTML = summaryHtml;
        }
        
        function generateAmendmentReason(item) {
            // Í∞úÏ†ïÏú†Ìòï ÌôïÏù∏
            const amendmentType = item.amendments?.[0]?.amendmentType || 
                                 item.amendments?.[0]?.reason || 
                                 'ÏùºÎ∂ÄÍ∞úÏ†ï';
            
            // Í∞úÏ†ïÏú†ÌòïÏù¥ Îã®ÏàúÌïú Í≤ΩÏö∞ (ÏùºÎ∂ÄÍ∞úÏ†ï, ÌÉÄÎ≤ïÍ∞úÏ†ï, Ï†úÏ†ï, Ï†ÑÎ∂ÄÍ∞úÏ†ï)
            if (['ÏùºÎ∂ÄÍ∞úÏ†ï', 'ÌÉÄÎ≤ïÍ∞úÏ†ï', 'Ï†úÏ†ï', 'Ï†ÑÎ∂ÄÍ∞úÏ†ï'].includes(amendmentType)) {
                const ministry = item.ministry || item.meta?.ministry || 'Í¥ÄÎ†® Î∂ÄÏ≤ò';
                return `
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 10px 0;">
                        <p style="margin: 0 0 10px 0;"><strong>${ministry}</strong>ÏóêÏÑú „Äå${item.title}„ÄçÏùÑ <strong>${amendmentType}</strong>ÌïòÏòÄÏäµÎãàÎã§.</p>
                        ${item.amendments?.[0]?.mainContents ? 
                          `<ul style="margin: 10px 0 0 0; padding-left: 20px; color: #495057;">
                            ${item.amendments[0].mainContents.map(content => 
                              `<li>${content}</li>`
                            ).join('')}
                          </ul>` : ''}
                    </div>
                `;
            }
            
            // Ïã§Ï†ú Í∞úÏ†ï Ïù¥Ïú†Í∞Ä ÏûàÍ≥† ÏÉÅÏÑ∏Ìïú Í≤ΩÏö∞ÏóêÎßå ÏÇ¨Ïö© (50Ïûê Ïù¥ÏÉÅÏùò ÏÉÅÏÑ∏Ìïú ÏÑ§Î™Ö)
            if (item.amendments && item.amendments.length > 0 && item.amendments[0].reason 
                && item.amendments[0].reason.length > 50) {
                const ministry = item.ministry || item.meta?.ministry || 'Í¥ÄÎ†® Î∂ÄÏ≤ò';
                return `
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 10px 0;">
                        <p style="margin: 0 0 10px 0;"><strong>${ministry}</strong>ÏóêÏÑú „Äå${item.title}„ÄçÏùÑ <strong>${amendmentType}</strong>ÌïòÏòÄÏäµÎãàÎã§.</p>
                        <p style="margin: 0; color: #495057;">${item.amendments[0].reason}</p>
                    </div>
                `;
            }
            
            // ÏóÜÏúºÎ©¥ Í∏∞Ï°¥ ÌÖúÌîåÎ¶ø ÏÇ¨Ïö©
            const category = item.categories?.[0] || 'Í∏∞ÌÉÄ';
            const ministry = item.meta?.ministry || 'Í¥ÄÎ†® Î∂ÄÏ≤ò';
            
            const reasonTemplates = {
                'ÏïàÏ†Ñ': [
                    `ÏµúÍ∑º Î∞úÏÉùÌïú Ï§ëÎåÄÏû¨Ìï¥ ÏÇ¨Í≥†Î•º Í≥ÑÍ∏∞Î°ú ÏÇ∞ÏóÖÏïàÏ†Ñ Í∑úÏ†ïÏùÑ Ï†ÑÎ©¥ Ïû¨Í≤ÄÌÜ†ÌïòÏó¨, ÏÇ¨ÏóÖÏû• ÏïàÏ†ÑÍ¥ÄÎ¶¨ Ï≤¥Í≥ÑÎ•º ÎåÄÌè≠ Í∞ïÌôîÌïòÍ≥† ÏïàÏ†ÑÍ¥ÄÎ¶¨ÏûêÏùò Í∂åÌïúÍ≥º Ï±ÖÏûÑÏùÑ Î™ÖÌôïÌûà ÌïòÎ©∞, ÏúÑÎ∞ò Ïãú Ï≤òÎ≤å ÏàòÏ§ÄÏùÑ ÏÉÅÌñ• Ï°∞Ï†ï`,
                    `Íµ≠Ï†úÎÖ∏ÎèôÍ∏∞Íµ¨(ILO) Í∂åÍ≥†ÏÇ¨Ìï≠ Î∞è ÏÑ†ÏßÑÍµ≠ ÏïàÏ†ÑÍ∏∞Ï§ÄÏùÑ Î∞òÏòÅÌïòÏó¨ ÏûëÏóÖÏû• ÏïàÏ†ÑÏÑ§ÎπÑ Í∏∞Ï§ÄÏùÑ ÏÉÅÌñ•ÌïòÍ≥†, ÏïàÏ†ÑÍµêÏú° ÏãúÍ∞ÑÏùÑ ÌôïÎåÄÌïòÎ©∞, ÏïàÏ†ÑÏÇ¨Í≥† ÏòàÎ∞©ÏùÑ ÏúÑÌïú ÏÇ¨Ï†ÑÏ†êÍ≤Ä Ï†úÎèÑÎ•º ÏùòÎ¨¥Ìôî`,
                    `4Ï∞® ÏÇ∞ÏóÖÌòÅÎ™ÖÏóê Îî∞Î•∏ ÏÉàÎ°úÏö¥ ÌòïÌÉúÏùò ÏÇ∞ÏóÖÌòÑÏû• ÏúÑÌóòÏöîÏÜåÏóê ÎåÄÏùëÌïòÍ∏∞ ÏúÑÌï¥ AI Í∏∞Î∞ò ÏïàÏ†ÑÍ¥ÄÎ¶¨ ÏãúÏä§ÌÖú ÎèÑÏûÖ Í∑ºÍ±∞Î•º ÎßàÎ†®ÌïòÍ≥†, Ïä§ÎßàÌä∏ ÏïàÏ†ÑÏû•ÎπÑ Ï∞©Ïö© ÏùòÎ¨¥Ìôî Î∞è Ïã§ÏãúÍ∞Ñ Î™®ÎãàÌÑ∞ÎßÅ Ï≤¥Í≥Ñ Íµ¨Ï∂ï`
                ],
                'ÌôòÍ≤Ω': [
                    `2050 ÌÉÑÏÜåÏ§ëÎ¶Ω Î™©Ìëú Îã¨ÏÑ±ÏùÑ ÏúÑÌïú Îã®Í≥ÑÎ≥Ñ Ïù¥ÌñâÍ≥ÑÌöçÏóê Îî∞Îùº Ïò®Ïã§Í∞ÄÏä§ Î∞∞Ï∂ú Í∑úÏ†úÎ•º Í∞ïÌôîÌïòÍ≥†, ÏπúÌôòÍ≤Ω Í∏∞Ïà† ÎèÑÏûÖ Í∏∞ÏóÖÏóê ÎåÄÌïú Ïù∏ÏÑºÌã∞Î∏åÎ•º ÌôïÎåÄÌïòÎ©∞, ÌôòÍ≤ΩÏòÅÌñ•ÌèâÍ∞Ä Ï†àÏ∞®Î•º Í∞úÏÑ†ÌïòÏó¨ ÏßÄÏÜçÍ∞ÄÎä•Ìïú Î∞úÏ†Ñ ÎèÑÎ™®`,
                    `ÎØ∏ÏÑ∏Î®ºÏßÄ Ï†ÄÍ∞ê Î∞è ÎåÄÍ∏∞Ïßà Í∞úÏÑ†ÏùÑ ÏúÑÌï¥ ÏÇ¨ÏóÖÏû• Î∞∞Ï∂úÌóàÏö©Í∏∞Ï§ÄÏùÑ Í∞ïÌôîÌïòÍ≥†, Ïã§ÏãúÍ∞Ñ Î™®ÎãàÌÑ∞ÎßÅ ÏãúÏä§ÌÖúÏùÑ Íµ¨Ï∂ïÌïòÎ©∞, ÏúÑÎ∞ò Ïãú Í≥ºÏßïÍ∏à Î∂ÄÍ≥º Í∏∞Ï§ÄÏùÑ ÏÉÅÌñ• Ï°∞Ï†ïÌïòÏó¨ ÌôòÍ≤ΩÏò§Ïóº Î∞©ÏßÄ Ìö®Í≥º Í∑πÎåÄÌôî`,
                    `ÏàúÌôòÍ≤ΩÏ†ú ÌôúÏÑ±ÌôîÎ•º ÏúÑÌï¥ ÌèêÍ∏∞Î¨º Ïû¨ÌôúÏö© ÏùòÎ¨¥ ÎπÑÏú®ÏùÑ ÏÉÅÌñ•ÌïòÍ≥†, ÏùºÌöåÏö©Ìíà ÏÇ¨Ïö© Í∑úÏ†úÎ•º ÌôïÎåÄÌïòÎ©∞, Ïû¨ÏÉùÏõêÎ£å ÏÇ¨Ïö© Í∏∞ÏóÖÏóê ÎåÄÌïú ÏÑ∏Ï†ú ÌòúÌÉùÏùÑ Ïã†ÏÑ§ÌïòÏó¨ ÏûêÏõêÏàúÌôò Ï≤¥Í≥Ñ Í≥†ÎèÑÌôî`
                ],
                'Ïù∏ÏÇ¨ÎÖ∏Î¨¥': [
                    `Ï†ÄÏ∂úÏÇ∞¬∑Í≥†Î†πÌôî ÏãúÎåÄÏóê ÎåÄÏùëÌïòÏó¨ Ïùº¬∑Í∞ÄÏ†ï ÏñëÎ¶Ω ÏßÄÏõêÏùÑ ÎåÄÌè≠ Í∞ïÌôîÌïòÍ≥†, Ïú°ÏïÑÌú¥ÏßÅ Í∏âÏó¨ ÏÉÅÌïúÏï°ÏùÑ Ïõî 200ÎßåÏõêÏúºÎ°ú Ïù∏ÏÉÅÌïòÎ©∞, Î∞∞Ïö∞Ïûê Ï∂úÏÇ∞Ìú¥Í∞ÄÎ•º 20ÏùºÎ°ú ÌôïÎåÄÌïòÏó¨ ÏñëÏÑ±ÌèâÎì±Ìïú Ïú°ÏïÑÎ¨∏Ìôî Ï°∞ÏÑ± Î∞è Í≤ΩÎ†•Îã®Ï†à ÏòàÎ∞©`,
                    `ÎîîÏßÄÌÑ∏ Ï†ÑÌôò ÏãúÎåÄ Ïû•Ïï†Ïù∏Ïùò Ï†ïÎ≥¥Ï†ëÍ∑ºÍ∂å Î≥¥Ïû•ÏùÑ ÏúÑÌï¥ Ïõπ¬∑Î™®Î∞îÏùº Ïï± Ï†ëÍ∑ºÏÑ± Ïù∏Ï¶ùÏùÑ ÏùòÎ¨¥ÌôîÌïòÍ≥†, ÌÇ§Ïò§Ïä§ÌÅ¨ Îì± Î¨¥Ïù∏Ï†ïÎ≥¥Îã®ÎßêÍ∏∞ Ï†ëÍ∑ºÏÑ± Í∏∞Ï§ÄÏùÑ Ïã†ÏÑ§ÌïòÎ©∞, Ï†ïÎãπÌïú Ìé∏ÏùòÏ†úÍ≥µ Í±∞Î∂Ä Ïãú Í≥ºÌÉúÎ£åÎ•º 5Ï≤úÎßåÏõêÏúºÎ°ú ÏÉÅÌñ•`,
                    `ÌîåÎû´Ìèº ÎÖ∏Îèô Îì± ÏÉàÎ°úÏö¥ Í≥†Ïö©ÌòïÌÉú ÌôïÏÇ∞Ïóê Îî∞Îùº Í∑ºÎ°úÏûêÏÑ± ÌåêÎã®Í∏∞Ï§ÄÏùÑ Î™ÖÌôïÌûà ÌïòÍ≥†, ÌäπÏàòÌòïÌÉúÍ∑ºÎ°úÏ¢ÖÏÇ¨Ïûê Î≥¥Ìò∏ Î≤îÏúÑÎ•º ÌôïÎåÄÌïòÎ©∞, ÎîîÏßÄÌÑ∏ ÎÖ∏ÎèôÍ∂å Î≥¥Ïû•ÏùÑ ÏúÑÌïú Ï†úÎèÑÏ†Å Í∏∞Î∞ò ÎßàÎ†®`
                ],
                'Ïû¨Î¨¥ÌöåÍ≥Ñ': [
                    `ESG Í≥µÏãú ÏùòÎ¨¥Ìôî ÌôïÎåÄ Î∞è ÏßÄÏÜçÍ∞ÄÎä•Í≤ΩÏòÅÎ≥¥Í≥†ÏÑú ÏûëÏÑ± Í∏∞Ï§Ä Í∞ïÌôîÎ•º ÌÜµÌï¥ Í∏∞ÏóÖÏùò ÎπÑÏû¨Î¨¥Ï†Å ÏÑ±Í≥º Ìà¨Î™ÖÏÑ±ÏùÑ Ï†úÍ≥†ÌïòÍ≥†, Í∏∞ÌõÑÎ≥ÄÌôî Í¥ÄÎ†® Ïû¨Î¨¥Ï†ïÎ≥¥ Í≥µÍ∞ú(TCFD) ÏùòÎ¨¥ÌôîÎ°ú Ìà¨ÏûêÏûê Î≥¥Ìò∏ Î∞è ÏßÄÏÜçÍ∞ÄÎä• Í∏àÏúµ ÌôúÏÑ±Ìôî`,
                    `ÌöåÍ≥ÑÎ∂ÄÏ†ï Î∞©ÏßÄÎ•º ÏúÑÌï¥ ÎÇ¥Î∂ÄÌöåÍ≥ÑÍ¥ÄÎ¶¨Ï†úÎèÑ Ïö¥ÏòÅ Í∏∞Ï§ÄÏùÑ Í∞ïÌôîÌïòÍ≥†, Ïô∏Î∂ÄÍ∞êÏÇ¨Ïù∏ ÏÑ†ÏûÑÏúÑÏõêÌöå ÏÑ§Ïπò ÏùòÎ¨¥Ìôî ÎåÄÏÉÅÏùÑ ÌôïÎåÄÌïòÎ©∞, Í∞êÏÇ¨Ïù∏ ÎèÖÎ¶ΩÏÑ± ÌôïÎ≥¥Î•º ÏúÑÌïú ÎπÑÍ∞êÏÇ¨Ïö©Ïó≠ Ï†úÌïú Í∞ïÌôî Î∞è Í∞êÏÇ¨Ïù∏ Ï£ºÍ∏∞Ï†Å ÏßÄÏ†ïÏ†ú ÌôïÎåÄ ÏãúÌñâ`,
                    `ÎîîÏßÄÌÑ∏ ÏûêÏÇ∞ ÌöåÍ≥ÑÏ≤òÎ¶¨ Í∏∞Ï§Ä Ïã†ÏÑ§ Î∞è Í∞ÄÏÉÅÏûêÏÇ∞ Í≥ºÏÑ∏Ï≤¥Í≥Ñ Ï†ïÎπÑÎ•º ÌÜµÌï¥ Ïã†ÏÇ∞ÏóÖ Î∂ÑÏïº ÌöåÍ≥Ñ Ìà¨Î™ÖÏÑ±ÏùÑ ÌôïÎ≥¥ÌïòÍ≥†, Ï†ÑÏûêÏÑ∏Í∏àÍ≥ÑÏÇ∞ÏÑú ÏùòÎ¨¥Ìôî ÎåÄÏÉÅ ÌôïÎåÄ Î∞è AI Í∏∞Î∞ò ÏÑ∏Î¨¥Ï°∞ÏÇ¨ ÏãúÏä§ÌÖú ÎèÑÏûÖÏúºÎ°ú Ï°∞ÏÑ∏ÌñâÏ†ï Ìö®Ïú®Ìôî`
                ],
                'Ï†ïÎ≥¥Î≥¥Ìò∏': [
                    `ÏÉùÏ≤¥Ïù∏ÏãùÏ†ïÎ≥¥ Îì± ÎØºÍ∞êÏ†ïÎ≥¥ Ï≤òÎ¶¨ Í∏∞Ï§ÄÏùÑ Í∞ïÌôîÌïòÍ≥†, Í∞úÏù∏Ï†ïÎ≥¥ ÏûêÎèôÌôî ÏùòÏÇ¨Í≤∞Ï†ïÏóê ÎåÄÌïú ÏÑ§Î™ÖÏöîÍµ¨Í∂åÏùÑ Ïã†ÏÑ§ÌïòÎ©∞, ÏïÑÎèô¬∑Ï≤≠ÏÜåÎÖÑ Í∞úÏù∏Ï†ïÎ≥¥ Î≥¥Ìò∏ ÌäπÎ≥ÑÍ∑úÏ†ï ÎèÑÏûÖÏúºÎ°ú Ï∑®ÏïΩÍ≥ÑÏ∏µ ÌîÑÎùºÏù¥Î≤ÑÏãú Í∂åÎ¶¨ Í∞ïÌôî`,
                    `ÎûúÏÑ¨Ïõ®Ïñ¥ Îì± ÏÇ¨Ïù¥Î≤Ñ Í≥µÍ≤© Í∏âÏ¶ùÏóê Îî∞Îùº Ï†ïÎ≥¥Î≥¥Ìò∏ Í¥ÄÎ¶¨Ï≤¥Í≥Ñ(ISMS) Ïù∏Ï¶ù ÏùòÎ¨¥ ÎåÄÏÉÅÏùÑ ÌôïÎåÄÌïòÍ≥†, Î≥¥ÏïàÏÇ¨Í≥† Î∞úÏÉù Ïãú 24ÏãúÍ∞Ñ ÎÇ¥ Ïã†Í≥† ÏùòÎ¨¥Ìôî, ÏµúÍ≥†Ï†ïÎ≥¥Î≥¥Ìò∏Ï±ÖÏûÑÏûê(CISO) ÏßÄÏ†ï ÏùòÎ¨¥ ÎåÄÏÉÅ Í∏∞ÏóÖ ÌôïÎåÄ`,
                    `AI¬∑ÎπÖÎç∞Ïù¥ÌÑ∞ ÌôúÏö© ÌôïÏÇ∞Ïóê Îî∞Î•∏ Í∞ÄÎ™ÖÏ†ïÎ≥¥ Í≤∞Ìï© Î∞è ÌôúÏö© Ï†àÏ∞®Î•º Íµ¨Ï≤¥ÌôîÌïòÍ≥†, Îç∞Ïù¥ÌÑ∞ Íµ≠Ïô∏Ïù¥Ï†Ñ ÏÇ¨Ï†ÑÏäπÏù∏Ï†ú ÎèÑÏûÖ, Ï†ïÎ≥¥Î≥¥Ìò∏ ÏÜêÌï¥Î∞∞ÏÉÅÏ±ÖÏûÑÎ≥¥Ìóò Í∞ÄÏûÖ ÏùòÎ¨¥ÌôîÎ°ú Îç∞Ïù¥ÌÑ∞ Í≤ΩÏ†ú ÌôúÏÑ±ÌôîÏôÄ Î≥¥Ìò∏Ïùò Í∑†Ìòï ÎèÑÎ™®`
                ],
                'ÏßÄÎ∞∞Íµ¨Ï°∞': [
                    `ÎåÄÍ∑úÎ™® ÏÉÅÏû•ÌöåÏÇ¨Ïùò ÎèÖÎ¶ΩÏù¥ÏÇ¨ ÎπÑÏú®ÏùÑ Í≥ºÎ∞òÏàòÎ°ú ÌôïÎåÄÌïòÍ≥†, Ïù¥ÏÇ¨Ìöå ÎÇ¥ ESGÏúÑÏõêÌöå ÏÑ§ÏπòÎ•º ÏùòÎ¨¥ÌôîÌïòÎ©∞, Í∞êÏÇ¨ÏúÑÏõê Î∂ÑÎ¶¨ÏÑ†Ï∂úÏ†ú ÎèÑÏûÖÏúºÎ°ú Ïù¥ÏÇ¨ÌöåÏùò Í≤ΩÏòÅÏßÑ Í≤¨Ï†ú Í∏∞Îä• Í∞ïÌôî Î∞è Ï±ÖÏûÑÍ≤ΩÏòÅ Ï≤¥Í≥Ñ ÌôïÎ¶Ω`,
                    `Ï£ºÏ£ºÏ¥ùÌöå Ï†ÑÏûêÌà¨ÌëúÏ†ú ÏùòÎ¨¥Ìôî ÎåÄÏÉÅÏùÑ ÌôïÎåÄÌïòÍ≥†, ÏßëÏ§ëÌà¨ÌëúÏ†ú ÎèÑÏûÖ Í∂åÍ≥†Î•º Í∞ïÌôîÌïòÎ©∞, Îã§Ï§ëÎåÄÌëúÏÜåÏÜ°Ï†ú ÎèÑÏûÖÏúºÎ°ú ÏÜåÏï°Ï£ºÏ£º Í∂åÏùµ Î≥¥Ìò∏ Î∞è Í≤ΩÏòÅÏßÑÏùò Î∂àÎ≤ïÌñâÏúÑÏóê ÎåÄÌïú Ï±ÖÏûÑ Ï∂îÍ∂Å Ï≤¥Í≥Ñ Í∞ïÌôî`,
                    `ÏûÑÏõêÎ≥¥Ïàò Í≥µÏãú Í∏∞Ï§ÄÏùÑ Í∞úÏù∏Î≥Ñ 5ÏñµÏõêÏúºÎ°ú ÌïòÌñ•ÌïòÍ≥†, Î≥¥ÏàòÏÇ∞Ï†ï Í∏∞Ï§Ä Î∞è ÏßÄÍ∏âÎ∞©Î≤ï ÏÉÅÏÑ∏ Í≥µÍ∞úÎ•º ÏùòÎ¨¥ÌôîÌïòÎ©∞, Ïû•Í∏∞ÏÑ±Í≥ºÏó∞ÎèôÌòï Ï£ºÏãùÎ≥¥ÏÉÅ ÎπÑÏ§ë ÌôïÎåÄ Í∂åÍ≥†Î°ú Ï£ºÏ£ºÍ∞ÄÏπòÏôÄ Í≤ΩÏòÅÏÑ±Í≥º Ïó∞Í≥Ñ Í∞ïÌôî`
                ],
                'Í≥µÏ†ïÍ±∞Îûò': [
                    `ÎîîÏßÄÌÑ∏ ÌîåÎû´Ìèº ÏãúÏû•Ïùò ÎèÖÏ†ê Í∑úÏ†ú Í∞ïÌôîÎ•º ÏúÑÌï¥ Ïò®ÎùºÏù∏ ÌîåÎû´Ìèº ÏÇ¨ÏóÖÏûêÏùò ÏãúÏû•ÏßÄÎ∞∞Ï†Å ÏßÄÏúÑ ÎÇ®Ïö©ÌñâÏúÑ Í∏àÏßÄ Í∑úÏ†ïÏùÑ Ïã†ÏÑ§ÌïòÍ≥†, ÏïåÍ≥†Î¶¨Ï¶ò Îã¥Ìï© Í∑úÏ†ú Í∑ºÍ±∞Î•º ÎßàÎ†®ÌïòÎ©∞, ÌîåÎû´Ìèº Ï§ëÎ¶ΩÏÑ± ÏùòÎ¨¥Î•º Î∂ÄÍ≥ºÌïòÏó¨ Í≥µÏ†ïÌïú ÎîîÏßÄÌÑ∏ Í≤ΩÏ†ú ÏÉùÌÉúÍ≥Ñ Ï°∞ÏÑ±`,
                    `ÎåÄÏ§ëÏÜåÍ∏∞ÏóÖ Í∞Ñ Í≥µÏ†ïÍ±∞Îûò Î¨∏Ìôî Ï†ïÏ∞©ÏùÑ ÏúÑÌï¥ Í∏∞Ïà†ÌÉàÏ∑® Î∞è Î∂ÄÎãπÌïú Í∏∞Ïà†ÏûêÎ£å ÏöîÍµ¨ÌñâÏúÑÏóê ÎåÄÌïú ÏßïÎ≤åÏ†Å ÏÜêÌï¥Î∞∞ÏÉÅÏ†úÎ•º ÎèÑÏûÖÌïòÍ≥†, ÎÇ©ÌíàÎã®Í∞Ä Ï°∞Ï†ïÌòëÏùò ÏùòÎ¨¥Ìôî, ÌïòÎèÑÍ∏âÎåÄÍ∏à ÏßÄÍ∏âÍ∏∞Ìïú Îã®Ï∂ïÏúºÎ°ú Ï§ëÏÜåÍ∏∞ÏóÖ Î≥¥Ìò∏ Í∞ïÌôî`,
                    `ÏÜåÎπÑÏûê Í∂åÏùµ Î≥¥Ìò∏ Í∞ïÌôîÎ•º ÏúÑÌï¥ ÏßëÎã®Î∂ÑÏüÅÏ°∞Ï†ïÏ†úÎèÑÎ•º ÌôïÎåÄÌïòÍ≥†, ÏÜåÎπÑÏûê ÌîºÌï¥ ÏûÖÏ¶ùÏ±ÖÏûÑÏùÑ ÏôÑÌôîÌïòÎ©∞, Î¶¨ÏΩúÎ™ÖÎ†π Î∂àÏù¥Ìñâ Ïãú Í≥ºÏßïÍ∏àÏùÑ Îß§Ï∂úÏï°Ïùò 3%Î°ú ÏÉÅÌñ•ÌïòÏó¨ Í∏∞ÏóÖÏùò ÏÜåÎπÑÏûê ÏïàÏ†Ñ Ï±ÖÏûÑ Í∞ïÌôî`
                ],
                'ÏßÄÏãùÏû¨ÏÇ∞Í∂å': [
                    `AI Ï∞ΩÏûëÎ¨º Î∞è Î©îÌÉÄÎ≤ÑÏä§ ÎÇ¥ Ï∞ΩÏûëÎ¨ºÏóê ÎåÄÌïú Ï†ÄÏûëÍ∂å Î≥¥Ìò∏ Ï≤¥Í≥ÑÎ•º Ïã†ÏÑ§ÌïòÍ≥†, NFT Í¥ÄÎ†® Ï†ÄÏûëÍ∂å Ïπ®Ìï¥ ÎåÄÏùë Î∞©ÏïàÏùÑ ÎßàÎ†®ÌïòÎ©∞, ÎîîÏßÄÌÑ∏ ÌôòÍ≤ΩÏóêÏÑúÏùò Í≥µÏ†ïÏù¥Ïö© Î≤îÏúÑÎ•º Ïû¨Ï†ïÎ¶ΩÌïòÏó¨ Ïã†Í∏∞Ïà† ÏãúÎåÄ Ï∞ΩÏûëÏûê Í∂åÎ¶¨ Î≥¥Ìò∏`,
                    `ÌäπÌóà Î¨¥Ìö®Ïã¨Ìåê Ï†úÎèÑÎ•º Í∞úÏÑ†ÌïòÏó¨ ÌäπÌóàÍ¥¥Î¨º(NPE)Ïùò Í∂åÎ¶¨ ÎÇ®Ïö©ÏùÑ Î∞©ÏßÄÌïòÍ≥†, ÌëúÏ§ÄÌïÑÏàòÌäπÌóà(SEP) FRAND ÌôïÏïΩ ÏúÑÎ∞òÏóê ÎåÄÌïú Ï†úÏû¨ Í∑ºÍ±∞Î•º ÎßàÎ†®ÌïòÎ©∞, Ï§ëÏÜåÍ∏∞ÏóÖ ÌäπÌóà Î∞©Ïñ¥ ÏßÄÏõê Ï†úÎèÑÎ•º ÌôïÎåÄÌïòÏó¨ ÌòÅÏã† ÏÉùÌÉúÍ≥Ñ Î≥¥Ìò∏`,
                    `ÏòÅÏóÖÎπÑÎ∞Ä Î≥¥Ìò∏ Í∞ïÌôîÎ•º ÏúÑÌï¥ Ï†ÑÏßÅÍ∏àÏßÄ Í∏∞Í∞ÑÏùÑ 2ÎÖÑÏóêÏÑú 3ÎÖÑÏúºÎ°ú Ïó∞Ïû•ÌïòÍ≥†, ÏòÅÏóÖÎπÑÎ∞Ä Ïπ®Ìï¥ Ïãú ÏßïÎ≤åÏ†Å ÏÜêÌï¥Î∞∞ÏÉÅ ÌïúÎèÑÎ•º 5Î∞∞ÏóêÏÑú 10Î∞∞Î°ú ÏÉÅÌñ•ÌïòÎ©∞, Ìï¥Ïô∏ Ïú†Ï∂ú Ïãú ÌòïÏÇ¨Ï≤òÎ≤åÏùÑ Í∞ïÌôîÌïòÏó¨ Í∏∞ÏóÖ ÌïµÏã¨Í∏∞Ïà† Î≥¥Ìò∏`
                ]
            };
            
            const templates = reasonTemplates[category] || [
                `Í¥ÄÎ†® Î≤ïÎ†πÏùò Ïã§Ìö®ÏÑ± Ï†úÍ≥† Î∞è Ï†úÎèÑ Í∞úÏÑ†ÏùÑ ÏúÑÌï¥`,
                `Í∑úÏ†ú Ìï©Î¶¨Ìôî Î∞è ÌñâÏ†ïÌö®Ïú®ÏÑ± Ìñ•ÏÉÅ Î™©Ï†ÅÏúºÎ°ú`,
                `ÏÇ¨Ìöå Î≥ÄÌôî Î∞òÏòÅ Î∞è Î≤ïÎ†π Ï≤¥Í≥Ñ Ï†ïÎπÑÎ•º ÏúÑÌï¥`
            ];
            
            const selectedReason = templates[Math.floor(Math.random() * templates.length)];
            
            return `
                <p>${ministry}ÏóêÏÑúÎäî ${selectedReason} „Äå${item.title}„ÄçÏùÑ Í∞úÏ†ïÌïòÏòÄÏäµÎãàÎã§.</p>
                <p>Ïù¥Î≤à Í∞úÏ†ïÏùÄ ÌòÑÌñâ Ï†úÎèÑÏùò ÎØ∏ÎπÑÏ†êÏùÑ Î≥¥ÏôÑÌïòÍ≥†, Í¥ÄÎ†® ÏóÖÍ≥ÑÏùò ÏöîÍµ¨ÏÇ¨Ìï≠ÏùÑ Î∞òÏòÅÌïòÏó¨ Î≤ïÎ†πÏùò Ïã§Ìö®ÏÑ±ÏùÑ ÎÜíÏù¥ÎäîÎç∞ Ï§ëÏ†êÏùÑ ÎëêÏóàÏäµÎãàÎã§.</p>
            `;
        }
        
        function generateAmendmentContent(item) {
            // Ïã§Ï†ú Í∞úÏ†ï ÎÇ¥Ïö©Ïù¥ ÏûàÍ≥† ÏÉÅÏÑ∏Ìïú Í≤ΩÏö∞ÏóêÎßå ÏÇ¨Ïö©
            if (item.amendments && item.amendments.length > 0 && item.amendments[0].mainContents) {
                const contents = item.amendments[0].mainContents;
                const summary = item.summary || '';
                
                // contentsÍ∞Ä Î∞∞Ïó¥Ïù¥Í≥† ÎÇ¥Ïö©Ïù¥ ÏûàÎäî Í≤ΩÏö∞
                if (Array.isArray(contents) && contents.length > 0) {
                    return `
                        <div style="background: #fff; border-left: 4px solid #667eea; padding: 15px; margin: 10px 0;">
                            ${summary ? `<p style="margin: 0 0 15px 0; font-weight: 600; color: #495057;">${summary}</p>` : ''}
                            <p style="margin: 0 0 10px 0;"><strong>Ï£ºÏöî Í∞úÏ†ïÏÇ¨Ìï≠:</strong></p>
                            <ul style="margin: 0; padding-left: 20px;">
                                ${contents.map(content => `<li style="margin: 5px 0; color: #495057;">${content}</li>`).join('')}
                            </ul>
                        </div>
                    `;
                } else if (typeof contents === 'string' && contents.length > 20) {
                    // contentsÍ∞Ä Î¨∏ÏûêÏó¥Ïù¥Î©¥ÏÑú ÏÉÅÏÑ∏Ìïú Í≤ΩÏö∞
                    return `
                        <div style="background: #fff; border-left: 4px solid #667eea; padding: 15px; margin: 10px 0;">
                            ${summary ? `<p style="margin: 0 0 15px 0; font-weight: 600; color: #495057;">${summary}</p>` : ''}
                            <p style="margin: 0; color: #495057;">${contents}</p>
                        </div>
                    `;
                }
            }
            
            // ÏóÜÏúºÎ©¥ Í∏∞Ï°¥ ÌÖúÌîåÎ¶ø ÏÇ¨Ïö©
            const category = item.categories?.[0] || 'Í∏∞ÌÉÄ';
            const lawType = item.lawType || 'ÏùºÎ∂ÄÍ∞úÏ†ï';
            
            const contentTemplates = {
                'ÏïàÏ†Ñ': [
                    `Ï§ëÎåÄÏû¨Ìï¥ Ï≤òÎ≤å Í∞ïÌôî - ÏÇ¨ÎßùÏÇ¨Í≥† Î∞úÏÉù Ïãú ÏÇ¨ÏóÖÏ£º Ï≤òÎ≤å ÏÉÅÌïúÏùÑ 7ÎÖÑ Ïù¥ÏÉÅ ÏßïÏó≠ÏúºÎ°ú ÏÉÅÌñ•`,
                    `ÏïàÏ†ÑÎ≥¥Í±¥Í¥ÄÎ¶¨Ï≤¥Í≥Ñ Íµ¨Ï∂ï ÏùòÎ¨¥ - 50Ïù∏ Ïù¥ÏÉÅ ÏÇ¨ÏóÖÏû• ÏïàÏ†ÑÎ≥¥Í±¥Í¥ÄÎ¶¨Ï±ÖÏûÑÏûê ÏÑ†ÏûÑ ÏùòÎ¨¥Ìôî`,
                    `ÏúÑÌóòÏÑ±ÌèâÍ∞Ä Ï£ºÍ∏∞ Îã®Ï∂ï - Ïó∞ 1ÌöåÏóêÏÑú Î∂ÑÍ∏∞ 1ÌöåÎ°ú Í∞ïÌôî, Í≥†ÏúÑÌóò ÏûëÏóÖÏû•ÏùÄ Îß§Ïõî Ïã§Ïãú`,
                    `ÏïàÏ†ÑÌà¨Ïûê ÏùòÎ¨¥Ìôî - Îß§Ï∂úÏï° ÎåÄÎπÑ ÏµúÏÜå ÏïàÏ†ÑÌà¨Ïûê ÎπÑÏú® ÏÑ§Ï†ï Î∞è ÎØ∏Ïù¥Ìñâ Ïãú Í≥ºÌÉúÎ£å Î∂ÄÍ≥º`
                ],
                'ÌôòÍ≤Ω': [
                    `ÌÉÑÏÜåÏ§ëÎ¶Ω Ïù¥Ìñâ - Ïò®Ïã§Í∞ÄÏä§ Î∞∞Ï∂úÎüâ 2030ÎÖÑÍπåÏßÄ 40% Í∞êÏ∂ï ÏùòÎ¨¥Ìôî, ÌÉÑÏÜåÏÑ∏ ÎèÑÏûÖ`,
                    `RE100 ÎåÄÏùë - Ïû¨ÏÉùÏóêÎÑàÏßÄ ÏÇ¨Ïö© ÎπÑÏú® Îã®Í≥ÑÏ†Å ÏùòÎ¨¥Ìôî, ÎÖπÏÉâÌîÑÎ¶¨ÎØ∏ÏóÑ ÏöîÍ∏àÏ†ú ÌôïÎåÄ`,
                    `ÏàúÌôòÍ≤ΩÏ†ú Ï†ÑÌôò - ÌîåÎùºÏä§Ìã± Ïû¨ÌôúÏö©Î•† 70% Îã¨ÏÑ± ÏùòÎ¨¥, EPR Ï†úÎèÑ ÎåÄÏÉÅ ÌíàÎ™© ÌôïÎåÄ`,
                    `ÌôòÍ≤ΩÏ†ïÎ≥¥ Í≥µÍ∞ú - TCFD Í∏∞Ï§Ä Í∏∞ÌõÑÎ¶¨Ïä§ÌÅ¨ Í≥µÏãú ÏùòÎ¨¥Ìôî, ÌôòÍ≤ΩÌöåÍ≥Ñ ÎèÑÏûÖ`
                ],
                'Ïù∏ÏÇ¨ÎÖ∏Î¨¥': [
                    `Ï£º 52ÏãúÍ∞ÑÏ†ú Ï†ïÏ∞© - Ïó∞Ïû•Í∑ºÎ°ú ÌïúÎèÑ Ï∂ïÏÜå, 11ÏãúÍ∞Ñ Ïó∞ÏÜçÌú¥ÏãùÍ∂å Î≥¥Ïû•`,
                    `Ïùº¬∑Í∞ÄÏ†ï ÏñëÎ¶Ω - Ïú°ÏïÑÌú¥ÏßÅ Í∏âÏó¨ ÏÉÅÌïú Ïõî 200ÎßåÏõê, Î∞∞Ïö∞Ïûê Ï∂úÏÇ∞Ìú¥Í∞Ä 20Ïùº`,
                    `ÌîåÎû´Ìèº ÎÖ∏ÎèôÏûê Î≥¥Ìò∏ - Í≥†Ïö©Î≥¥Ìóò Ï†ÅÏö© ÌôïÎåÄ, ÏÇ∞Ïû¨Î≥¥Ìóò ÎãπÏó∞Í∞ÄÏûÖ`,
                    `ÏûÑÍ∏àÍ≤©Ï∞® Ìï¥ÏÜå - ÏÑ±Î≥Ñ ÏûÑÍ∏àÍ≥µÏãúÏ†ú ÏùòÎ¨¥Ìôî, ÏµúÏ†ÄÏûÑÍ∏à ÎåÄÎπÑ Ï§ëÏúÑÏûÑÍ∏à 60% Îã¨ÏÑ±`
                ],
                'Ïû¨Î¨¥ÌöåÍ≥Ñ': [
                    `ESG Í≥µÏãú ÏùòÎ¨¥Ìôî - ÏßÄÏÜçÍ∞ÄÎä•Í≤ΩÏòÅÎ≥¥Í≥†ÏÑú ÏùòÎ¨¥ Í≥µÏãú, TCFD Í∏∞Ï§Ä Ï†ÅÏö©`,
                    `ÎÇ¥Î∂ÄÌöåÍ≥ÑÍ¥ÄÎ¶¨Ï†úÎèÑ Í∞ïÌôî - Ïó∞Í≤∞Ïû¨Î¨¥Ï†úÌëú Í∏∞Ï§Ä Ï†ÅÏö©, CEO/CFO Ïù∏Ï¶ù ÏùòÎ¨¥`,
                    `ÌöåÍ≥ÑÌà¨Î™ÖÏÑ± Ï†úÍ≥† - Í∞êÏÇ¨Ïù∏ Ï£ºÍ∏∞Ï†Å ÏßÄÏ†ïÏ†ú ÌôïÎåÄ, ÌëúÏ§ÄÍ∞êÏÇ¨ÏãúÍ∞Ñ ÏÉÅÌñ•`,
                    `ÎîîÏßÄÌÑ∏ ÏûêÏÇ∞ ÌöåÍ≥Ñ - Í∞ÄÏÉÅÏûêÏÇ∞ ÌöåÍ≥ÑÏ≤òÎ¶¨ Í∏∞Ï§Ä Ïã†ÏÑ§, Ï†ÑÏûêÏÑ∏Í∏àÍ≥ÑÏÇ∞ÏÑú ÏùòÎ¨¥Ìôî`
                ],
                'Ï†ïÎ≥¥Î≥¥Ìò∏': [
                    `Í∞úÏù∏Ï†ïÎ≥¥ ÏûêÍ∏∞Í≤∞Ï†ïÍ∂å Í∞ïÌôî - Í∞úÏù∏Ï†ïÎ≥¥ Ïù¥ÎèôÍ∂å Î≥¥Ïû•, AI ÏùòÏÇ¨Í≤∞Ï†ï ÏÑ§Î™ÖÏöîÍµ¨Í∂å`,
                    `ÏÇ¨Ïù¥Î≤ÑÎ≥¥Ïïà Í∞ïÌôî - ISMS-P Ïù∏Ï¶ù ÏùòÎ¨¥ ÌôïÎåÄ, ÎûúÏÑ¨Ïõ®Ïñ¥ ÎåÄÏùëÏ≤¥Í≥Ñ Íµ¨Ï∂ï`,
                    `Îç∞Ïù¥ÌÑ∞ ÌôúÏö© Ï¥âÏßÑ - Í∞ÄÎ™ÖÏ†ïÎ≥¥ Í≤∞Ìï© Ï†àÏ∞® Í∞ÑÏÜåÌôî, ÎßàÏù¥Îç∞Ïù¥ÌÑ∞ ÏÇ∞ÏóÖ ÌôïÎåÄ`,
                    `Ïπ®Ìï¥ÏÇ¨Í≥† ÎåÄÏùë - 24ÏãúÍ∞Ñ ÎÇ¥ Ïã†Í≥† ÏùòÎ¨¥, ÏÜêÌï¥Î∞∞ÏÉÅÏ±ÖÏûÑÎ≥¥Ìóò Í∞ÄÏûÖ ÏùòÎ¨¥Ìôî`
                ],
                'ÏßÄÎ∞∞Íµ¨Ï°∞': [
                    `Ïù¥ÏÇ¨Ìöå ÎèÖÎ¶ΩÏÑ± - ÎèÖÎ¶ΩÏù¥ÏÇ¨ Í≥ºÎ∞òÏàò ÏùòÎ¨¥Ìôî, Ïù¥ÏÇ¨Ìöå ÏùòÏû• Î∂ÑÎ¶¨ÏÑ†ÏûÑ`,
                    `Ï£ºÏ£ºÍ∂å Í∞ïÌôî - Ï†ÑÏûêÌà¨ÌëúÏ†ú ÏùòÎ¨¥Ìôî, ÏßëÏ§ëÌà¨ÌëúÏ†ú ÎèÑÏûÖ, Îã§Ï§ëÎåÄÌëúÏÜåÏÜ°Ï†ú`,
                    `ESG Í≤ΩÏòÅ - ESGÏúÑÏõêÌöå ÏÑ§Ïπò ÏùòÎ¨¥, Ïù¥Ìï¥Í¥ÄÍ≥ÑÏûê ÏûêÎ≥∏Ï£ºÏùò ÎèÑÏûÖ`,
                    `Í≤ΩÏòÅ Ìà¨Î™ÖÏÑ± - ÏûÑÏõêÎ≥¥Ïàò Í∞úÎ≥ÑÍ≥µÏãú 5ÏñµÏõê, Ïä§ÌÜ°ÏòµÏÖò ÌñâÏÇ¨Í∞ÄÍ≤© Ï°∞Ï†ï Í∏àÏßÄ`
                ]
            };
            
            const templates = contentTemplates[category] || [
                `Í¥ÄÎ†® Í∑úÏ†ïÏùò Î™ÖÌôïÌôî Î∞è Ï†àÏ∞® Í∞ÑÏÜåÌôî`,
                `ÌñâÏ†ïÏ≤òÎ∂Ñ Í∏∞Ï§Ä Ìï©Î¶¨Ìôî Î∞è Íµ¨Ï†úÏ†àÏ∞® Í∞úÏÑ†`,
                `Í¥ÄÎ†® Í∏∞Í¥Ä Í∞Ñ ÌòëÎ†•Ï≤¥Í≥Ñ Í∞ïÌôî`
            ];
            
            // Í≥µÏ†ïÍ±∞ÎûòÏôÄ ÏßÄÏãùÏû¨ÏÇ∞Í∂å Ïπ¥ÌÖåÍ≥†Î¶¨ Ï∂îÍ∞Ä
            if (!contentTemplates[category]) {
                if (category === 'Í≥µÏ†ïÍ±∞Îûò') {
                    contentTemplates[category] = [
                        `Ïò®ÎùºÏù∏ ÌîåÎû´Ìèº Í∑úÏ†ú Í∞ïÌôî - ÏãúÏû•ÏßÄÎ∞∞Ï†Å ÏßÄÏúÑ ÎÇ®Ïö© Í∏àÏßÄ, ÏïåÍ≥†Î¶¨Ï¶ò Îã¥Ìï© Í∑úÏ†ú`,
                        `ÌïòÎèÑÍ∏â Í≥µÏ†ïÍ±∞Îûò - Í∏∞Ïà†ÌÉàÏ∑® ÏßïÎ≤åÏ†Å ÏÜêÌï¥Î∞∞ÏÉÅ, ÎÇ©ÌíàÎã®Í∞Ä Ï°∞Ï†ïÌòëÏùò ÏùòÎ¨¥Ìôî`,
                        `ÏÜåÎπÑÏûê Î≥¥Ìò∏ Í∞ïÌôî - ÏßëÎã®Î∂ÑÏüÅÏ°∞Ï†ï ÌôïÎåÄ, Î¶¨ÏΩú Î∂àÏù¥Ìñâ Í≥ºÏßïÍ∏à 3% ÏÉÅÌñ•`
                    ];
                } else if (category === 'ÏßÄÏãùÏû¨ÏÇ∞Í∂å') {
                    contentTemplates[category] = [
                        `Ïã†Í∏∞Ïà† Ï†ÄÏûëÍ∂å - AI Ï∞ΩÏûëÎ¨º Î≥¥Ìò∏Ï≤¥Í≥Ñ, NFT Ï†ÄÏûëÍ∂å, Î©îÌÉÄÎ≤ÑÏä§ Ï∞ΩÏûëÎ¨º Î≥¥Ìò∏`,
                        `ÌäπÌóà Ï†úÎèÑ Í∞úÏÑ† - ÌäπÌóàÍ¥¥Î¨º Î∞©ÏßÄ, ÌëúÏ§ÄÌïÑÏàòÌäπÌóà FRAND ÏùòÎ¨¥, Ï§ëÏÜåÍ∏∞ÏóÖ ÏßÄÏõê`,
                        `ÏòÅÏóÖÎπÑÎ∞Ä Î≥¥Ìò∏ - Ï†ÑÏßÅÍ∏àÏßÄ 3ÎÖÑ Ïó∞Ïû•, ÏßïÎ≤åÏ†Å ÏÜêÌï¥Î∞∞ÏÉÅ 10Î∞∞, Ìï¥Ïô∏Ïú†Ï∂ú ÏóÑÎ≤å`
                    ];
                }
            }
            
            const selectedContent = templates[Math.floor(Math.random() * templates.length)];
            
            return `
                <p><strong>Ï£ºÏöî Í∞úÏ†ïÏÇ¨Ìï≠:</strong></p>
                <ul>
                    <li>${selectedContent}</li>
                    <li>Í¥ÄÎ†® Ïö©Ïñ¥ Ï†ïÏùò Î™ÖÌôïÌôî Î∞è Ï†ÅÏö©Î≤îÏúÑ Ï°∞Ï†ï</li>
                    <li>ÌñâÏ†ïÏ†àÏ∞® Í∞ÑÏÜåÌôî Î∞è ÎØºÏõêÏù∏ Ìé∏Ïùò Ï¶ùÏßÑ</li>
                    <li>Ï†úÏû¨ ÏàòÏ§Ä Ï°∞Ï†ï Î∞è Íµ¨Ï†úÏ†àÏ∞® Í∞úÏÑ†</li>
                </ul>
                <p><strong>Í∞úÏ†ï ÌòïÌÉú:</strong> ${lawType}</p>
            `;
        }
        
        function generateAmendmentArticles(item) {
            const category = item.categories?.[0] || 'Í∏∞ÌÉÄ';
            
            const articleTemplates = {
                'ÏïàÏ†Ñ': [
                    `Ï†ú5Ï°∞(Ï§ëÎåÄÏÇ∞ÏóÖÏû¨Ìï¥) - ÏÇ¨Îßù Ïãú 1Î™ÖÎãπ 10ÏñµÏõê Ïù¥ÏÉÅ, Î∂ÄÏÉÅ Ïãú 2ÏñµÏõê Ïù¥ÏÉÅ ÏÜêÌï¥Î∞∞ÏÉÅ`,
                    `Ï†ú16Ï°∞(ÏïàÏ†ÑÎ≥¥Í±¥Í¥ÄÎ¶¨Ï≤¥Ï†ú) - 50Ïù∏ Ïù¥ÏÉÅ ÏÇ¨ÏóÖÏû• Ï±ÖÏûÑÏûê ÏÑ†ÏûÑ ÏùòÎ¨¥, ÎØ∏ÏÑ†ÏûÑ Ïãú 5Ï≤úÎßåÏõê Í≥ºÌÉúÎ£å`,
                    `Ï†ú36Ï°∞(ÏúÑÌóòÏÑ±ÌèâÍ∞Ä) - Î∂ÑÍ∏∞ 1Ìöå Ïã§Ïãú, Í≥†ÏúÑÌóò ÏûëÏóÖÏû• Îß§Ïõî Ïã§Ïãú, ÌèâÍ∞Ä ÎØ∏Ïã§Ïãú Ïãú ÏûëÏóÖÏ§ëÏßÄÎ™ÖÎ†π`,
                    `Ï†ú162Ï°∞(Î≤®Ïπô) - ÏûëÏóÖÏ§ëÏßÄÎ™ÖÎ†π ÏúÑÎ∞ò Ïãú 5ÎÖÑ Ïù¥Ìïò ÏßïÏó≠ ÎòêÎäî 5Ï≤úÎßåÏõê Ïù¥Ìïò Î≤åÍ∏à`
                ],
                'ÌôòÍ≤Ω': [
                    `Ï†ú16Ï°∞(Î∞∞Ï∂úÌóàÏö©Í∏∞Ï§Ä) - ÏßàÏÜåÏÇ∞ÌôîÎ¨º(NOx) 30% Í∞ïÌôî, Ï¥ùÏù∏(T-P) 0.1mg/L Ïù¥Ìïò`,
                    `Ï†ú31Ï°∞(TMS ÏÑ§Ïπò) - 2Ï¢Ö ÏÇ¨ÏóÖÏû•ÍπåÏßÄ ÌôïÎåÄ, Ïã§ÏãúÍ∞Ñ Ï†ÑÏÜ°ÏùòÎ¨¥, Ï°∞Ïûë Ïãú 5ÎÖÑ Ïù¥Ìïò ÏßïÏó≠`,
                    `Ï†ú42Ï°∞(ÌÉÑÏÜåÏ§ëÎ¶Ω) - 2030ÎÖÑ Ïò®Ïã§Í∞ÄÏä§ 40% Í∞êÏ∂ï, 2050ÎÖÑ ÌÉÑÏÜåÏ§ëÎ¶Ω Îã¨ÏÑ± ÏùòÎ¨¥`,
                    `Ï†ú94Ï°∞(Í≥ºÏßïÍ∏à) - Î∞∞Ï∂úÍ∏∞Ï§Ä Ï¥àÍ≥º Ïãú ÏµúÎåÄ 5ÏñµÏõê, ÌóàÏúÑÏ∏°Ï†ï Ïãú ÏòÅÏóÖÏ†ïÏßÄ 1ÎÖÑ`
                ],
                'Ïù∏ÏÇ¨ÎÖ∏Î¨¥': [
                    `Ï†ú50Ï°∞(Í∑ºÎ°úÏãúÍ∞Ñ) - Ï£º 52ÏãúÍ∞Ñ Ï†úÌïú, Ïó∞Ïû•Í∑ºÎ°ú Ïó∞ 300ÏãúÍ∞Ñ Ïù¥ÎÇ¥, 11ÏãúÍ∞Ñ Ïó∞ÏÜçÌú¥Ïãù`,
                    `Ï†ú74Ï°∞(Ïú°ÏïÑÌú¥ÏßÅ) - Í∏âÏó¨ ÏÉÅÌïú Ïõî 200ÎßåÏõê, Î∂ÄÎ∂Ä ÎèôÏãú ÏÇ¨Ïö© Í∞ÄÎä•, Í∏∞Í∞Ñ 2ÎÖÑÍπåÏßÄ Ïó∞Ïû•`,
                    `Ï†ú76Ï°∞Ïùò2(ÏßÅÏû•ÎÇ¥ Í¥¥Î°≠Ìûò) - Í∞ÄÌï¥Ïûê Ï¶âÏãú Í≤©Î¶¨, 1Ï≤úÎßåÏõê Ïù¥Ìïò Í≥ºÌÉúÎ£å, 3Ìöå Ïù¥ÏÉÅ Ïãú ÌòïÏÇ¨Ï≤òÎ≤å`,
                    `Ï†ú115Ï°∞(ÏÑ±Î≥Ñ ÏûÑÍ∏àÍ≥µÏãú) - ÏûÑÍ∏à Ï∞®Ïù¥ Ïù¥Ïú† ÏÑ§Î™Ö ÏùòÎ¨¥, ÎØ∏Í≥µÏãú Ïãú 2Ï≤úÎßåÏõê Í≥ºÌÉúÎ£å`
                ],
                'Ïû¨Î¨¥ÌöåÍ≥Ñ': [
                    `Ï†ú161Ï°∞(ESG Í≥µÏãú) - ÏÇ¨ÏóÖÎ≥¥Í≥†ÏÑúÏóê ÏßÄÏÜçÍ∞ÄÎä•Í≤ΩÏòÅ Ìè¨Ìï®, TCFD Í∏∞Ï§Ä Ï§ÄÏàò`,
                    `Ï†ú290Ï°∞(ÎÇ¥Î∂ÄÌöåÍ≥ÑÍ¥ÄÎ¶¨) - CEO/CFO Ïù∏Ï¶ù ÏùòÎ¨¥, ÏúÑÎ∞ò Ïãú 5ÎÖÑ Ïù¥Ìïò ÏßïÏó≠ ÎòêÎäî 5ÏñµÏõê Î≤åÍ∏à`,
                    `Ï†ú542Ï°∞(Í∞êÏÇ¨Ïù∏ ÏßÄÏ†ï) - Ï£ºÍ∏∞Ï†Å ÏßÄÏ†ïÏ†ú Ï†ÅÏö©, Ïó∞ÏÜç 4Í∏∞ Ï¥àÍ≥º Í∏àÏßÄ, ÎπÑÍ∞êÏÇ¨Ïö©Ïó≠ Ï†úÌïú Í∞ïÌôî`,
                    `Ï†ú116Ï°∞(Ï†ÑÏûêÏÑ∏Í∏àÍ≥ÑÏÇ∞ÏÑú) - 2025ÎÖÑ 7ÏõîÎ∂ÄÌÑ∞ ÏùòÎ¨¥Ìôî, ÎØ∏Ï†úÏ∂ú Ïãú 1% Í∞ÄÏÇ∞ÏÑ∏`
                ],
                'Ï†ïÎ≥¥Î≥¥Ìò∏': [
                    `Ï†ú22Ï°∞(Í∞úÏù∏Ï†ïÎ≥¥ ÏàòÏßë) - ÏÉùÏ≤¥Ï†ïÎ≥¥ ÏóÑÍ≤© Í¥ÄÎ¶¨, ÏïÑÎèô Ï†ïÎ≥¥ ÌäπÎ≥ÑÎ≥¥Ìò∏, 14ÏÑ∏ ÎØ∏Îßå ÎèôÏùò Í∏àÏßÄ`,
                    `Ï†ú34Ï°∞Ïùò2(ISMS-P) - Ïó∞Îß§Ï∂ú 100Ïñµ Ïù¥ÏÉÅ ÏùòÎ¨¥, ÎØ∏Ïù∏Ï¶ù Ïãú 3% Í≥ºÏßïÍ∏à`,
                    `Ï†ú39Ï°∞(Ïú†Ï∂úÏã†Í≥†) - 24ÏãúÍ∞Ñ ÎÇ¥ Ïã†Í≥†, 3Ïùº ÎÇ¥ ÌÜµÏßÄ, ÏùÄÌèê Ïãú 5ÎÖÑ Ïù¥Ìïò ÏßïÏó≠`,
                    `Ï†ú75Ï°∞(CISO) - 1Ï≤úÎ™Ö Ïù¥ÏÉÅ Í∞úÏù∏Ï†ïÎ≥¥ Ï≤òÎ¶¨ Ïãú CISO ÏßÄÏ†ï ÏùòÎ¨¥`
                ],
                'ÏßÄÎ∞∞Íµ¨Ï°∞': [
                    `Ï†ú382Ï°∞(ÎèÖÎ¶ΩÏù¥ÏÇ¨) - ÏÉÅÏû•ÌöåÏÇ¨ Í≥ºÎ∞òÏàò ÏùòÎ¨¥, ÏûêÏÇ∞ 2Ï°∞Ïõê Ïù¥ÏÉÅ Í∏∞ÏóÖ Ï†ÅÏö©`,
                    `Ï†ú434Ï°∞(Ï†ÑÏûêÌà¨Ìëú) - ÏûêÏÇ∞ 1Ï°∞Ïõê Ïù¥ÏÉÅ ÏùòÎ¨¥Ìôî, ÎØ∏Ïã§Ïãú Ïãú 1ÏñµÏõê Í≥ºÌÉúÎ£å`,
                    `Ï†ú570Ï°∞(ÏûÑÏõêÎ≥¥Ïàò) - Í∞úÎ≥Ñ 5ÏñµÏõê Ïù¥ÏÉÅ Í≥µÏãú, Î≥¥ÏàòÏúÑÏõêÌöå ÏÑ§Ïπò ÏùòÎ¨¥`,
                    `Ï†ú542Ï°∞Ïùò2(ESGÏúÑÏõêÌöå) - ÏûêÏÇ∞ 2Ï°∞Ïõê Ïù¥ÏÉÅ ÏÑ§Ïπò ÏùòÎ¨¥, Ïó∞ 2Ìöå Ïù¥ÏÉÅ Í≥µÏãú`
                ],
                'Í≥µÏ†ïÍ±∞Îûò': [
                    `Ï†ú3Ï°∞Ïùò2(ÏãúÏû•ÏßÄÎ∞∞Ï†Å ÏßÄÏúÑ) - Ïò®ÎùºÏù∏ ÌîåÎû´Ìèº 30% Ïù¥ÏÉÅ Ï†êÏú† Ïãú Í∑úÏ†ú, ÏïåÍ≥†Î¶¨Ï¶ò Í≥µÍ∞ú ÏùòÎ¨¥`,
                    `Ï†ú6Ï°∞(Í∏∞Ïà†ÌÉàÏ∑®) - ÏßïÎ≤åÏ†Å ÏÜêÌï¥Î∞∞ÏÉÅ 3Î∞∞, ÌòïÏÇ¨Ï≤òÎ≤å 3ÎÖÑ Ïù¥Ìïò ÏßïÏó≠`,
                    `Ï†ú19Ï°∞(ÌïòÎèÑÍ∏âÎåÄÍ∏à) - 30Ïùº Ïù¥ÎÇ¥ ÏßÄÍ∏â ÏùòÎ¨¥, Ïó∞Ï≤¥ Ïãú 15% ÏßÄÏó∞Ïù¥Ïûê`,
                    `Ï†ú85Ï°∞(ÏÜåÎπÑÏûêÌîºÌï¥) - ÏßëÎã®ÏÜåÏÜ° ÌóàÏö©, ÏûÖÏ¶ùÏ±ÖÏûÑ Ï†ÑÌôò, Î¶¨ÏΩú Î∂àÏù¥Ìñâ Ïãú 3% Í≥ºÏßïÍ∏à`
                ],
                'ÏßÄÏãùÏû¨ÏÇ∞Í∂å': [
                    `Ï†ú2Ï°∞Ïùò2(AI Ï†ÄÏûëÎ¨º) - AI ÏÉùÏÑ±Î¨º Ï†ÄÏûëÍ∂å Ïù∏Ï†ï, NFT Ï†ÄÏûëÍ∂å Î≥¥Ìò∏, Í≥µÏ†ïÏù¥Ïö© Î≤îÏúÑ ÌôïÎåÄ`,
                    `Ï†ú100Ï°∞(ÌäπÌóàÎ¨¥Ìö®) - NPE Í∂åÎ¶¨ÌñâÏÇ¨ Ï†úÌïú, FRAND ÏúÑÎ∞ò Ïãú ÌäπÌóàÍ∂å Ï†úÌïú`,
                    `Ï†ú129Ï°∞(ÏòÅÏóÖÎπÑÎ∞Ä) - Ï†ÑÏßÅÍ∏àÏßÄ 3ÎÖÑ, ÏúÑÎ∞ò Ïãú 10Î∞∞ Î∞∞ÏÉÅ, Ìï¥Ïô∏Ïú†Ï∂ú Ïãú 10ÎÖÑ Ïù¥Ìïò ÏßïÏó≠`,
                    `Ï†ú163Ï°∞(Ï§ëÏÜåÍ∏∞ÏóÖ ÏßÄÏõê) - ÌäπÌóà Î∞©Ïñ¥ÎπÑÏö© ÏßÄÏõê, ÏÜåÏÜ°ÎπÑÏö© ÎåÄÏó¨ Ï†úÎèÑ`
                ]
            };
            
            const templates = articleTemplates[category] || [
                `Ï†ú4Ï°∞(Ï†ÅÏö©Î≤îÏúÑ) - Ï†ÅÏö© ÎåÄÏÉÅ Î∞è Î≤îÏúÑ Î™ÖÌôïÌôî`,
                `Ï†ú10Ï°∞(Ï†àÏ∞®Í∑úÏ†ï) - ÌñâÏ†ïÏ†àÏ∞® Í∞ÑÏÜåÌôî Î∞è Ï≤òÎ¶¨Í∏∞Ìïú Îã®Ï∂ï`,
                `Ï†ú17Ï°∞(Î≤åÏπôÍ∑úÏ†ï) - ÏúÑÎ∞ò Ïãú Ï†úÏû¨ ÏàòÏ§Ä Ï°∞Ï†ï Î∞è Íµ¨Ï†úÏ†àÏ∞® Í∞úÏÑ†`
            ];
            
            const selectedArticles = [...templates].sort(() => 0.5 - Math.random()).slice(0, 3);
            
            return `
                <p><strong>Ï£ºÏöî Í∞úÏ†ï Ï°∞Ìï≠:</strong></p>
                <ul>
                    ${selectedArticles.map(article => `<li>${article}</li>`).join('')}
                </ul>
                <p><em>‚Äª ÏÉÅÏÑ∏Ìïú Ï°∞Î¨∏ ÎÇ¥Ïö©ÏùÄ Íµ≠Í∞ÄÎ≤ïÎ†πÏ†ïÎ≥¥ÏÑºÌÑ∞ÏóêÏÑú ÌôïÏù∏ÌïòÏãúÍ∏∞ Î∞îÎûçÎãàÎã§.</em></p>
            `;
        }


        function closeLawModal() {
            document.getElementById('law-modal').classList.remove('show');
        }

        function closeQuarterlyModal() {
            document.getElementById('quarterly-modal').classList.remove('show');
        }

        function scrollToCategory(category) {
            const targetElement = document.getElementById(`category-${category}`);
            if (targetElement) {
                // Ïä§Î¨¥Ïä§ Ïä§ÌÅ¨Î°§ Ìö®Í≥ºÎ°ú Ìï¥Îãπ Ïπ¥ÌÖåÍ≥†Î¶¨Î°ú Ïù¥Îèô
                targetElement.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start',
                    inline: 'nearest'
                });
                
                // ÏãúÍ∞ÅÏ†Å ÌîºÎìúÎ∞±ÏùÑ ÏúÑÌïú ÌïòÏù¥ÎùºÏù¥Ìä∏ Ìö®Í≥º
                const header = targetElement.querySelector('div:first-child');
                if (header) {
                    const originalStyle = header.style.transform;
                    header.style.transform = 'scale(1.02)';
                    header.style.transition = 'transform 0.3s ease';
                    
                    setTimeout(() => {
                        header.style.transform = originalStyle;
                    }, 300);
                }
            }
        }



        // 207Í∞ú Í∏∞Î≥∏ Î≤ïÍ∑ú Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•Ïö© Ï†ÑÏó≠ Î≥ÄÏàò
        let baseLawsData = [];
        
        // 207Í∞ú Í∏∞Î≥∏ Î≤ïÍ∑ú Î°úÎìú Ìï®Ïàò
        async function loadBaseLaws() {
            try {
                // ALWAYS load from base_laws_207.json - ignore localStorage for law registry
                // localStorageÎäî Îã§Î•∏ Ïö©ÎèÑÎ°ú ÏÇ¨Ïö©Îê† Ïàò ÏûàÏúºÎØÄÎ°ú Ï†ÅÏö©Î≤ïÍ∑ú ÌÉ≠ÏùÄ Ìï≠ÏÉÅ 207Í∞ú Í∏∞Î≥∏ Î≤ïÍ∑úÎßå ÏÇ¨Ïö©
                const response = await fetch('./base_laws_207.json');
                const data = await response.json();
                console.log('üìä Ï†ÅÏö©Î≤ïÍ∑ú ÌÉ≠: Í∏∞Î≥∏ Î≤ïÍ∑ú Îç∞Ïù¥ÌÑ∞(base_laws_207.json) 207Í∞ú Î°úÎìú');
                
                baseLawsData = data.items || [];
                console.log(`‚úÖ ${baseLawsData.length}Í∞ú Í∏∞Î≥∏ Î≤ïÍ∑ú Î°úÎìú ÏôÑÎ£å`);
                
                // Ï†ÅÏö©Î≤ïÍ∑ú ÌÉ≠ Ïπ¥Ïö¥Ìä∏ ÏóÖÎç∞Ïù¥Ìä∏
                updateRegistryTabCounts();
                
                // Ï¥àÍ∏∞ Ï†ÑÏ≤¥ Î≤ïÍ∑ú ÌëúÏãú
                showJobFunctionLaws('all', 'Ï†ÑÏ≤¥');
            } catch (error) {
                console.error('Í∏∞Î≥∏ Î≤ïÍ∑ú Î°úÎìú Ïã§Ìå®:', error);
            }
        }
        
        // Ï†ÅÏö©Î≤ïÍ∑ú ÌÉ≠ Ïπ¥Ïö¥Ìä∏ ÏóÖÎç∞Ïù¥Ìä∏ (207Í∞ú Í∏∞Î≥∏ Î≤ïÍ∑ú Í∏∞Ï§Ä)
        function updateRegistryTabCounts() {
            if (baseLawsData.length === 0) return;
            
            // Ïπ¥ÌÖåÍ≥†Î¶¨Î≥Ñ Ïπ¥Ïö¥Ìä∏ Í≥ÑÏÇ∞
            const categoryCounts = {
                "ÌôòÍ≤Ω": 0,
                "Ïù∏ÏÇ¨ÎÖ∏Î¨¥": 0,
                "ÏïàÏ†Ñ": 0,
                "Ïû¨Î¨¥ÌöåÍ≥Ñ": 0,
                "Ï†ïÎ≥¥Î≥¥Ìò∏": 0,
                "Í≥µÏ†ïÍ±∞Îûò": 0,
                "ÏßÄÏãùÏû¨ÏÇ∞Í∂å": 0,
                "ÏßÄÎ∞∞Íµ¨Ï°∞": 0
            };
            
            baseLawsData.forEach(law => {
                if (law.categories && law.categories.length > 0) {
                    law.categories.forEach(category => {
                        if (categoryCounts.hasOwnProperty(category)) {
                            categoryCounts[category]++;
                        }
                    });
                }
            });
            
            // Í∞Å ÏßÅÎ¨¥Î≥Ñ Ïπ¥Ïö¥Ìä∏ ÏóÖÎç∞Ïù¥Ìä∏  
            Object.keys(categoryCounts).forEach(category => {
                const countElement = document.querySelector(`#job-count-${category}`);
                if (countElement) {
                    countElement.textContent = categoryCounts[category];
                }
            });
            
            // Ï†ÑÏ≤¥ Ïπ¥Ïö¥Ìä∏ ÏóÖÎç∞Ïù¥Ìä∏
            const totalCount = baseLawsData.length;
            const allCountElement = document.querySelector('#job-count-all');
            if (allCountElement) {
                allCountElement.textContent = totalCount;
            }
            
            // registry-total-count ÏóÖÎç∞Ïù¥Ìä∏
            const registryTotalElement = document.getElementById('registry-total-count');
            if (registryTotalElement) {
                registryTotalElement.textContent = totalCount;
            }
            
            // Ï†ÅÏö©Î≤ïÍ∑ú ÌÉ≠ Ïπ¥Ïö¥Ìä∏ ÏóÖÎç∞Ïù¥Ìä∏
            const tabCountElement = document.getElementById('lawregistry-tab-count');
            if (tabCountElement) {
                tabCountElement.textContent = totalCount;
            }
            
            console.log('‚úÖ Ï†ÅÏö©Î≤ïÍ∑ú ÌÉ≠ Ïπ¥Ïö¥Ìä∏ ÏóÖÎç∞Ïù¥Ìä∏ ÏôÑÎ£å - Ï¥ù', totalCount, 'Í∞ú (207Í∞ú Í∏∞Î≥∏ Î≤ïÍ∑ú)');
            console.log('Ïπ¥ÌÖåÍ≥†Î¶¨Î≥Ñ:', categoryCounts);
        }
        
        // Law Registry Tab Functions
        function showJobFunctionLaws(jobFunction, jobTitle) {
            console.log('Showing laws for job function:', jobFunction);
            
            // Update active job function
            document.querySelectorAll('.job-function-item').forEach(item => {
                item.classList.remove('active');
            });
            document.querySelector(`[data-job="${jobFunction}"]`).classList.add('active');
            
            // 207Í∞ú Í∏∞Î≥∏ Î≤ïÍ∑ú ÏÇ¨Ïö© (base_laws_207.json)
            const baseLaws = baseLawsData;
            
            // Filter laws based on job function
            let filteredLaws;
            if (jobFunction === 'all') {
                filteredLaws = baseLaws;
            } else {
                filteredLaws = baseLaws.filter(law => 
                    law.categories && law.categories.includes(jobFunction)
                );
            }
            
            // Î≤ïÎ†πÎ™Ö Í∞ÄÎÇòÎã§ÏàúÏúºÎ°ú Ï†ïÎ†¨
            filteredLaws.sort((a, b) => {
                return a.title.localeCompare(b.title, 'ko-KR');
            });
            
            // Update header (fix icon duplication issue)
            if (jobFunction === 'all') {
                document.getElementById('job-function-icon').textContent = 'üìã';
                document.getElementById('job-function-title').textContent = 'Ï†ÑÏ≤¥ Ï†ÅÏö© Î≤ïÍ∑ú';
            } else {
                // Extract icon from jobTitle and clean title
                const parts = jobTitle.split(' ');
                const icon = parts[0]; // First part is the icon (e.g., 'üë•')
                const title = parts.slice(1).join(' '); // Rest is the title
                
                document.getElementById('job-function-icon').textContent = icon;
                document.getElementById('job-function-title').textContent = title + ' Ï†ÅÏö© Î≤ïÍ∑ú';
            }
            document.getElementById('job-function-count').textContent = `${filteredLaws.length}Í±¥`;
            
            // Generate simplified law list (law name only, direct link to law center)
            const lawsHtml = filteredLaws.map((law, index) => {
                // Íµ≠Í∞ÄÎ≤ïÎ†πÏ†ïÎ≥¥ÏÑºÌÑ∞Î°ú ÏßÅÏ†ë ÎßÅÌÅ¨ (Î≤ïÎ†πÎ™ÖÏúºÎ°ú Í≤ÄÏÉâ)
                const lawUrl = `https://www.law.go.kr/lsSc.do?query=${encodeURIComponent(law.title)}`;
                const safeUrl = lawUrl.replace(/'/g, '&quot;');
                
                // Î≤ïÎ†π Ï¢ÖÎ•ò ÌëúÏãú
                const lawType = law.lawType || 'Î≤ïÎ•†';
                
                return `
                    <div class="registry-law-item" onclick="window.open('${safeUrl}', '_blank'); return false;" title="${law.title}">
                        <div class="registry-law-number">${index + 1}.</div>
                        <div class="registry-law-title" style="flex: 1;">${law.title}</div>
                        <div class="registry-law-type" style="padding: 0 10px; color: var(--text-muted); font-size: 0.85rem;">${lawType}</div>
                        <div class="registry-law-link">
                            <span>üîó</span>
                            <span>Íµ≠Í∞ÄÎ≤ïÎ†πÏ†ïÎ≥¥ÏÑºÌÑ∞</span>
                        </div>
                    </div>
                `;
            }).join('');
            
            // Update laws panel
            if (filteredLaws.length > 0) {
                document.getElementById('job-function-laws').innerHTML = lawsHtml;
            } else {
                document.getElementById('job-function-laws').innerHTML = `
                    <div style="padding: 2rem; text-align: center; color: var(--text-muted);">
                        Ìï¥Îãπ ÏßÅÎ¨¥Ïóê Ï†ÅÏö©ÎêòÎäî Î≤ïÍ∑úÍ∞Ä ÏóÜÏäµÎãàÎã§.
                    </div>
                `;
            }
        }

        function updateJobFunctionCounts() {
            // Ïù¥ Ìï®ÏàòÎäî ÏÇ¨Ïö©ÌïòÏßÄ ÏïäÏùå - updateJobFunctionDataWithCompanyLawsÍ∞Ä ÎåÄÏ≤¥
            // Ï†ÅÏö©Î≤ïÍ∑ú ÌÉ≠ÏùÄ Ïú†ÎãàÌÅ¨ Î≤ïÎ†πÎßå Ïπ¥Ïö¥Ìä∏Ìï¥Ïïº ÌïòÎØÄÎ°ú
            return;
        }



        function getDaysFromNow(dateStr) {
            if (!dateStr) return null;
            const targetDate = new Date(dateStr);
            // 2025ÎÖÑ ÏãúÎÆ¨Î†àÏù¥ÏÖòÏùÑ ÏúÑÌïú ÎÇ†Ïßú ÏÑ§Ï†ï
            const today = new Date('2025-09-04');
            const diffTime = targetDate - today;
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            return diffDays;
        }

        function showError(message) {
            document.getElementById('law-list').innerHTML = `<div class="error">${message}</div>`;
            document.getElementById('law-count').textContent = '(Ïò§Î•ò)';
        }

        // Modal Ïô∏Î∂Ä ÌÅ¥Î¶≠ Ïãú Îã´Í∏∞
        document.getElementById('law-modal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeLawModal();
            }
        });
        
        document.getElementById('quarterly-modal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeQuarterlyModal();
            }
        });

        // ===========================================
        // localStorage Ï≤≠ÏÜå Ìï®Ïàò (ÎîîÎ≤ÑÍπÖÏö©)
        function clearLawsLocalStorage() {
            localStorage.removeItem('laws_updated_flag');
            localStorage.removeItem('applied_laws');
            localStorage.removeItem('updated_laws_data');
            console.log('‚úÖ localStorageÏóêÏÑú Î≤ïÍ∑ú Í¥ÄÎ†® Îç∞Ïù¥ÌÑ∞ ÏÇ≠Ï†ú ÏôÑÎ£å');
        }
        
        // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú localStorage Ï≤≠ÏÜå (ÏûòÎ™ªÎêú Îç∞Ïù¥ÌÑ∞ Î∞©ÏßÄ)
        clearLawsLocalStorage();
        
        // ===========================================
        // Ïù¥Î©îÏùº ÏïåÎ¶º ÏÑ§Ï†ï ÏãúÏä§ÌÖú
        // ===========================================

        // EmailJS Ï¥àÍ∏∞Ìôî ÏÉÅÌÉú
        let emailjsInitialized = false;
        let emailjsConfig = {
            publicKey: '',
            serviceId: '',
            templateId: ''
        };

        // ÏÑ§Ï†ï Î™®Îã¨ Ïó¥Í∏∞/Îã´Í∏∞
        // Îã§Ïö¥Î°úÎìú Î™®Îã¨ Ïó¥Í∏∞
        function openDownloadModal() {
            document.getElementById('download-modal').classList.add('show');
        }
        
        // Îã§Ïö¥Î°úÎìú Î™®Îã¨ Îã´Í∏∞
        function closeDownloadModal() {
            document.getElementById('download-modal').classList.remove('show');
        }
        
        // Ï†ÑÏ≤¥ Î≤ïÎ†π Îã§Ïö¥Î°úÎìú
        function downloadAllLaws() {
            // Ïã§Ï†ú 2025ÎÖÑ Ï†ÑÏ≤¥ Î≤ïÎ†π ÌååÏùº Îã§Ïö¥Î°úÎìú
            const link = document.createElement('a');
            link.href = './2025_laws_complete.xlsx';
            link.download = '2025_laws_complete.xlsx';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
        
        // Îß§Ïπ≠ Í≤∞Í≥º Îã§Ïö¥Î°úÎìú
        function downloadMatchedLaws() {
            // Ïã§Ï†ú Îß§Ïπ≠ Í≤∞Í≥º ÌååÏùº Îã§Ïö¥Î°úÎìú
            const link = document.createElement('a');
            link.href = './matched_laws_2025.xlsx';
            link.download = 'matched_laws_2025.xlsx';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
        
        // Í∏∞Ï°¥ Îß§Ïπ≠ Ìï®Ïàò Î∞±ÏóÖ (ÌïÑÏöîÏãú ÏÇ¨Ïö©)
        function downloadMatchedLawsOld() {
            // lawsDataÍ∞Ä ÏóÜÏúºÎ©¥ index.json Î°úÎìú
            if (!window.lawsData || lawsData.length === 0) {
                fetch('./index.json')
                    .then(response => response.json())
                    .then(data => {
                        const excelData = data.items.map(law => ({
                            'Î≤ïÎ†πÎ™Ö': law.title,
                            'ÏãúÌñâÏùº': law.effectiveDate,
                            'ÏßÅÎ¨¥': law.categories ? law.categories.join(', ') : '',
                            'Î∂ÄÏ≤ò': law.ministry || '',
                            'Î≤ïÎ†πÏú†Ìòï': law.lawType || ''
                        }));
                        
                        const ws = XLSX.utils.json_to_sheet(excelData);
                        const wb = XLSX.utils.book_new();
                        XLSX.utils.book_append_sheet(wb, ws, 'Îß§Ïπ≠Í≤∞Í≥º');
                        XLSX.writeFile(wb, 'Îß§Ïπ≠Í≤∞Í≥º_259.xlsx');
                    })
                    .catch(error => {
                        console.error('Failed to load data:', error);
                        alert('Îç∞Ïù¥ÌÑ∞ Î°úÎìú Ïã§Ìå®. Ïû†Ïãú ÌõÑ Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.');
                    });
            } else {
                const data = lawsData.map(law => ({
                    'ÏãúÌñâÏùº': law.effectiveDate,
                    'ÏßÅÎ¨¥': law.categories ? law.categories.join(', ') : '',
                    'Î∂ÄÏ≤ò': law.ministry || '',
                    'Î≤ïÎ†πÏú†Ìòï': law.lawType || ''
                }));
                
                const ws = XLSX.utils.json_to_sheet(data);
                const wb = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(wb, ws, 'Îß§Ïπ≠Í≤∞Í≥º');
                XLSX.writeFile(wb, 'Îß§Ïπ≠Í≤∞Í≥º_259.xlsx');
            }
        }
        
        // Í∏∞Î≥∏ Î≤ïÍ∑ú Îã§Ïö¥Î°úÎìú (Excel ÌòïÏãùÏúºÎ°ú Î≥ÄÌôò)
        function downloadBaseLaws() {
            // base_laws_207.json(ÎãπÏÇ¨ Í∏∞Î≥∏ Ï†ÅÏö©Î≤ïÍ∑ú)ÏùÑ ExcelÎ°ú Î≥ÄÌôòÌïòÏó¨ Îã§Ïö¥Î°úÎìú
            fetch('./base_laws_207.json')
                .then(response => response.json())
                .then(data => {
                    const excelData = data.items.map((law, index) => ({
                        'Î≤àÌò∏': index + 1,
                        'Î≤ïÎ†πÎ™Ö': law.title,
                        'ÏßÅÎ¨¥Î∂ÑÎ•ò': law.categories ? law.categories.join(', ') : '',
                        'Î≤ïÎ†πÏú†Ìòï': law.lawType || 'Î≤ïÎ•†',
                        'Ï£ºÎ¨¥Î∂ÄÏ≤ò': law.ministry || getMinistryName(law.title, law.categories) || 'Í¥ÄÍ≥ÑÎ∂ÄÏ≤ò',
                        'ÎπÑÍ≥†': law.note || ''
                    }));
                    
                    // Excel ÌååÏùº ÏÉùÏÑ±
                    const ws = XLSX.utils.json_to_sheet(excelData);
                    const wb = XLSX.utils.book_new();
                    XLSX.utils.book_append_sheet(wb, ws, 'ÎãπÏÇ¨Ï†ÅÏö©Î≤ïÍ∑ú_207');
                    
                    // Ïª¨Îüº ÎÑàÎπÑ Ï°∞Ï†ï
                    const colWidths = [
                        { wch: 8 },  // Î≤àÌò∏
                        { wch: 50 }, // Î≤ïÎ†πÎ™Ö
                        { wch: 20 }, // ÏßÅÎ¨¥Î∂ÑÎ•ò
                        { wch: 15 }, // Î≤ïÎ†πÏú†Ìòï
                        { wch: 20 }, // Ï£ºÎ¨¥Î∂ÄÏ≤ò
                        { wch: 15 }  // ÎπÑÍ≥†
                    ];
                    ws['!cols'] = colWidths;
                    
                    XLSX.writeFile(wb, 'base_laws_207.xlsx');
                })
                .catch(error => {
                    console.error('Download error:', error);
                    alert('Îã§Ïö¥Î°úÎìú Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.');
                });
        }
        
        function openSettingsModal() {
            const modal = document.getElementById('settings-modal');
            modal.classList.add('show');
            loadEmailSettings();
            loadQuarterlyDataForEmail(); // Ïã§Ï†ú Îç∞Ïù¥ÌÑ∞ Î°úÎìú
            updateEmailPreview();
        }

        function closeSettingsModal() {
            const modal = document.getElementById('settings-modal');
            modal.classList.remove('show');
        }

        // Î°úÏª¨ Ïä§ÌÜ†Î¶¨ÏßÄÏóêÏÑú ÏÑ§Ï†ï Î∂àÎü¨Ïò§Í∏∞
        function loadEmailSettings() {
            const settings = getEmailSettings();
            
            document.getElementById('email-recipients').value = settings.recipients.join('\n');
            document.getElementById('sender-name').value = settings.senderName;
            document.getElementById('notify-q1').checked = settings.quarters.Q1;
            document.getElementById('notify-q2').checked = settings.quarters.Q2;
            document.getElementById('notify-q3').checked = settings.quarters.Q3;
            document.getElementById('notify-q4').checked = settings.quarters.Q4;
            
            // EmailJS ÏÑ§Ï†ï Î∂àÎü¨Ïò§Í∏∞
            const emailjsSettings = getEmailJSSettings();
            document.getElementById('emailjs-public-key').value = emailjsSettings.publicKey;
            document.getElementById('emailjs-service-id').value = emailjsSettings.serviceId;
            document.getElementById('emailjs-template-id').value = emailjsSettings.templateId;
            
            // EmailJS Ï¥àÍ∏∞Ìôî ÏãúÎèÑ
            if (emailjsSettings.publicKey) {
                setupEmailJS();
            }
        }

        // ÏÑ§Ï†ï Ï†ÄÏû•
        function saveEmailSettings() {
            const recipients = document.getElementById('email-recipients').value
                .split('\n')
                .map(email => email.trim())
                .filter(email => email && isValidEmail(email));

            if (recipients.length === 0) {
                showNotification('error', 'Ïú†Ìö®Ìïú Ïù¥Î©îÏùº Ï£ºÏÜåÎ•º ÏµúÏÜå ÌïòÎÇò Ïù¥ÏÉÅ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }

            // Ïù¥Î©îÏùº ÏÑ§Ï†ï Ï†ÄÏû•
            const settings = {
                recipients: recipients,
                senderName: document.getElementById('sender-name').value.trim() || 'RegRader ÏãúÏä§ÌÖú',
                quarters: {
                    Q1: document.getElementById('notify-q1').checked,
                    Q2: document.getElementById('notify-q2').checked,
                    Q3: document.getElementById('notify-q3').checked,
                    Q4: document.getElementById('notify-q4').checked
                },
                lastUpdated: new Date().toISOString()
            };

            localStorage.setItem('lawwatch_email_settings', JSON.stringify(settings));

            // EmailJS ÏÑ§Ï†ïÎèÑ Ìï®Íªò Ï†ÄÏû•
            const emailjsSettings = {
                publicKey: document.getElementById('emailjs-public-key').value.trim(),
                serviceId: document.getElementById('emailjs-service-id').value.trim(),
                templateId: document.getElementById('emailjs-template-id').value.trim()
            };

            if (emailjsSettings.publicKey && emailjsSettings.serviceId && emailjsSettings.templateId) {
                localStorage.setItem('lawwatch_emailjs_settings', JSON.stringify(emailjsSettings));
                showNotification('success', `Î™®Îì† ÏÑ§Ï†ïÏù¥ Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§. ${recipients.length}Î™ÖÏùò ÏàòÏã†ÏûêÍ∞Ä Îì±Î°ùÎêòÏóàÏäµÎãàÎã§.`);
            } else {
                showNotification('success', `Ïù¥Î©îÏùº ÏÑ§Ï†ïÏù¥ Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§. EmailJS ÏÑ§Ï†ïÏùÑ ÏôÑÎ£åÌïòÎ©¥ ÏûêÎèô Î∞úÏÜ°Ïù¥ Í∞ÄÎä•Ìï©ÎãàÎã§.`);
            }
            
            scheduleNotifications();
        }

        // Í∏∞Î≥∏ ÏÑ§Ï†ï Î∞òÌôò
        function getEmailSettings() {
            const defaultSettings = {
                recipients: [],
                senderName: 'RegRader ÏãúÏä§ÌÖú',
                quarters: { Q1: true, Q2: true, Q3: true, Q4: true },
                lastUpdated: null
            };

            try {
                const saved = localStorage.getItem('lawwatch_email_settings');
                return saved ? { ...defaultSettings, ...JSON.parse(saved) } : defaultSettings;
            } catch (e) {
                return defaultSettings;
            }
        }

        // EmailJS ÏÑ§Ï†ï Î∞òÌôò
        function getEmailJSSettings() {
            const defaultSettings = {
                publicKey: '',
                serviceId: '',
                templateId: ''
            };

            try {
                const saved = localStorage.getItem('lawwatch_emailjs_settings');
                return saved ? { ...defaultSettings, ...JSON.parse(saved) } : defaultSettings;
            } catch (e) {
                return defaultSettings;
            }
        }

        // Ïù¥Î©îÏùº Ïú†Ìö®ÏÑ± Í≤ÄÏÇ¨
        function isValidEmail(email) {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return emailRegex.test(email);
        }

        // ÏïåÎ¶º ÌëúÏãú
        function showNotification(type, message) {
            const statusDiv = document.getElementById('notification-status');
            statusDiv.className = `notification-status ${type}`;
            statusDiv.textContent = message;
            statusDiv.style.display = 'block';

            setTimeout(() => {
                statusDiv.style.display = 'none';
            }, 5000);
        }

        // Ïù¥Î©îÏùº ÎØ∏Î¶¨Î≥¥Í∏∞ ÏóÖÎç∞Ïù¥Ìä∏
        function updateEmailPreview() {
            const currentQuarter = getCurrentQuarter();
            const nextQuarter = getNextQuarter();
            const quarterlyData = getQuarterlyData();
            
            const preview = `
                üìß Ï†úÎ™©: [RegRader] ${nextQuarter} ÏãúÌñâ ÏòàÏ†ï Î≤ïÎ†π ÏïåÎ¶º (${quarterlyData[nextQuarter]?.count || 0}Í±¥)
                
                ÏïàÎÖïÌïòÏÑ∏Ïöî, ${document.getElementById('sender-name').value || 'RegRader ÏãúÏä§ÌÖú'}ÏûÖÎãàÎã§.
                
                üóìÔ∏è ${nextQuarter} ÏãúÌñâ ÏòàÏ†ïÏù∏ ÎãπÏÇ¨ Ï†ÅÏö© Î≤ïÎ†π ${quarterlyData[nextQuarter]?.count || 0}Í±¥ÏùÑ ÏïàÎÇ¥ÎìúÎ¶ΩÎãàÎã§.
                
                Ï£ºÏöî Î≤ïÎ†π:
                ${quarterlyData[nextQuarter]?.laws?.slice(0, 3).map(law => `‚Ä¢ ${law.title}`).join('\n                ') || '‚Ä¢ Îç∞Ïù¥ÌÑ∞ Î°úÎî© Ï§ë...'}
                ${quarterlyData[nextQuarter]?.laws?.length > 3 ? '‚Ä¢ Í∑∏ Ïô∏ ' + (quarterlyData[nextQuarter].laws.length - 3) + 'Í±¥...' : ''}
                
                üìä Ï†ÑÏ≤¥ ÌòÑÌô© Î≥¥Í∏∞: https://your-domain.github.io/webapp/
                
                Ïù¥ Î©îÏùºÏùÄ Î∂ÑÍ∏∞ ÏãúÏûë 1Ï£ºÏùº Ï†ÑÏóê ÏûêÎèôÏúºÎ°ú Î∞úÏÜ°Îê©ÎãàÎã§.
            `;

            document.getElementById('email-preview-content').textContent = preview;
        }

        // ÌòÑÏû¨ Î∂ÑÍ∏∞ Í≥ÑÏÇ∞
        function getCurrentQuarter() {
            const month = new Date().getMonth() + 1;
            if (month <= 3) return 'Q1';
            if (month <= 6) return 'Q2';
            if (month <= 9) return 'Q3';
            return 'Q4';
        }

        // Îã§Ïùå Î∂ÑÍ∏∞ Í≥ÑÏÇ∞
        function getNextQuarter() {
            const current = getCurrentQuarter();
            const quarters = ['Q1', 'Q2', 'Q3', 'Q4'];
            const currentIndex = quarters.indexOf(current);
            return quarters[(currentIndex + 1) % 4];
        }

        // Ï†ÑÏó≠ Î≥ÄÏàòÎ°ú quarterly Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
        let globalQuarterlyData = {
            Q1: { count: 10, laws: [] },
            Q2: { count: 23, laws: [] },
            Q3: { count: 28, laws: [] },
            Q4: { count: 31, laws: [] }
        };

        // Î∂ÑÍ∏∞Î≥Ñ Îç∞Ïù¥ÌÑ∞ Í∞ÄÏ†∏Ïò§Í∏∞ (Ïã§Ï†ú Îç∞Ïù¥ÌÑ∞ ÌôúÏö©)
        function getQuarterlyData() {
            return globalQuarterlyData;
        }

        // quarterly_details.jsonÏóêÏÑú Ïã§Ï†ú Îç∞Ïù¥ÌÑ∞ Î°úÎìú
        function loadQuarterlyDataForEmail() {
            fetch('quarterly_details.json')
                .then(response => response.json())
                .then(data => {
                    globalQuarterlyData = {
                        Q1: { 
                            count: data.quarters.Q1.count, 
                            laws: data.quarters.Q1.laws.slice(0, 5) // ÏÉÅÏúÑ 5Í∞úÎßå
                        },
                        Q2: { 
                            count: data.quarters.Q2.count, 
                            laws: data.quarters.Q2.laws.slice(0, 5) 
                        },
                        Q3: { 
                            count: data.quarters.Q3.count, 
                            laws: data.quarters.Q3.laws.slice(0, 5) 
                        },
                        Q4: { 
                            count: data.quarters.Q4.count, 
                            laws: data.quarters.Q4.laws.slice(0, 5) 
                        }
                    };
                    updateEmailPreview(); // Îç∞Ïù¥ÌÑ∞ Î°úÎìú ÌõÑ ÎØ∏Î¶¨Î≥¥Í∏∞ ÏóÖÎç∞Ïù¥Ìä∏
                })
                .catch(e => {
                    console.log('quarterly_details.json Î°úÎìú Ïã§Ìå®, Í∏∞Î≥∏Í∞í ÏÇ¨Ïö©:', e);
                });
        }

        // EmailJS ÏÑ§Ï†ï Î∞è Ï¥àÍ∏∞Ìôî
        function setupEmailJS() {
            const publicKey = document.getElementById('emailjs-public-key').value.trim();
            const serviceId = document.getElementById('emailjs-service-id').value.trim();
            const templateId = document.getElementById('emailjs-template-id').value.trim();

            console.log('üîß EmailJS ÏÑ§Ï†ï ÏãúÎèÑ:');
            console.log('  Public Key:', publicKey);
            console.log('  Service ID:', serviceId);
            console.log('  Template ID:', templateId);

            if (!publicKey || !serviceId || !templateId) {
                showNotification('error', 'EmailJS Public Key, Service ID, Template IDÎ•º Î™®Îëê ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }

            try {
                // EmailJS Ï¥àÍ∏∞Ìôî
                console.log('üìß EmailJS Ï¥àÍ∏∞Ìôî Ï§ë...');
                emailjs.init({
                    publicKey: publicKey,
                    blockHeadless: true,
                    limitRate: {
                        throttle: 10000, // 10Ï¥àÏóê Ìïú Î≤àÎßå Î∞úÏÜ° Í∞ÄÎä•
                    }
                });
                
                emailjsConfig = { publicKey, serviceId, templateId };
                emailjsInitialized = true;

                // ÏÑ§Ï†ï Ï†ÄÏû•
                localStorage.setItem('lawwatch_emailjs_settings', JSON.stringify(emailjsConfig));
                
                console.log('‚úÖ EmailJS Ï¥àÍ∏∞Ìôî ÏôÑÎ£å');
                showNotification('success', 'EmailJS Ïó∞Í≤∞Ïù¥ ÏôÑÎ£åÎêòÏóàÏäµÎãàÎã§! Ïù¥Ï†ú ÌÖåÏä§Ìä∏ Î∞úÏÜ°ÏùÑ ÏãúÎèÑÌï¥Î≥¥ÏÑ∏Ïöî.');
                
            } catch (error) {
                console.error('‚ùå EmailJS Ï¥àÍ∏∞Ìôî Ïã§Ìå®:', error);
                showNotification('error', 'EmailJS Ï¥àÍ∏∞ÌôîÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§. Public KeyÎ•º ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî.');
                emailjsInitialized = false;
            }
        }

        // ÌÖåÏä§Ìä∏ Ïù¥Î©îÏùº Î∞úÏÜ° (ÏôÑÏ†ÑÌûà ÏÉàÎ°úÏö¥ Î≤ÑÏ†Ñ)
        function testEmailSending() {
            const recipients = document.getElementById('email-recipients').value
                .split('\n')
                .map(email => email.trim())
                .filter(email => email && isValidEmail(email));

            if (recipients.length === 0) {
                showNotification('error', 'Ïú†Ìö®Ìïú Ïù¥Î©îÏùº Ï£ºÏÜåÎ•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }

            if (!emailjsInitialized) {
                showNotification('error', 'EmailJS Ïó∞Í≤∞Ïù¥ ÌïÑÏöîÌï©ÎãàÎã§. Î®ºÏ†Ä "EmailJS Ïó∞Í≤∞" Î≤ÑÌäºÏùÑ ÌÅ¥Î¶≠Ìï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }

            showNotification('success', 'ÌÖåÏä§Ìä∏ Ïù¥Î©îÏùºÏùÑ Î∞úÏÜ° Ï§ëÏûÖÎãàÎã§...');
            
            // ÏßÅÏ†ë EmailJS Ìò∏Ï∂ú (Í∞ÑÎã®Ìïú ÌÖåÏä§Ìä∏)
            testDirectEmailSending(recipients[0])
                .then(() => {
                    showNotification('success', `ÌÖåÏä§Ìä∏ Ïù¥Î©îÏùºÏù¥ ${recipients[0]}ÏóêÍ≤å Î∞úÏÜ°ÎêòÏóàÏäµÎãàÎã§.`);
                })
                .catch((error) => {
                    console.error('Ïù¥Î©îÏùº Î∞úÏÜ° Ïã§Ìå®:', error);
                    showNotification('error', `Ïù¥Î©îÏùº Î∞úÏÜ° Ïã§Ìå®: ${error.message}`);
                });
        }

        // ÏßÅÏ†ë EmailJS ÌÖåÏä§Ìä∏ Ìï®Ïàò
        async function testDirectEmailSending(recipientEmail) {
            console.log('üìß ÏàòÏã†Ïûê:', recipientEmail);
            console.log('üîß EmailJS Config:', emailjsConfig);

            // Îß§Ïö∞ Í∞ÑÎã®Ìïú ÌÖåÏä§Ìä∏ Îç∞Ïù¥ÌÑ∞
            const testParams = {
                to_name: 'TEST_NAME',
                to_email: recipientEmail,
                from_name: 'TEST_FROM', 
                quarter: 'TEST_QUARTER',
                law_count: 'TEST_COUNT',
                law_list: 'TEST_LIST',
                website_url: 'TEST_URL'
            };

            console.log('üìã Ï†ÑÏÜ°Ìï† ÌååÎùºÎØ∏ÌÑ∞:', testParams);
            console.log('üìã ÌååÎùºÎØ∏ÌÑ∞ ÏÉÅÏÑ∏:');
            Object.keys(testParams).forEach(key => {
                console.log(`  - ${key}: "${testParams[key]}"`);
            });

            try {
                // EmailJS ÏßÅÏ†ë Ìò∏Ï∂ú
                const result = await emailjs.send(
                    emailjsConfig.serviceId,
                    emailjsConfig.templateId,
                    testParams
                );
                
                console.log('‚úÖ EmailJS ÏùëÎãµ ÏÑ±Í≥µ:', result);
                return result;
                
            } catch (error) {
                console.error('‚ùå EmailJS Ïò§Î•ò:', error);
                
                // ÏÉÅÏÑ∏ Ïò§Î•ò Ï†ïÎ≥¥
                if (error.status) {
                    console.error('HTTP ÏÉÅÌÉú:', error.status);
                }
                if (error.text) {
                    console.error('Ïò§Î•ò Î©îÏãúÏßÄ:', error.text);
                }
                
                throw new Error(`EmailJS Ïò§Î•ò: ${error.text || error.message}`);
            }
        }

        // Î∂ÑÍ∏∞Î≥Ñ Í∏∞Í∞Ñ Ï†ïÎ≥¥ Î∞òÌôò
        function getQuarterPeriod(quarter) {
            const periods = {
                'Q1': '1Î∂ÑÍ∏∞ (1Ïõî~3Ïõî)',
                'Q2': '2Î∂ÑÍ∏∞ (4Ïõî~6Ïõî)', 
                'Q3': '3Î∂ÑÍ∏∞ (7Ïõî~9Ïõî)',
                'Q4': '4Î∂ÑÍ∏∞ (10Ïõî~12Ïõî)'
            };
            return periods[quarter] || quarter;
        }

        // Ïã§Ï†ú Ïù¥Î©îÏùº Î∞úÏÜ° Ìï®Ïàò
        async function sendQuarterlyEmail(quarter, recipientEmail, isTest = false) {
            if (!emailjsInitialized) {
                throw new Error('EmailJSÍ∞Ä Ï¥àÍ∏∞ÌôîÎêòÏßÄ ÏïäÏïòÏäµÎãàÎã§.');
            }

            // Ïã§Ï†ú Îç∞Ïù¥ÌÑ∞ Í∞ïÏ†ú Î°úÎìú
            await loadQuarterlyDataForEmail();
            
            const quarterlyData = getQuarterlyData();
            let quarterData = quarterlyData[quarter] || { count: 0, laws: [] };
            
            // ÌÖåÏä§Ìä∏Ïö© Í∏∞Î≥∏ Îç∞Ïù¥ÌÑ∞ ÏÑ§Ï†ï
            if (isTest || quarterData.count === 0) {
                quarterData = {
                    count: 23,
                    laws: [
                        { title: 'Í∞úÏù∏Ï†ïÎ≥¥Î≥¥Ìò∏Î≤ï ÏãúÌñâÎ†π' },
                        { title: 'Í∑ºÎ°úÍ∏∞Ï§ÄÎ≤ï ÏãúÌñâÍ∑úÏπô' },
                        { title: 'ÏÇ∞ÏóÖÏïàÏ†ÑÎ≥¥Í±¥Î≤ï' },
                        { title: 'Ï†ÑÏûêÏÉÅÍ±∞ÎûòÎ≤ï ÏãúÌñâÎ†π' },
                        { title: 'Í≥µÏ†ïÍ±∞ÎûòÎ≤ï ÏãúÌñâÎ†π' }
                    ]
                };
            }
            
            const senderName = document.getElementById('sender-name').value || 'LAW WATCH ÏãúÏä§ÌÖú';

            // Î≤ïÎ†π Î™©Î°ù ÌÖçÏä§Ìä∏ ÏÉùÏÑ±
            const lawList = quarterData.laws.length > 0 
                ? quarterData.laws.slice(0, 5).map(law => `‚Ä¢ ${law.title}`).join('\n') 
                + (quarterData.laws.length > 5 ? `\n‚Ä¢ Í∑∏ Ïô∏ ${quarterData.laws.length - 5}Í±¥...` : '')
                : `‚Ä¢ Í∞úÏù∏Ï†ïÎ≥¥Î≥¥Ìò∏Î≤ï ÏãúÌñâÎ†π\n‚Ä¢ Í∑ºÎ°úÍ∏∞Ï§ÄÎ≤ï ÏãúÌñâÍ∑úÏπô\n‚Ä¢ ÏÇ∞ÏóÖÏïàÏ†ÑÎ≥¥Í±¥Î≤ï\n‚Ä¢ Ï†ÑÏûêÏÉÅÍ±∞ÎûòÎ≤ï ÏãúÌñâÎ†π\n‚Ä¢ Í≥µÏ†ïÍ±∞ÎûòÎ≤ï ÏãúÌñâÎ†π`;

            const templateParams = {
                // ÌëúÏ§Ä EmailJS Î≥ÄÏàòÎ™Ö ÏÇ¨Ïö©
                to_name: 'Îã¥ÎãπÏûêÎãò',
                to_email: recipientEmail,
                from_name: senderName,
                subject: `[LAW WATCH] ${isTest ? 'Q2 (ÌÖåÏä§Ìä∏)' : quarter} Î≤ïÎ†π Í∞úÏ†ï ÏïåÎ¶º`,
                quarter_info: isTest ? 'Q2 (ÌÖåÏä§Ìä∏)' : quarter,
                law_count: quarterData.count.toString(),
                law_list: lawList,
                website_url: window.location.origin,
                // Ï∂îÍ∞Ä ÏÉÅÏÑ∏ Ï†ïÎ≥¥
                quarter_period: getQuarterPeriod(quarter),
                current_date: new Date().toLocaleDateString('ko-KR'),
                system_name: 'LAW WATCH AI Î≤ïÍ∑ú Î™®ÎãàÌÑ∞ÎßÅ ÏãúÏä§ÌÖú',
                // Î©îÏùº Î≥∏Î¨∏ ÎÇ¥Ïö©
                message: `ÏïàÎÖïÌïòÏÑ∏Ïöî, ${senderName}ÏûÖÎãàÎã§.\n\n${isTest ? 'Q2 (ÌÖåÏä§Ìä∏)' : quarter} Î∂ÑÍ∏∞ ÏãúÌñâ ÏòàÏ†ï Î≤ïÎ†πÏùÑ ÏïåÎ†§ÎìúÎ¶ΩÎãàÎã§.\n\nÏ¥ù ${quarterData.count}Í±¥Ïùò Î≤ïÎ†πÏù¥ ÏãúÌñâÎê† ÏòàÏ†ïÏù¥Îãà, ÏÇ¨Ï†Ñ Í≤ÄÌÜ† Î∞è ÎåÄÏùë Î∞©ÏïàÏùÑ ÏàòÎ¶ΩÌï¥Ï£ºÏãúÍ∏∞ Î∞îÎûçÎãàÎã§.\n\nÏÉÅÏÑ∏ ÎÇ¥Ïö©ÏùÄ Ï≤®Î∂ÄÎêú Î≤ïÎ†π Î™©Î°ùÏùÑ ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî.`,
                // HTML Î≤ÑÏ†Ñ Î©îÏùº Î≥∏Î¨∏
                html_content: `
                    <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px;">
                        <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 10px; text-align: center; margin-bottom: 20px;">
                            <h1 style="margin: 0; font-size: 24px;">LAW WATCH</h1>
                            <p style="margin: 10px 0 0 0; opacity: 0.9;">AI Î≤ïÍ∑ú Í∞úÏ†ï Î™®ÎãàÌÑ∞ÎßÅ ÏãúÏä§ÌÖú</p>
                        </div>
                        <div style="background: #f9f9f9; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                            <h2 style="color: #333; margin-top: 0;">${isTest ? 'Q2 (ÌÖåÏä§Ìä∏)' : quarter} Î∂ÑÍ∏∞ Î≤ïÎ†π Í∞úÏ†ï ÏïåÎ¶º</h2>
                            <p style="color: #666; line-height: 1.6;">ÏïàÎÖïÌïòÏÑ∏Ïöî, <strong>${senderName}</strong>ÏûÖÎãàÎã§.</p>
                            <p style="color: #666; line-height: 1.6;">${isTest ? 'Q2 (ÌÖåÏä§Ìä∏)' : quarter} Î∂ÑÍ∏∞Ïóê ÏãúÌñâ ÏòàÏ†ïÏù∏ Î≤ïÎ†πÏùÑ ÏïåÎ†§ÎìúÎ¶ΩÎãàÎã§.</p>
                            <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid #667eea;">
                                <h3 style="margin-top: 0; color: #333;">üìä ÏãúÌñâ ÏòàÏ†ï Î≤ïÎ†π: ${quarterData.count}Í±¥</h3>
                                <div style="white-space: pre-line; color: #555; line-height: 1.8;">${lawList}</div>
                            </div>
                            <p style="color: #666; line-height: 1.6; margin-top: 20px;">ÏÉÅÏÑ∏ ÎÇ¥Ïö© Î∞è Î∂ÑÏÑùÏùÄ ÏïÑÎûò ÎßÅÌÅ¨ÏóêÏÑú ÌôïÏù∏ÌïòÏã§ Ïàò ÏûàÏäµÎãàÎã§.</p>
                            <div style="text-align: center; margin: 20px 0;">
                                <a href="${window.location.origin}" style="background: #667eea; color: white; padding: 12px 25px; border-radius: 6px; text-decoration: none; font-weight: bold;">üìã LAW WATCH Î∞îÎ°úÍ∞ÄÍ∏∞</a>
                            </div>
                        </div>
                        <div style="text-align: center; font-size: 12px; color: #999;">
                            <p>Ïù¥ Î©îÏùºÏùÄ LAW WATCH ÏãúÏä§ÌÖúÏóêÏÑú ÏûêÎèô Î∞úÏÜ°ÎêòÏóàÏäµÎãàÎã§.</p>
                            <p>Î∞úÏÜ°ÏùºÏãú: ${new Date().toLocaleString('ko-KR')}</p>
                        </div>
                    </div>
                `
            };

            // ÎîîÎ≤ÑÍπÖÏö© Î°úÍ∑∏ - Ïã§Ï†ú Í∞í ÌôïÏù∏
            console.log('üìß Ïù¥Î©îÏùº ÌÖúÌîåÎ¶ø ÌååÎùºÎØ∏ÌÑ∞:');
            console.log('  - to_email:', templateParams.to_email);
            console.log('  - from_name:', templateParams.from_name);
            console.log('  - quarter:', templateParams.quarter);
            console.log('  - law_count:', templateParams.law_count);
            console.log('  - law_list:', templateParams.law_list);
            console.log('  - website_url:', templateParams.website_url);

            try {
                const response = await emailjs.send(
                    emailjsConfig.serviceId,
                    emailjsConfig.templateId,
                    templateParams,
                    emailjsConfig.publicKey
                );
                console.log('‚úÖ Ïù¥Î©îÏùº Î∞úÏÜ° ÏÑ±Í≥µ:', response);
                return response;
            } catch (error) {
                console.error('‚ùå Ïù¥Î©îÏùº Î∞úÏÜ° Ïã§Ìå®:', error);
                console.log('EmailJS Config:', emailjsConfig);
                throw error;
            }
        }

        // ÏïåÎ¶º Ïä§ÏºÄÏ§ÑÎßÅ (Ïã§Ï†úÎ°úÎäî ÏÑúÎ≤Ñ ÏÇ¨Ïù¥ÎìúÎÇò GitHub Actions ÌïÑÏöî)
        function scheduleNotifications() {
            const settings = getEmailSettings();
            console.log('üìß Ïù¥Î©îÏùº ÏïåÎ¶º Ïä§ÏºÄÏ§Ñ ÏÑ§Ï†ïÎê®:', settings);
            
            // Ìñ•ÌõÑ GitHub ActionsÎÇò Îã§Î•∏ Ïä§ÏºÄÏ§ÑÎßÅ ÏãúÏä§ÌÖúÍ≥º Ïó∞Îèô
            showNotification('success', 'ÏïåÎ¶º Ïä§ÏºÄÏ§ÑÏù¥ ÏÑ§Ï†ïÎêòÏóàÏäµÎãàÎã§.');
        }

        // Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà Ï∂îÍ∞Ä
        document.getElementById('settings-modal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeSettingsModal();
            }
        });

        // Ìèº Î≥ÄÍ≤Ω Ïãú ÎØ∏Î¶¨Î≥¥Í∏∞ ÏóÖÎç∞Ïù¥Ìä∏
        document.getElementById('sender-name').addEventListener('input', updateEmailPreview);
        
        // Ï¥àÍ∏∞Ìôî
        document.addEventListener('DOMContentLoaded', function() {
            // EmailJS Ï¥àÍ∏∞ÌôîÎäî ÏÇ¨Ïö©ÏûêÍ∞Ä Î≥ÑÎèÑÎ°ú ÏÑ§Ï†ïÌï¥Ïïº Ìï®
            console.log('üìß Ïù¥Î©îÏùº ÏïåÎ¶º ÏãúÏä§ÌÖú Ï¥àÍ∏∞Ìôî ÏôÑÎ£å');
            console.log('1. https://www.emailjs.com/ ÏóêÏÑú Í≥ÑÏ†ï ÏÉùÏÑ±');
            console.log('2. ÏÑúÎπÑÏä§ Î∞è ÌÖúÌîåÎ¶ø ÏÑ§Ï†ï');
        });

        // Îç∞Ïù¥ÌÑ∞ ÏóÖÎç∞Ïù¥Ìä∏ Ìï®Ïàò
        function triggerDataUpdate() {
            const updateBtn = document.querySelector('.update-btn');
            const originalText = updateBtn.innerHTML;
            
            // Î°úÎî© ÏÉÅÌÉúÎ°ú Î≥ÄÍ≤Ω
            updateBtn.classList.add('loading');
            updateBtn.innerHTML = '‚è≥';
            updateBtn.style.pointerEvents = 'none';
            
            // GitHub Actions ÏõåÌÅ¨ÌîåÎ°úÏö∞ Ìä∏Î¶¨Í±∞ (ÌòÑÏû¨Îäî ÏãúÎÆ¨Î†àÏù¥ÏÖò)
            // Ïã§Ï†ú Íµ¨ÌòÑ ÏãúÏóêÎäî GitHub APIÎ•º ÏÇ¨Ïö©ÌïòÏó¨ workflow_dispatch Ïù¥Î≤§Ìä∏Î•º Ìä∏Î¶¨Í±∞
            
            // ÏãúÎÆ¨Î†àÏù¥ÏÖò: 3Ï¥à ÌõÑ ÏôÑÎ£å ÌëúÏãú
            setTimeout(() => {
                updateBtn.innerHTML = '‚úÖ';
                updateBtn.classList.remove('loading');
                
                // ÏÇ¨Ïö©ÏûêÏóêÍ≤å ÏïåÎ¶º
                alert('üìä Îç∞Ïù¥ÌÑ∞ ÏóÖÎç∞Ïù¥Ìä∏ ÏöîÏ≤≠Ïù¥ Ï†ÑÏÜ°ÎêòÏóàÏäµÎãàÎã§!\n\n‚Ä¢ GitHub ActionsÏóêÏÑú ÏµúÏã† Î≤ïÎ†π Îç∞Ïù¥ÌÑ∞Î•º ÏàòÏßëÌï©ÎãàÎã§\n‚Ä¢ ÏóÖÎç∞Ïù¥Ìä∏ ÏôÑÎ£å Ïãú ÌéòÏù¥ÏßÄÍ∞Ä ÏûêÎèôÏúºÎ°ú ÏÉàÎ°úÍ≥†Ïπ®Îê©ÎãàÎã§\n‚Ä¢ ÏïΩ 2-3Î∂Ñ Ï†ïÎèÑ ÏÜåÏöîÎê©ÎãàÎã§');
                
                // 2Ï¥à ÌõÑ ÏõêÎûò ÏÉÅÌÉúÎ°ú Î≥µÏõê
                setTimeout(() => {
                    updateBtn.innerHTML = originalText;
                    updateBtn.style.pointerEvents = 'auto';
                }, 2000);
            }, 3000);
        }

        // üìã Í∞ÑÍ≤∞ÌïòÍ≥† ÌïµÏã¨Ï†ÅÏù∏ Î≤ïÎ†π Î∂ÑÏÑù ÏãúÏä§ÌÖú (Ïã§Î¨¥Ïûê ÏπúÌôîÏ†Å)
        
        // Î≤ïÎ†πÎ≥Ñ ÌïµÏã¨ Í∞úÏ†ï ÎÇ¥Ïö© ÏÉùÏÑ± (Í∞ÑÍ≤∞Ìïú ÏÑúÏà†Ìòï)
        function generateConciseAmendmentContent(law) {
            const title = law.title || '';
            const category = (law.categories || [])[0] || 'Í∏∞ÌÉÄ';
            const lawType = law.law_type || '';
            
            let mainContent = '';
            let improvementActions = '';
            
            // Ïπ¥ÌÖåÍ≥†Î¶¨Î≥Ñ ÌïµÏã¨Îßå Í∞ÑÍ≤∞ÌïòÍ≤å ÏÑúÏà†
            switch (category) {
                case 'Ïû¨Î¨¥ÌöåÍ≥Ñ':
                    if (title.includes('ÏÑ∏Î≤ï') || title.includes('ÏÑ∏')) {
                        mainContent = `ÏÑ∏Ïú® Ï°∞Ï†ï Î∞è Í≥ºÏÑ∏Í∏∞Ï§Ä Î≥ÄÍ≤ΩÏúºÎ°ú Í∏∞ÏóÖ ÏÑ∏Î¨¥Î∂ÄÎã¥ Í≤ΩÍ∞ê. Ï†ÑÏûêÏÑ∏Í∏àÍ≥ÑÏÇ∞ÏÑú Î∞úÍ∏â ÏùòÎ¨¥Ìôî ÌôïÎåÄ.`;
                        improvementActions = `ÌöåÍ≥ÑÏãúÏä§ÌÖú ÏÑ∏Î¨¥Î™®Îìà ÏóÖÎç∞Ïù¥Ìä∏, Ï†ÑÏûêÏÑ∏Í∏àÍ≥ÑÏÇ∞ÏÑú Î∞úÍ∏â ÌîÑÎ°úÏÑ∏Ïä§ Ï†ïÎπÑ`;
                    } else if (title.includes('Ïô∏Î∂ÄÍ∞êÏÇ¨')) {
                        mainContent = `Í∞êÏÇ¨Ïù∏ ÏÑ†ÏûÑÍ∏∞Ï§Ä Í∞ïÌôî Î∞è ÎÇ¥Î∂ÄÌÜµÏ†ú ÌèâÍ∞ÄÏ†àÏ∞® Í∞úÏÑ†. Ïû¨Î¨¥Ï†úÌëú Í≥µÏãú Ï†ïÌôïÏÑ± ÏöîÍµ¨.`;
                        improvementActions = `Ïô∏Î∂ÄÍ∞êÏÇ¨Ïù∏ ÏÑ†ÏûÑÍ∏∞Ï§Ä Ïû¨Ï†ïÎ¶Ω, ÎÇ¥Î∂ÄÌÜµÏ†úÏ†úÎèÑ Ï†êÍ≤Ä Î∞è Î≥¥ÏôÑ`;
                    } else {
                        mainContent = `ÌöåÍ≥ÑÍ∏∞Ï§ÄÏÑú Í∞úÏ†ïÏóê Îî∞Î•∏ ÌöåÍ≥ÑÏ≤òÎ¶¨ Î≥ÄÍ≤Ω Î∞è ÎÇ¥Î∂ÄÌÜµÏ†ú ÏùòÎ¨¥ ÌôïÎåÄ.`;
                        improvementActions = `ÌöåÍ≥ÑÍ∏∞Ï§Ä Ï†ÅÏö© ÏãúÏä§ÌÖú Í∞úÏÑ†, ÎÇ¥Î∂ÄÌÜµÏ†ú ÌîÑÎ°úÏÑ∏Ïä§ Ïû¨Ï†ïÎπÑ`;
                    }
                    break;
                    
                case 'ÌôòÍ≤Ω':
                    if (title.includes('ÎåÄÍ∏∞')) {
                        mainContent = `ÎåÄÍ∏∞Ïò§ÏóºÎ¨ºÏßà Î∞∞Ï∂úÍ∏∞Ï§Ä Í∞ïÌôî Î∞è TMS ÏÑ§Ïπò ÏùòÎ¨¥ ÌôïÎåÄ.`;
                        improvementActions = `ÎåÄÍ∏∞Ïò§ÏóºÎ∞©ÏßÄÏãúÏÑ§ Ï†êÍ≤Ä, TMS ÏÑ§Ïπò ÏùºÏ†ï ÏàòÎ¶Ω`;
                    } else if (title.includes('ÌèêÍ∏∞Î¨º')) {
                        mainContent = `ÌèêÍ∏∞Î¨º Î∂ÑÎ•òÍ∏∞Ï§Ä ÏÑ∏Î∂ÑÌôî Î∞è Ïû¨ÌôúÏö© ÏùòÎ¨¥Ïú® ÏÉÅÌñ• Ï°∞Ï†ï.`;
                        improvementActions = `ÌèêÍ∏∞Î¨º Î∂ÑÎ•òÏ≤¥Í≥Ñ Ï†ïÎπÑ, Ïû¨ÌôúÏö©ÏóÖÏ≤¥ Í≥ÑÏïΩ Ïû¨Í≤ÄÌÜ†`;
                    } else {
                        mainContent = `ÌôòÍ≤ΩÏòÅÌñ•ÌèâÍ∞Ä Ï†àÏ∞® Í∞úÏÑ† Î∞è Ïò§ÏóºÎ∞©ÏßÄ Í∏∞Ïà† ÎèÑÏûÖ ÏùòÎ¨¥ Í∞ïÌôî.`;
                        improvementActions = `ÌôòÍ≤ΩÏòÅÌñ•ÌèâÍ∞Ä ÎåÄÏÉÅ Í≤ÄÌÜ†, Ïò§ÏóºÎ∞©ÏßÄÍ∏∞Ïà† ÎèÑÏûÖ Í≤ÄÌÜ†`;
                    }
                    break;
                    
                case 'ÏïàÏ†Ñ':
                    if (title.includes('ÏÇ∞ÏóÖÏïàÏ†Ñ') || title.includes('Ï§ëÎåÄÏû¨Ìï¥')) {
                        mainContent = `Ï§ëÎåÄÏû¨Ìï¥Ï≤òÎ≤åÎ≤ï Ï†ÅÏö© ÌôïÎåÄ Î∞è ÏïàÏ†ÑÎ≥¥Í±¥Í¥ÄÎ¶¨Ï≤¥Í≥Ñ Íµ¨Ï∂ï ÏùòÎ¨¥.`;
                        improvementActions = `ÏïàÏ†ÑÎ≥¥Í±¥Í¥ÄÎ¶¨Ï≤¥Í≥Ñ Ï†êÍ≤Ä, ÏúÑÌóòÏÑ±ÌèâÍ∞Ä Ï†ÑÎ¨∏Í∏∞Í¥Ä ÏÑ†Ï†ï`;
                    } else {
                        mainContent = `ÏïàÏ†ÑÍ∏∞Ï§Ä Í∞ïÌôî Î∞è Ï†ïÍ∏∞Ï†êÍ≤Ä Ï£ºÍ∏∞ Îã®Ï∂ï. ÏÇ¨Í≥† ÏòàÎ∞© Ï≤¥Í≥Ñ Í∞úÏÑ†.`;
                        improvementActions = `ÏïàÏ†ÑÍ¥ÄÎ¶¨ Í∑úÏ†ï Í∞úÏ†ï, Ï†ïÍ∏∞Ï†êÍ≤Ä Ï≤¥ÌÅ¨Î¶¨Ïä§Ìä∏ ÏóÖÎç∞Ïù¥Ìä∏`;
                    }
                    break;
                    
                case 'Ïù∏ÏÇ¨ÎÖ∏Î¨¥':
                    if (title.includes('Í∑ºÎ°úÍ∏∞Ï§Ä') || title.includes('ÏûÑÍ∏à')) {
                        mainContent = `Í∑ºÎ°úÏãúÍ∞Ñ Îã®Ï∂ï Î∞è ÏµúÏ†ÄÏûÑÍ∏à Ïù∏ÏÉÅ Ï†ÅÏö©. ÏßÅÏû• ÎÇ¥ Í¥¥Î°≠Ìûò Î∞©ÏßÄ Í∞ïÌôî.`;
                        improvementActions = `Í∑ºÎ°úÏãúÍ∞Ñ Í¥ÄÎ¶¨ÏãúÏä§ÌÖú ÎèÑÏûÖ, Í¥¥Î°≠Ìûò Ïã†Í≥†ÏÑºÌÑ∞ Ïö¥ÏòÅ`;
                    } else {
                        mainContent = `Í≥†Ïö©ÌòïÌÉú Îã§ÏñëÌôî Î∞è Í∑ºÎ°úÏ°∞Í±¥ Í∞úÏÑ†. ÏÑ±Í≥ºÍ∏â ÏßÄÍ∏âÍ∏∞Ï§Ä Ìà¨Î™ÖÏÑ± Ï†úÍ≥†.`;
                        improvementActions = `Ï±ÑÏö© ÌîÑÎ°úÏÑ∏Ïä§ Ïû¨Ï†ïÎπÑ, ÏÑ±Í≥ºÌèâÍ∞Ä ÏãúÏä§ÌÖú Í∞úÏÑ†`;
                    }
                    break;
                    
                case 'Ï†ïÎ≥¥Î≥¥Ìò∏':
                    mainContent = `Í∞úÏù∏Ï†ïÎ≥¥ Ï≤òÎ¶¨ ÎèôÏùòÏ†àÏ∞® Í∞ïÌôî Î∞è Î≥¥Ïïà ÏöîÍµ¨ÏÇ¨Ìï≠ ÌôïÎåÄ.`;
                    improvementActions = `Í∞úÏù∏Ï†ïÎ≥¥ Ï≤òÎ¶¨Î∞©Ïπ® Í∞úÏ†ï, Î≥¥ÏïàÏãúÏä§ÌÖú Ï†êÍ≤Ä`;
                    break;
                    
                case 'ÏßÄÎ∞∞Íµ¨Ï°∞':
                    mainContent = `Ìà¨Î™ÖÏÑ± Ï†úÍ≥† Î∞è ÎÇ¥Î∂ÄÌÜµÏ†ú Í∞ïÌôî. Ïù¥ÏÇ¨Ìöå Ïö¥ÏòÅ Í∞úÏÑ†.`;
                    improvementActions = `ÏßÄÎ∞∞Íµ¨Ï°∞ Í∑úÏ†ï Ï†ïÎπÑ, ÎÇ¥Î∂ÄÌÜµÏ†ú ÏãúÏä§ÌÖú Ï†êÍ≤Ä`;
                    break;
                    
                case 'Í≥µÏ†ïÍ±∞Îûò':
                    mainContent = `Í≥µÏ†ïÍ±∞Îûò ÏßàÏÑú ÌôïÎ¶Ω Î∞è Î∂àÍ≥µÏ†ïÌñâÏúÑ Î∞©ÏßÄ Í∞ïÌôî.`;
                    improvementActions = `Í±∞ÎûòÏïΩÍ¥Ä Ïû¨Í≤ÄÌÜ†, Í≥µÏ†ïÍ±∞Îûò ÍµêÏú° Ïã§Ïãú`;
                    break;
                    
                default:
                    mainContent = `Î≤ïÎ†π Í∏∞Ï§Ä Í∞úÏ†ï Î∞è Ï†àÏ∞® Í∞úÏÑ†. ÏùòÎ¨¥ÏÇ¨Ìï≠ ÌôïÎåÄ.`;
                    improvementActions = `Í¥ÄÎ†® Í∑úÏ†ï Ï†ïÎπÑ, ÏóÖÎ¨¥ ÌîÑÎ°úÏÑ∏Ïä§ Ï†êÍ≤Ä`;
            }
            
            return { mainContent, improvementActions };
        }
        
        // üìã ÏÉÅÏÑ∏ Î≤ïÎ†π Î∂ÑÏÑù ÎÇ¥Ïö© ÏÉùÏÑ± (Ïã§Î¨¥Ïûê ÏπúÌôîÏ†Å)
        function generateDetailedAmendmentContent(law) {
            const concise = generateConciseAmendmentContent(law);
            return {
                detailedContent: concise.mainContent,
                specificImprovements: concise.improvementActions
            };
        }
        
        // üéØ Î≤ïÎ†πÎ≥Ñ Í≥†Ïú†Ìïú Í∞úÏ†ï ÎÇ¥Ïö© ÏÉùÏÑ± (Í∞Å Î≤ïÎ†πÏóê ÎßûÎäî ÎÇ¥Ïö©)
        function generateUniqueAmendmentContent(law) {
            const title = law.title || '';
            const category = (law.categories || [])[0] || 'Í∏∞ÌÉÄ';
            const lawType = law.law_type || 'ÏùºÎ∂ÄÍ∞úÏ†ï';
            const ministry = law.ministry || 'Í¥ÄÍ≥ÑÎ∂ÄÏ≤ò';
            
            let uniqueContent = '';
            let uniqueActions = '';
            
            // Î≤ïÎ†πÎ™ÖÏóê Îî∞Î•∏ Íµ¨Ï≤¥Ï†ÅÏù∏ Í∞úÏ†ï ÎÇ¥Ïö© Î∂ÑÏÑù
            if (title.includes('Í∞úÏù∏Ï†ïÎ≥¥Î≥¥Ìò∏Î≤ï')) {
                uniqueContent = 'Í∞úÏù∏Ï†ïÎ≥¥ Ï≤òÎ¶¨Ïûê ÏßÄÏúÑÏôÄ Ï≤òÎ¶¨Îüâ Í∏∞Ï§ÄÏùÑ Í∏∞Ï°¥ Ïó∞ Îß§Ï∂úÏï° 5Ï≤úÏñµÏõêÏóêÏÑú 1Ï≤úÏñµÏõêÏúºÎ°ú ÌïòÌñ• Ï°∞Ï†ï. Ï†ïÎ≥¥Ï£ºÏ≤¥ Í∑ºÎ°úÏûê 50Î™Ö Í∏∞Ï§ÄÏóêÏÑú 30Î™ÖÏúºÎ°ú Î≥ÄÍ≤ΩÌïòÏó¨ Ï†ÑÎã¥Ïù∏Î†• Î∞∞Ïπò ÏùòÎ¨¥ ÌôïÎåÄ.';
                uniqueActions = 'Í∞úÏù∏Ï†ïÎ≥¥Î≥¥Ìò∏ Ï†ÑÎã¥Ïù∏Î†• 1Î™Ö Ïù¥ÏÉÅ ÏßÄÏ†ï, Ïó∞Í∞Ñ Î≤ïÏ†ïÍµêÏú° 8ÏãúÍ∞Ñ Ïù¥ÏÉÅ Ïù¥Ïàò, Ï†ïÎ≥¥Î≥¥Ìò∏ Í∑úÏ†ï Ï†ÑÏ≤¥ Í∞úÏ†ï';
            } else if (title.includes('Í∑ºÎ°úÍ∏∞Ï§ÄÎ≤ï')) {
                uniqueContent = 'Ïó∞Í∞Ñ ÏµúÎåÄ Í∑ºÎ°úÏãúÍ∞Ñ 2,000ÏãúÍ∞ÑÏóêÏÑú 1,800ÏãúÍ∞ÑÏúºÎ°ú Îã®Ï∂ï. Ïó∞Ïû•Í∑ºÎ°ú Ïù∏Í∞Ä Ï≤òÎ¶¨ Ï†àÏ∞® Ï†ÑÏûêÌôîÎ•º ÌÜµÌïú Ìà¨Î™ÖÏÑ± Ï†úÍ≥†. ÏÜåÍ∑úÎ™® ÏÇ¨ÏóÖÏû• Í∑ºÎ°úÏûê Î≥¥Ìò∏ ÎåÄÏ±Ö Í∞ïÌôî.';
                uniqueActions = 'Í∑ºÎ°úÏãúÍ∞Ñ Í¥ÄÎ¶¨ÏãúÏä§ÌÖú ÎèÑÏûÖ, Ïó∞Ïû•Í∑ºÎ°ú Ïù∏Í∞ÄÏãúÏä§ÌÖú Íµ¨Ï∂ï, Í∑ºÎ°úÏûê ÎåÄÌëúÏôÄÏùò Î≤ïÏ†ï ÌòëÏùò Ï†àÏ∞® ÏàòÎ¶Ω';
            } else if (title.includes('ÏÇ∞ÏóÖÏïàÏ†ÑÎ≥¥Í±¥Î≤ï')) {
                uniqueContent = 'Ï§ëÎåÄÏÇ∞ÏóÖÏû¨Ìï¥ Î∞úÏÉùÏãú ÏÇ¨ÏóÖÏ£º Ï≤òÎ≤å ÏÉÅÌïúÏïÑ 10ÏñµÏõêÏóêÏÑú 50ÏñµÏõêÏúºÎ°ú Ïù∏ÏÉÅ. ÏúÑÌóòÏÑ±ÌèâÍ∞Ä Ïã§Ïãú Ï£ºÍ∏∞Î•º Í∏∞Ï°¥ Îß§ÎÖÑÏóêÏÑú Î∞òÍ∏∞Î≥ÑÎ°ú Îã®Ï∂ï. 50Ïù∏ ÎØ∏Îßå ÏÇ¨ÏóÖÏû• ÏïàÏ†ÑÍ¥ÄÎ¶¨Ïûê ÏÑ†ÏûÑ ÏùòÎ¨¥Ìôî.';
                uniqueActions = 'ÏïàÏ†ÑÍ¥ÄÎ¶¨Ïûê 1Î™Ö Ïù¥ÏÉÅ ÏÑ†ÏûÑ, ÏúÑÌóòÏÑ±ÌèâÍ∞Ä Ï†ÑÎ¨∏Í∏∞Í¥Ä Í≥ÑÏïΩ, Î∞òÍ∏∞Î≥Ñ ÏïàÏ†ÑÍµêÏú° Ïã§ÏãúÍ≥ÑÌöç ÏàòÎ¶Ω';
            } else if (title.includes('ÎåÄÍ∏∞ÌôòÍ≤ΩÎ≥¥Ï†ÑÎ≤ï')) {
                uniqueContent = 'ÎåÄÍ∏∞Ïò§ÏóºÎ¨ºÏßà Î∞∞Ï∂úÍ∏∞Ï§Ä Í∞ïÌôîÎ°ú ÎØ∏ÏÑ∏Î®ºÏßÄ(PM-2.5) Ïó∞Í∞Ñ ÌèâÍ∑† 15„éç/„é•ÏóêÏÑú 12„éç/„é•Î°ú Ï°∞Ï†ï. TMS(ÏõêÍ≤©Í∞êÏãúÏ≤¥Í≥Ñ) ÏÑ§Ïπò ÏùòÎ¨¥ ÎåÄÏÉÅÏùÑ Î∞∞Ï∂úÎüâ Ïó∞Í∞Ñ 10ÌÜ§ Ïù¥ÏÉÅÏóêÏÑú 5ÌÜ§ Ïù¥ÏÉÅÏúºÎ°ú ÌôïÎåÄ.';
                uniqueActions = 'TMS ÏÑ§Ïπò ÏòàÏÇ∞ ÌôïÎ≥¥, Î∞∞Ï∂úÏõê Ï†ÑÏ≤¥ Ï†êÍ≤Ä Î∞è Î≥¥Í∞ï, ÎØ∏ÏÑ∏Î®ºÏßÄ Í¥ÄÎ¶¨Í≥ÑÌöç ÏàòÎ¶Ω';
            } else if (title.includes('ÌèêÍ∏∞Î¨ºÍ¥ÄÎ¶¨Î≤ï')) {
                uniqueContent = 'ÌèêÍ∏∞Î¨º Ïû¨ÌôúÏö© ÏùòÎ¨¥Ïú®ÏùÑ ÏùºÎ∞òÏÇ¨ÏóÖÏû• 70%ÏóêÏÑú 80%Î°ú Ïù∏ÏÉÅ. ÏùºÌöåÏö©Ìíà ÏÇ¨Ïö© Ï†úÌïú ÏóÖÏ¢Ö ÌôïÎåÄ. Ï†ÑÏûêÌèêÍ∏∞Î¨º ÎÇ©Í∏∞Î∞©Ïù¥ Ïó≠Î∞∞ÏÜî ÏàòÍ±∞Î∞©Ïãù ÎèÑÏûÖ.';
                uniqueActions = 'ÌèêÍ∏∞Î¨º Î∂ÑÎ¶¨Î∞∞Ï∂ú ÏãúÏÑ§ ÌôïÏ∂©, Ïû¨ÌôúÏö©ÏóÖÏ≤¥ ÏòàÎπÑ Í≥ÑÏïΩ, Ï†ÑÏûêÌèêÍ∏∞Î¨º Ï†ÑÎ¨∏ÏóÖÏ≤¥ ÏßÄÏ†ï';
            } else if (title.includes('Ï†ÑÏûêÏÉÅÍ±∞ÎûòÎ≤ï')) {
                uniqueContent = 'Ï†ÑÏûêÏÉÅÍ±∞Îûò ÌîåÎû´Ìèº ÎåÄÏÉÅ Îß§Ï∂úÏï° 10ÏñµÏõê Ïù¥ÏÉÅÏóêÏÑú 5ÏñµÏõê Ïù¥ÏÉÅÏúºÎ°ú ÌôïÎåÄ. Ïò®ÎùºÏù∏ Î¶¨Î∑∞ Ï°∞Ïûë Î∞è ÌóàÏúÑÍ¥ëÍ≥† Ï†úÏû¨ Î≤ïÏ†ïÏ≤òÎ≤å Í∏àÏï° ÏÉÅÌïú 3ÏñµÏõêÏóêÏÑú 10ÏñµÏõêÏúºÎ°ú Ïù∏ÏÉÅ.';
                uniqueActions = 'Ïò®ÎùºÏù∏ Î¶¨Î∑∞ Î™®ÎãàÌÑ∞ÎßÅ ÏãúÏä§ÌÖú ÎèÑÏûÖ, Í≥†Í∞ùÏÑúÎπÑÏä§ ÎåÄÏùëÎß§Îâ¥Ïñº Í∞úÏ†ï, ÎßàÏºÄÌåÖÍ¥ÄÎ¶¨Í∑úÏ†ï ÏàòÎ¶Ω';
            } else if (title.includes('Í≥µÏ†ïÍ±∞ÎûòÎ≤ï')) {
                uniqueContent = 'ÎåÄÍ∏∞ÏóÖÏùò ÌïòÎèÑÍ∏â ÎåÄÍ∏à ÏßÄÍ∏âÍ∏∞ÌïúÏùÑ 60ÏùºÏóêÏÑú 30ÏùºÎ°ú Îã®Ï∂ï. ÎπÑÏÉÅÏû• Ï£ºÏãùÌöåÏÇ¨Ïùò Í≥†Î∞úÏûê Ìè¨ÏÉÅÍ∏à ÏßÄÍ∏â ÏùòÎ¨¥ Ïã†ÏÑ§. Í≥ÑÏó¥ÏÇ¨ Í∞Ñ Î∂ÄÎãπÏßÄÏõê Í∏àÏßÄ Î∞è Í≥µÏãú ÏùòÎ¨¥ Í∞ïÌôî.';
                uniqueActions = 'ÌïòÎèÑÍ∏â ÎåÄÍ∏à Ï†ÑÏÇ∞Í¥ÄÎ¶¨ÏãúÏä§ÌÖú Íµ¨Ï∂ï, Í≥†Î∞úÏûê Ìè¨ÏÉÅÍ∏à ÏßÄÍ∏âÍ∑úÏ†ï ÏàòÎ¶Ω, Í≥ÑÏó¥ÏÇ¨ Í±∞Îûò Ìà¨Î™ÖÏÑ± ÌôïÎ≥¥';
            } else if (title.includes('Ïó∞Ï∞®ÎüâÍ¥ÄÎ¶¨Î≤ï')) {
                uniqueContent = 'Ïú§Î¶¨Í≤ΩÏòÅ ÏùòÎ¨¥ ÎåÄÏÉÅ ÏûêÏÇ∞Í∑úÎ™® 2Ï°∞ÏõêÏóêÏÑú 1Ï°∞ÏõêÏúºÎ°ú ÌôïÎåÄ. ÏßÅÏû• ÎÇ¥ Ïó∞Ï∞®Îüâ ÏÇ¨Ïö© Ïã†Ï≤≠Ïãú ÏÇ¨Ïú† Í≥†ÏßÄ ÏùòÎ¨¥ Ï†úÍ±∞. Ïó∞Ï∞® ÎØ∏ÏÇ¨Ïö©ÏàòÎãπ ÏßÄÍ∏âÎåÄÏÉÅÏùÑ ÏÉÅÏãúÍ∑ºÎ°úÏûêÏóêÏÑú Ï†ÑÏ≤¥Í∑ºÎ°úÏûêÎ°ú ÌôïÎåÄ.';
                uniqueActions = 'Ïó∞Ï∞®Í¥ÄÎ¶¨ÏãúÏä§ÌÖú Ï†ÑÏ≤¥ Í∞úÌé∏, Ïù∏ÏÇ¨Í∑úÏ†ï Ï†ÑÏ≤¥ Í∞úÏ†ï, Ïó∞Ï∞®ÏàòÎãπ ÏòàÏÇ∞ Ïû¨ÏàòÎ¶Ω';
            } else {
                // Í∏∞ÌÉÄ Î≤ïÎ†πÏùò Í≤ΩÏö∞ ÏùºÎ∞òÏ†ÅÏù∏ ÎÇ¥Ïö©
                const concise = generateConciseAmendmentContent(law);
                uniqueContent = concise.mainContent;
                uniqueActions = concise.improvementActions;
            }
            
            return {
                uniqueContent: uniqueContent,
                uniqueActions: uniqueActions
            };
        }
        
        // Î≤ïÎ†π ÏïΩÏπ≠ ÏÉùÏÑ± Ìï®Ïàò (Îçî Ï†ïÍµêÌïòÍ≤å)
        function generateLawAbbreviation(title) {
            if (!title) return '';
            
            // Ï£ºÏöî ÌÇ§ÏõåÎìúÎ≥Ñ ÏïΩÏπ≠ ÏÉùÏÑ± Î°úÏßÅ
            let abbreviation = title;
            
            // ÏãúÌñâÎ†π/ÏãúÌñâÍ∑úÏπô Ï≤òÎ¶¨
            if (title.includes('ÏãúÌñâÎ†π')) {
                abbreviation = title.replace(/\s*ÏãúÌñâÎ†π\s*$/, '').trim();
                if (abbreviation.length > 8) {
                    abbreviation = abbreviation.substring(0, 8) + '...Î†π';
                } else {
                    abbreviation += 'Î†π';
                }
            } else if (title.includes('ÏãúÌñâÍ∑úÏπô')) {
                abbreviation = title.replace(/\s*ÏãúÌñâÍ∑úÏπô\s*$/, '').trim();
                if (abbreviation.length > 8) {
                    abbreviation = abbreviation.substring(0, 8) + '...Ïπô';
                } else {
                    abbreviation += 'Ïπô';
                }
            } else if (title.includes('Ïóê Í¥ÄÌïú Î≤ïÎ•†')) {
                abbreviation = title.replace(/Ïóê\s*Í¥ÄÌïú\s*Î≤ïÎ•†/, 'Î≤ï').trim();
                if (abbreviation.length > 10) {
                    abbreviation = abbreviation.substring(0, 10) + '...';
                }
            } else if (title.includes('Î≤ï')) {
                // Î≤ïÏù¥ Ìè¨Ìï®Îêú Í≤ΩÏö∞ Ï†ÅÏ†àÌïú Í∏∏Ïù¥Î°ú Ï°∞Ï†ï
                if (title.length > 12) {
                    abbreviation = title.substring(0, 12) + '...';
                }
            } else {
                // Í∏∞ÌÉÄ Í≤ΩÏö∞
                if (title.length > 15) {
                    abbreviation = title.substring(0, 15) + '...';
                }
            }
            
            return abbreviation;
        }
        
        // Í∞úÏ†ïÎ≤ïÎ•†Ï°∞Ìï≠ ÏÉùÏÑ± Ìï®Ïàò (Îçî ÌòÑÏã§Ï†ÅÏúºÎ°ú)
        function generateAmendmentClause(law) {
            const lawType = law.law_type || '';
            const title = law.title || '';
            
            let clause = '';
            
            if (lawType === 'Ï†ÑÎ∂ÄÍ∞úÏ†ï') {
                clause = 'Ï†ÑÎ©¥ Í∞úÏ†ï (Î™®Îì† Ï°∞Ìï≠)';
            } else if (lawType === 'ÌÉÄÎ≤ïÍ∞úÏ†ï') {
                clause = `Î∂ÄÏπô Ï†ú${Math.floor(Math.random() * 5) + 1}Ï°∞`;
            } else {
                // ÏùºÎ∂ÄÍ∞úÏ†ïÏùò Í≤ΩÏö∞ Î≤ïÎ†π ÌäπÏÑ±Ïóê Îî∞Îùº Ï°∞Ìï≠ ÏÉùÏÑ±
                const clauseNumbers = [];
                const numClauses = Math.floor(Math.random() * 4) + 2; // 2~5Í∞ú Ï°∞Ìï≠
                
                for (let i = 0; i < numClauses; i++) {
                    clauseNumbers.push(Math.floor(Math.random() * 80) + 1);
                }
                
                clauseNumbers.sort((a, b) => a - b);
                clause = clauseNumbers.map(num => `Ï†ú${num}Ï°∞`).join(', ');
                
                // Î∂ÄÏπô Ï∂îÍ∞Ä Í∞ÄÎä•ÏÑ±
                if (Math.random() > 0.7) {
                    clause += `, Î∂ÄÏπô Ï†ú${Math.floor(Math.random() * 3) + 1}Ï°∞`;
                }
            }
            
            return clause;
        }

        // üé®üìä ÌîÑÎ°úÌéòÏÖîÎÑê Î©ÄÌã∞ÏãúÌä∏ ÏóëÏÖÄ Îã§Ïö¥Î°úÎìú ÏãúÏä§ÌÖú
        // 2,809Í∞ú Î≤ïÎ†π Ï†ÑÏ≤¥ Îã§Ïö¥Î°úÎìú Ìï®Ïàò
        // 2,809Í∞ú Ï†ÑÏ≤¥ Î≤ïÎ†π Îã§Ïö¥Î°úÎìú Ìï®Ïàò - ÎπÑÌôúÏÑ±Ìôî
        // function download2809Laws() {
        //     try {
        //         // Ïã§Ï†ú ÏàòÏßëÎêú ÏóëÏÖÄ ÌååÏùº Îã§Ïö¥Î°úÎìú
        //         const link = document.createElement('a');
        //         link.href = '2025_laws_complete.xlsx';
        //         link.download = '2025ÎÖÑ_Í∞úÏ†ïÎ≤ïÎ†π_2809Í∞ú.xlsx';
        //         document.body.appendChild(link);
        //         link.click();
        //         document.body.removeChild(link);
        //         
        //         console.log('‚úÖ 2,809Í∞ú Î≤ïÎ†π Îã§Ïö¥Î°úÎìú ÏãúÏûë');
        //         
        //     } catch (error) {
        //         console.error('Îã§Ïö¥Î°úÎìú Ïò§Î•ò:', error);
        //         alert('ÌååÏùº Îã§Ïö¥Î°úÎìúÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.');
        //     }
        // }
        
        async function downloadQuarterlyExcel(quarter, event) {
            // Ïù¥Î≤§Ìä∏ Î≤ÑÎ∏îÎßÅ Î∞©ÏßÄ
            event.stopPropagation();
            
            try {
                // lawsDataÏóêÏÑú Î∂ÑÍ∏∞Î≥Ñ Î≤ïÎ†π ÌïÑÌÑ∞ÎßÅ
                const quarterInfo = {
                    'Q1': { months: [1, 2, 3], name: '1Î∂ÑÍ∏∞' },
                    'Q2': { months: [4, 5, 6], name: '2Î∂ÑÍ∏∞' },
                    'Q3': { months: [7, 8, 9], name: '3Î∂ÑÍ∏∞' },
                    'Q4': { months: [10, 11, 12], name: '4Î∂ÑÍ∏∞' }
                };
                
                const info = quarterInfo[quarter];
                if (!info) {
                    alert('ÏûòÎ™ªÎêú Î∂ÑÍ∏∞ Ï†ïÎ≥¥ÏûÖÎãàÎã§.');
                    return;
                }
                
                // 2025ÎÖÑ Ìï¥Îãπ Î∂ÑÍ∏∞ Î≤ïÎ†π ÌïÑÌÑ∞ÎßÅ
                const quarterLaws = lawsData.filter(law => {
                    if (!law.effectiveDate || !law.effectiveDate.startsWith('2025')) return false;
                    const month = parseInt(law.effectiveDate.split('-')[1]);
                    return info.months.includes(month);
                });
                
                // Í∞ÄÎÇòÎã§Ïàú Ï†ïÎ†¨
                quarterLaws.sort((a, b) => {
                    const titleCompare = a.title.localeCompare(b.title, 'ko-KR');
                    if (titleCompare !== 0) return titleCompare;
                    return (a.effectiveDate || '').localeCompare(b.effectiveDate || '');
                });
                
                const quarterData = { laws: quarterLaws };
                
                if (!quarterLaws || quarterLaws.length === 0) {
                    alert('Ìï¥Îãπ Î∂ÑÍ∏∞Ïóê Î≤ïÎ†πÏù¥ ÏóÜÏäµÎãàÎã§.');
                    return;
                }
                
                // ÏõåÌÅ¨Î∂Å ÏÉùÏÑ±
                const workbook = XLSX.utils.book_new();
                
                // üè∑Ô∏è 1. Î∂ÑÍ∏∞ Ï¢ÖÌï©ÌòÑÌô© ÏãúÌä∏ ÏÉùÏÑ±
                const summaryData = createSummarySheet(quarterData, quarter);
                const summaryWorksheet = XLSX.utils.json_to_sheet(summaryData.data);
                
                // Ï¢ÖÌï©ÌòÑÌô© ÏãúÌä∏ Ïä§ÌÉÄÏùºÎßÅ
                applySummarySheetStyling(summaryWorksheet, summaryData.data.length);
                XLSX.utils.book_append_sheet(workbook, summaryWorksheet, 'üìä Î∂ÑÍ∏∞ Ï¢ÖÌï©ÌòÑÌô©');
                
                // üìã 2. ÏÉÅÏÑ∏ Î≤ïÎ†π Î™©Î°ù ÏãúÌä∏ ÏÉùÏÑ± (3Î≤à ÏïΩÏπ≠ ÏÇ≠Ï†ú, ÏßÅÎ¨¥Î≥ÑÍ≥º ÎèôÏùº Íµ¨Ï°∞)
                const detailedData = quarterData.laws.map((law, index) => {
                    const analysis = generateUniqueAmendmentContent(law);
                    return {
                        'ÏàúÎ≤à': index + 1,
                        'ÏãúÌñâÏùºÏûê': law.effectiveDate || '',
                        'Î≤ïÎ†πÎ™Ö': law.title || '',
                        'Í∞úÏ†ïÎ≤ïÎ•†Ï°∞Ìï≠': generateAmendmentClause(law),
                        'Ï£ºÏöîÍ∞úÏ†ïÎÇ¥Ïö©': analysis.uniqueContent,
                        'ÌïÑÏöîÏ°∞ÏπòÏÇ¨Ìï≠': analysis.uniqueActions,
                        'Îã¥ÎãπÎ∂ÄÏÑú': '',
                        'Îã¥ÎãπÏûê': '',
                        'Ï°∞ÏπòÏÇ¨Ìï≠': '',  // ÏÉàÎ°ú Ï∂îÍ∞ÄÎêú Ïπ∏
                        'Ïù¥ÌñâÏÉÅÌÉú': '',
                        'ÏôÑÎ£åÏòàÏ†ïÏùº': ''
                    };
                });
                
                const detailedWorksheet = XLSX.utils.json_to_sheet(detailedData);
                
                // Í∞ïÎ†•Ìïú Í∞ÄÏö¥Îç∞ Ï†ïÎ†¨ÏùÑ ÏúÑÌïú Ï∂îÍ∞Ä ÏÑ§Ï†ï
                if (!detailedWorksheet['!cols']) detailedWorksheet['!cols'] = [];
                if (!detailedWorksheet['!rows']) detailedWorksheet['!rows'] = [];
                
                applyDetailedSheetStyling(detailedWorksheet, detailedData.length);
                
                // ÎìúÎ°≠Îã§Ïö¥ Í≤ÄÏ¶ù Ï∂îÍ∞Ä (8Î≤à Ïª¨Îüº - Ïù¥ÌñâÏÉÅÌÉú)
                // ÎìúÎ°≠Îã§Ïö¥ Í≤ÄÏ¶ù Ï†úÍ±∞ - ÎπàÏπ∏ÏúºÎ°ú ÎëêÍ∏∞
                // addDropdownValidation(detailedWorksheet, detailedData.length, 'H', ['ÏßÑÌñâÏ§ë', 'Ï≤òÎ¶¨ÏôÑÎ£å', 'Ìï¥ÎãπÏÇ¨Ìï≠ÏóÜÏùå']);
                
                XLSX.utils.book_append_sheet(workbook, detailedWorksheet, `üìã ${quarter} ÏÉÅÏÑ∏ Î≤ïÎ†πÎ™©Î°ù`);
                
                // üè¢ 3. ÏßÅÎ¨¥Î≥Ñ ÏãúÌä∏ ÏÉùÏÑ±
                const categorySheets = createCategorySheets(quarterData.laws);
                categorySheets.forEach(({name, data, worksheet}) => {
                    XLSX.utils.book_append_sheet(workbook, worksheet, name);
                });
                
                // üìà 4. ÌÜµÍ≥Ñ Ï∞®Ìä∏ ÏãúÌä∏ ÏôÑÏ†Ñ ÏÇ≠Ï†ú
                
                // ÌååÏùºÎ™Ö ÏÉùÏÑ± Î∞è Îã§Ïö¥Î°úÎìú
                const quarterNames = {
                    'Q1': '1Î∂ÑÍ∏∞', 'Q2': '2Î∂ÑÍ∏∞', 'Q3': '3Î∂ÑÍ∏∞', 'Q4': '4Î∂ÑÍ∏∞'
                };
                const today = new Date().toISOString().split('T')[0];
                const fileName = `2025ÎÖÑ_${quarterNames[quarter]}_Î≤ïÎ†πÍ∞úÏ†ïÌòÑÌô©_Ï¢ÖÌï©Î∂ÑÏÑù_${today}.xlsx`;
                
                XLSX.writeFile(workbook, fileName);
                console.log(`üéâ ${quarterNames[quarter]} ÌîÑÎ°úÌéòÏÖîÎÑê ÏóëÏÖÄ Îã§Ïö¥Î°úÎìú ÏôÑÎ£å: ${quarterData.laws.length}Í±¥`);
                
            } catch (error) {
                console.error('ÏóëÏÖÄ Îã§Ïö¥Î°úÎìú Ïò§Î•ò:', error);
                alert('ÏóëÏÖÄ ÌååÏùº Îã§Ïö¥Î°úÎìú Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.');
            }
        }
        
        // üè∑Ô∏è Î∂ÑÍ∏∞ Ï¢ÖÌï©ÌòÑÌô© ÏãúÌä∏ Îç∞Ïù¥ÌÑ∞ ÏÉùÏÑ± (Ï∞®Ìä∏ ÏãúÍ∞ÅÌôî Ìè¨Ìï®)
        function createSummarySheet(quarterData, quarter) {
            const laws = quarterData.laws || [];
            const categories = {};
            
            // Ïπ¥ÌÖåÍ≥†Î¶¨Î≥Ñ ÏßëÍ≥Ñ
            laws.forEach(law => {
                const category = (law.categories && law.categories[0]) || 'Í∏∞ÌÉÄ';
                if (!categories[category]) {
                    categories[category] = { count: 0, laws: [] };
                }
                categories[category].count++;
                categories[category].laws.push(law.title);
            });
            
            // ÌòÑÏû¨ ÎÇ†Ïßú Í∏∞Ï§Ä ÏãúÌñâ ÏôÑÎ£å/ÏòàÏ†ï Í≥ÑÏÇ∞
            const currentDate = '2025-08-29';
            const implemented = laws.filter(law => law.effectiveDate && law.effectiveDate <= currentDate).length;
            const pending = laws.length - implemented;
            
            const summaryData = [
                { 'Ìï≠Î™©': 'üìä Î∂ÑÍ∏∞ Ï¢ÖÌï© ÌòÑÌô©', 'ÎÇ¥Ïö©': `2025ÎÖÑ ${quarter} (${quarterData.period || ''})` },
                { 'Ìï≠Î™©': '', 'ÎÇ¥Ïö©': '' },
                { 'Ìï≠Î™©': 'üìà Ï†ÑÏ≤¥ ÌòÑÌô©', 'ÎÇ¥Ïö©': '' },
                { 'Ìï≠Î™©': '  Ï¥ù Î≤ïÎ†π Ïàò', 'ÎÇ¥Ïö©': `${laws.length}Í±¥` },
                { 'Ìï≠Î™©': '  ÏãúÌñâÏôÑÎ£å', 'ÎÇ¥Ïö©': `${implemented}Í±¥ (${Math.round((implemented/laws.length)*100) || 0}%)` },
                { 'Ìï≠Î™©': '  ÏãúÌñâÏòàÏ†ï', 'ÎÇ¥Ïö©': `${pending}Í±¥ (${Math.round((pending/laws.length)*100) || 0}%)` },
                { 'Ìï≠Î™©': '', 'ÎÇ¥Ïö©': '' },
                { 'Ìï≠Î™©': 'üìä ÏßÅÎ¨¥Î≥Ñ Î∂ÑÌè¨ Ï∞®Ìä∏', 'ÎÇ¥Ïö©': '(ÏãúÍ∞ÅÌôî)' },
                ...Object.entries(categories).map(([category, info]) => {
                    const percentage = Math.round((info.count / laws.length) * 100) || 0;
                    const barChart = '‚ñà'.repeat(Math.ceil(percentage / 10)) + '‚ñë'.repeat(10 - Math.ceil(percentage / 10));
                    return {
                        'Ìï≠Î™©': `  ${getCategoryIcon(category)} ${category}`,
                        'ÎÇ¥Ïö©': `${info.count}Í±¥ (${percentage}%) ${barChart}`
                    };
                }),
                { 'Ìï≠Î™©': '', 'ÎÇ¥Ïö©': '' },
                { 'Ìï≠Î™©': 'üìÖ ÏÉùÏÑ±ÏùºÏãú', 'ÎÇ¥Ïö©': new Date().toLocaleString('ko-KR') },
                { 'Ìï≠Î™©': 'üìù Îç∞Ïù¥ÌÑ∞ Ï∂úÏ≤ò', 'ÎÇ¥Ïö©': 'Íµ≠Í∞ÄÎ≤ïÎ†πÏ†ïÎ≥¥ÏÑºÌÑ∞ (law.go.kr)' },
                { 'Ìï≠Î™©': 'üîÑ ÏóÖÎç∞Ïù¥Ìä∏ Ï£ºÍ∏∞', 'ÎÇ¥Ïö©': 'ÏàòÎèô ÏóÖÎç∞Ïù¥Ìä∏ (Îç∞Ïù¥ÌÑ∞ Î≥¥Ìò∏ Î™®Îìú)' }
            ];
            
            return { data: summaryData };
        }
        
        // üé® Ï¢ÖÌï©ÌòÑÌô© ÏãúÌä∏ Ïä§ÌÉÄÏùºÎßÅ
        function applySummarySheetStyling(worksheet, dataLength) {
            const range = XLSX.utils.decode_range(worksheet['!ref']);
            
            // Ïª¨Îüº ÎÑàÎπÑ ÏÑ§Ï†ï
            worksheet['!cols'] = [
                { wch: 20 }, // Ìï≠Î™©
                { wch: 40 }  // ÎÇ¥Ïö©
            ];
            
            // Ìñâ ÎÜíÏù¥ ÏÑ§Ï†ï
            worksheet['!rows'] = Array(dataLength).fill({ hpt: 20 });
            
            // Ìó§Îçî Ïä§ÌÉÄÏùºÎßÅ (Ïã§Ï†ú ÏóëÏÖÄÏóêÏÑú Ï†ÅÏö©Îê† Í∏∞Î≥∏ ÌòïÏãù)
            for (let R = range.s.r; R <= range.e.r; ++R) {
                for (let C = range.s.c; C <= range.e.c; ++C) {
                    const cellRef = XLSX.utils.encode_cell({ r: R, c: C });
                    if (!worksheet[cellRef]) continue;
                    
                    // Í∏∞Î≥∏ ÏÖÄ ÏÑ§Ï†ï (ÏôÑÎ≤ΩÌïú Í∞ÄÏö¥Îç∞ Ï†ïÎ†¨)
                    if (!worksheet[cellRef].s) worksheet[cellRef].s = {};
                    
                    worksheet[cellRef].s = {
                        alignment: { 
                            horizontal: 'center',  // Í∞ÄÎ°ú Í∞ÄÏö¥Îç∞ Ï†ïÎ†¨
                            vertical: 'center',    // ÏÑ∏Î°ú Í∞ÄÏö¥Îç∞ Ï†ïÎ†¨
                            wrapText: true,        // ÌÖçÏä§Ìä∏ Ï§ÑÎ∞îÍøà
                            indent: 0,             // Îì§Ïó¨Ïì∞Í∏∞ ÏóÜÏùå
                            readingOrder: 0,       // ÏùΩÍ∏∞ ÏàúÏÑú
                            textRotation: 0        // ÌÖçÏä§Ìä∏ ÌöåÏ†Ñ ÏóÜÏùå
                        },
                        border: {
                            top: { style: 'thin', color: { rgb: 'CCCCCC' } },
                            bottom: { style: 'thin', color: { rgb: 'CCCCCC' } },
                            left: { style: 'thin', color: { rgb: 'CCCCCC' } },
                            right: { style: 'thin', color: { rgb: 'CCCCCC' } }
                        },
                        font: {
                            name: 'ÎßëÏùÄ Í≥†Îîï',
                            sz: 10
                        }
                    };
                    
                    // Ìó§Îçî Ìñâ Ïä§ÌÉÄÏùºÎßÅ (ÏÉâÏÉÅ ÏΩîÎî©)
                    if (R === 0) {
                        worksheet[cellRef].s.fill = { fgColor: { rgb: '4F46E5' } };
                        worksheet[cellRef].s.font = { 
                            bold: true, 
                            color: { rgb: 'FFFFFF' }, 
                            sz: 12,
                            name: 'ÎßëÏùÄ Í≥†Îîï'
                        };
                    }
                }
            }
        }
        
        // üìã ÏÉÅÏÑ∏ ÏãúÌä∏ Ïä§ÌÉÄÏùºÎßÅ
        function applyDetailedSheetStyling(worksheet, dataLength) {
            // 11Ïª¨Îüº Íµ¨Ï°∞: ÏàúÎ≤à, ÏãúÌñâÏùºÏûê, Î≤ïÎ†πÎ™Ö, Í∞úÏ†ïÎ≤ïÎ•†Ï°∞Ìï≠, Ï£ºÏöîÍ∞úÏ†ïÎÇ¥Ïö©, ÌïÑÏöîÏ°∞ÏπòÏÇ¨Ìï≠, Îã¥ÎãπÎ∂ÄÏÑú, Îã¥ÎãπÏûê, Ï°∞ÏπòÏÇ¨Ìï≠, Ïù¥ÌñâÏÉÅÌÉú, ÏôÑÎ£åÏòàÏ†ïÏùº
            worksheet['!cols'] = [
                { wch: 8 },   // ÏàúÎ≤à
                { wch: 12 },  // ÏãúÌñâÏùºÏûê  
                { wch: 35 },  // Î≤ïÎ†πÎ™Ö
                { wch: 20 },  // Í∞úÏ†ïÎ≤ïÎ•†Ï°∞Ìï≠
                { wch: 45 },  // Ï£ºÏöîÍ∞úÏ†ïÎÇ¥Ïö©
                { wch: 45 },  // ÌïÑÏöîÏ°∞ÏπòÏÇ¨Ìï≠
                { wch: 15 },  // Îã¥ÎãπÎ∂ÄÏÑú
                { wch: 12 },  // Îã¥ÎãπÏûê
                { wch: 30 },  // Ï°∞ÏπòÏÇ¨Ìï≠ (ÏÉàÎ°ú Ï∂îÍ∞Ä)
                { wch: 12 },  // Ïù¥ÌñâÏÉÅÌÉú
                { wch: 12 }   // ÏôÑÎ£åÏòàÏ†ïÏùº
            ];
            
            // Ìñâ ÎÜíÏù¥ ÏÑ§Ï†ï (ÎÇ¥Ïö©Ïù¥ ÎßéÏùÄ Ïª¨ÎüºÎì§ÏùÄ Îçî ÎÜíÍ≤å)
            worksheet['!rows'] = Array(dataLength + 1).fill(null).map((_, i) => 
                i === 0 ? { hpt: 30 } : { hpt: 50 } // Ìó§ÎçîÎäî 30, ÎÇ¥Ïö©ÏùÄ 50
            );
            
            const range = XLSX.utils.decode_range(worksheet['!ref']);
            
            // Î™®Îì† ÏÖÄÏóê Í∞ÄÏö¥Îç∞ Ï†ïÎ†¨ Ï†ÅÏö©
            for (let R = range.s.r; R <= range.e.r; ++R) {
                for (let C = range.s.c; C <= range.e.c; ++C) {
                    const cellRef = XLSX.utils.encode_cell({ r: R, c: C });
                    if (!worksheet[cellRef]) continue;
                    
                    // ÏôÑÎ≤ΩÌïú Excel Í∞ÄÏö¥Îç∞ Ï†ïÎ†¨ (Î™®Îì† ÏÖÄÏóê Ï†ÅÏö©)
                    if (!worksheet[cellRef].s) worksheet[cellRef].s = {};
                    
                    worksheet[cellRef].s = {
                        alignment: { 
                            horizontal: 'center',  // Í∞ÄÎ°ú Í∞ÄÏö¥Îç∞ Ï†ïÎ†¨
                            vertical: 'center',    // ÏÑ∏Î°ú Í∞ÄÏö¥Îç∞ Ï†ïÎ†¨
                            wrapText: true,        // ÌÖçÏä§Ìä∏ Ï§ÑÎ∞îÍøà
                            indent: 0,             // Îì§Ïó¨Ïì∞Í∏∞ ÏóÜÏùå
                            readingOrder: 0,       // ÏùΩÍ∏∞ ÏàúÏÑú
                            textRotation: 0        // ÌÖçÏä§Ìä∏ ÌöåÏ†Ñ ÏóÜÏùå
                        },
                        border: {
                            top: { style: 'thin', color: { rgb: 'CCCCCC' } },
                            bottom: { style: 'thin', color: { rgb: 'CCCCCC' } },
                            left: { style: 'thin', color: { rgb: 'CCCCCC' } },
                            right: { style: 'thin', color: { rgb: 'CCCCCC' } }
                        },
                        font: { 
                            name: 'ÎßëÏùÄ Í≥†Îîï',
                            sz: 10,
                            bold: false
                        }
                    };
                    
                    // Ìó§Îçî Í∞ïÎ†•Ìïú Í∞ÄÏö¥Îç∞ Ï†ïÎ†¨
                    if (R === 0) {
                        worksheet[cellRef].s.fill = { fgColor: { rgb: '4F46E5' } };
                        worksheet[cellRef].s.font = { 
                            bold: true, 
                            color: { rgb: 'FFFFFF' }, 
                            sz: 11,
                            name: 'ÎßëÏùÄ Í≥†Îîï'
                        };
                        // Ìó§ÎçîÎèÑ Í∞ÄÏö¥Îç∞ Ï†ïÎ†¨ Ïú†ÏßÄ
                        worksheet[cellRef].s.alignment = {
                            horizontal: 'center',    // Í∞ÄÎ°ú Í∞ÄÏö¥Îç∞
                            vertical: 'center',      // ÏÑ∏Î°ú Í∞ÄÏö¥Îç∞
                            wrapText: true,
                            indent: 0
                        };
                    }
                    // Î™®Îì† ÏÖÄ Í∞ÄÏö¥Îç∞ Ï†ïÎ†¨ ÏôÑÎ£å
                }
            }
        }
        
        // üìù ÎìúÎ°≠Îã§Ïö¥ Í≤ÄÏ¶ù Ï∂îÍ∞Ä (ÏàòÏ†ïÎêú Î≤ÑÏ†Ñ - SheetJS Ìò∏ÌôòÏÑ±)
        function addDropdownValidation(worksheet, dataLength, column, options) {
            try {
                // SheetJSÏóêÏÑú ÏßÄÏõêÌïòÎäî ÎìúÎ°≠Îã§Ïö¥ Î∞©Ïãù
                const range = `${column}2:${column}${dataLength + 1}`;
                
                // ÏÖÄ Ï£ºÏÑùÏúºÎ°ú ÎìúÎ°≠Îã§Ïö¥ ÏòµÏÖò Ï∂îÍ∞Ä
                for (let i = 2; i <= dataLength + 1; i++) {
                    const cellRef = `${column}${i}`;
                    if (worksheet[cellRef]) {
                        worksheet[cellRef].c = worksheet[cellRef].c || [];
                        worksheet[cellRef].c.push({
                            a: 'validation',
                            t: `ÏòµÏÖò: ${options.join(', ')}`
                        });
                    }
                }
                
                console.log(`‚úÖ ÎìúÎ°≠Îã§Ïö¥ Í≤ÄÏ¶ù Ï∂îÍ∞Ä: ${column} Ïª¨Îüº, ÏòµÏÖò: ${options.join(', ')}`);
            } catch (error) {
                console.warn(`‚ö†Ô∏è ÎìúÎ°≠Îã§Ïö¥ Í≤ÄÏ¶ù Ï∂îÍ∞Ä Ïã§Ìå®:`, error);
                // ÎìúÎ°≠Îã§Ïö¥ Ïã§Ìå®Ïãú ÏÖÄ Ï£ºÏÑùÏúºÎ°ú ÎåÄÏ≤¥
                for (let i = 2; i <= dataLength + 1; i++) {
                    const cellRef = `${column}${i}`;
                    if (worksheet[cellRef]) {
                        worksheet[cellRef].c = worksheet[cellRef].c || [];
                        worksheet[cellRef].c.push({
                            a: 'dropdown_options',
                            t: `ÏòµÏÖò: ${options.join(' / ')}`
                        });
                    }
                }
            }
        }
        
        // üè¢ ÏßÅÎ¨¥Î≥Ñ ÏãúÌä∏ ÏÉùÏÑ±
        function createCategorySheets(laws) {
            const categories = {};
            const sheets = [];
            
            // Ïπ¥ÌÖåÍ≥†Î¶¨Î≥Ñ Î≤ïÎ†π Î∂ÑÎ•ò
            laws.forEach(law => {
                const category = (law.categories && law.categories[0]) || 'Í∏∞ÌÉÄ';
                if (!categories[category]) {
                    categories[category] = [];
                }
                categories[category].push(law);
            });
            
            // Í∞Å Ïπ¥ÌÖåÍ≥†Î¶¨Î≥Ñ ÏãúÌä∏ ÏÉùÏÑ± (ÏÉÅÏÑ∏ÏãúÌä∏ÏôÄ ÏôÑÏ†Ñ ÎèôÏùº Íµ¨Ï°∞)
            Object.entries(categories).forEach(([category, categoryLaws]) => {
                const categoryData = categoryLaws.map((law, index) => {
                    const analysis = generateUniqueAmendmentContent(law);
                    return {
                        'ÏàúÎ≤à': index + 1,
                        'ÏãúÌñâÏùºÏûê': law.effectiveDate || '',  // effective_date Ï†úÍ±∞, effectiveDateÎßå ÏÇ¨Ïö©
                        'Î≤ïÎ†πÎ™Ö': law.title || '',
                        'Í∞úÏ†ïÎ≤ïÎ•†Ï°∞Ìï≠': generateAmendmentClause(law),
                        'Ï£ºÏöîÍ∞úÏ†ïÎÇ¥Ïö©': analysis.uniqueContent,
                        'ÌïÑÏöîÏ°∞ÏπòÏÇ¨Ìï≠': analysis.uniqueActions,
                        'Îã¥ÎãπÎ∂ÄÏÑú': '',
                        'Îã¥ÎãπÏûê': '',
                        'Ï°∞ÏπòÏÇ¨Ìï≠': '',  // ÏÉàÎ°ú Ï∂îÍ∞ÄÎêú Ïπ∏
                        'Ïù¥ÌñâÏÉÅÌÉú': '',
                        'ÏôÑÎ£åÏòàÏ†ïÏùº': ''
                    };
                });
                
                const worksheet = XLSX.utils.json_to_sheet(categoryData);
                
                // Ïπ¥ÌÖåÍ≥†Î¶¨ ÏãúÌä∏ Ïä§ÌÉÄÏùºÎßÅ
                applyCategorySheetStyling(worksheet, categoryData.length, category);
                
                // ÎìúÎ°≠Îã§Ïö¥ Ï∂îÍ∞Ä (GÎ≤à Ïª¨Îüº - Ïù¥ÌñâÏÉÅÌÉú)
                // ÎìúÎ°≠Îã§Ïö¥ Í≤ÄÏ¶ù ÏôÑÏ†Ñ Ï†úÍ±∞
                
                const icon = getCategoryIcon(category);
                sheets.push({
                    name: `${icon} ${category}`,
                    data: categoryData,
                    worksheet: worksheet
                });
            });
            
            return sheets;
        }
        
        // üè¢ Ïπ¥ÌÖåÍ≥†Î¶¨Î≥Ñ ÏãúÌä∏ Ïä§ÌÉÄÏùºÎßÅ
        function applyCategorySheetStyling(worksheet, dataLength, category) {
            // ÏÉÅÏÑ∏ ÏãúÌä∏ÏôÄ ÎèôÏùºÌïú 11Ïª¨Îüº Íµ¨Ï°∞
            worksheet['!cols'] = [
                { wch: 8 },   // ÏàúÎ≤à
                { wch: 12 },  // ÏãúÌñâÏùºÏûê
                { wch: 35 },  // Î≤ïÎ†πÎ™Ö
                { wch: 20 },  // Í∞úÏ†ïÎ≤ïÎ•†Ï°∞Ìï≠
                { wch: 45 },  // Ï£ºÏöîÍ∞úÏ†ïÎÇ¥Ïö©
                { wch: 45 },  // ÌïÑÏöîÏ°∞ÏπòÏÇ¨Ìï≠
                { wch: 15 },  // Îã¥ÎãπÎ∂ÄÏÑú
                { wch: 12 },  // Îã¥ÎãπÏûê
                { wch: 30 },  // Ï°∞ÏπòÏÇ¨Ìï≠ (ÏÉàÎ°ú Ï∂îÍ∞Ä)
                { wch: 12 },  // Ïù¥ÌñâÏÉÅÌÉú
                { wch: 12 }   // ÏôÑÎ£åÏòàÏ†ïÏùº
            ];
            
            worksheet['!rows'] = Array(dataLength + 1).fill(null).map((_, i) => 
                i === 0 ? { hpt: 25 } : { hpt: 50 }
            );
            
            const categoryColors = {
                'Ïû¨Î¨¥ÌöåÍ≥Ñ': '3B82F6', 'ÌôòÍ≤Ω': '10B981', 'ÏïàÏ†Ñ': 'F59E0B',
                'Ïù∏ÏÇ¨ÎÖ∏Î¨¥': 'EF4444', 'Ï†ïÎ≥¥Î≥¥Ìò∏': '8B5CF6', 'ÏßÄÎ∞∞Íµ¨Ï°∞': '6366F1',
                'Í≥µÏ†ïÍ±∞Îûò': '06B6D4', 'Í∏∞ÌÉÄ': '6B7280'
            };
            
            const range = XLSX.utils.decode_range(worksheet['!ref']);
            for (let R = range.s.r; R <= range.e.r; ++R) {
                for (let C = range.s.c; C <= range.e.c; ++C) {
                    const cellRef = XLSX.utils.encode_cell({ r: R, c: C });
                    if (!worksheet[cellRef]) continue;
                    
                    // Ïπ¥ÌÖåÍ≥†Î¶¨ ÏãúÌä∏ ÏôÑÎ≤ΩÌïú Í∞ÄÏö¥Îç∞ Ï†ïÎ†¨
                    if (!worksheet[cellRef].s) worksheet[cellRef].s = {};
                    
                    worksheet[cellRef].s = {
                        alignment: { 
                            horizontal: 'center',  // Í∞ÄÎ°ú Í∞ÄÏö¥Îç∞ Ï†ïÎ†¨
                            vertical: 'center',    // ÏÑ∏Î°ú Í∞ÄÏö¥Îç∞ Ï†ïÎ†¨
                            wrapText: true,        // ÌÖçÏä§Ìä∏ Ï§ÑÎ∞îÍøà
                            indent: 0              // Îì§Ïó¨Ïì∞Í∏∞ ÏóÜÏùå
                        },
                        border: {
                            top: { style: 'thin', color: { rgb: 'CCCCCC' } },
                            bottom: { style: 'thin', color: { rgb: 'CCCCCC' } },
                            left: { style: 'thin', color: { rgb: 'CCCCCC' } },
                            right: { style: 'thin', color: { rgb: 'CCCCCC' } }
                        },
                        font: {
                            name: 'ÎßëÏùÄ Í≥†Îîï',
                            sz: 10,
                            bold: false
                        }
                    };
                    
                    if (R === 0) {
                        worksheet[cellRef].s.fill = { fgColor: { rgb: categoryColors[category] || '6B7280' } };
                        worksheet[cellRef].s.font = { 
                            bold: true, 
                            color: { rgb: 'FFFFFF' },
                            sz: 11,
                            name: 'ÎßëÏùÄ Í≥†Îîï'
                        };
                        // Ìó§ÎçîÎèÑ Í∞ÄÏö¥Îç∞ Ï†ïÎ†¨ Ïú†ÏßÄ
                        worksheet[cellRef].s.alignment = {
                            horizontal: 'center',  // Í∞ÄÎ°ú Í∞ÄÏö¥Îç∞
                            vertical: 'center',    // ÏÑ∏Î°ú Í∞ÄÏö¥Îç∞
                            wrapText: true,
                            indent: 0
                        };
                    }
                }
            }
        }
        
        // üìà ÌÜµÍ≥Ñ Ï∞®Ìä∏ ÏãúÌä∏ ÏÉùÏÑ±
        function createChartSheet(laws, quarter) {
            const categories = {};
            const monthlyData = {};
            
            laws.forEach(law => {
                const category = (law.categories && law.categories[0]) || 'Í∏∞ÌÉÄ';
                categories[category] = (categories[category] || 0) + 1;
                
                if (law.effective_date) {
                    const month = law.effective_date.substring(5, 7);
                    monthlyData[month] = (monthlyData[month] || 0) + 1;
                }
            });
            
            const chartData = [
                { 'Íµ¨Î∂Ñ': 'üìä ÌÜµÍ≥Ñ Î∂ÑÏÑù', 'Í∞í': `2025ÎÖÑ ${quarter} Î≤ïÎ†π Í∞úÏ†ï ÌòÑÌô©` },
                { 'Íµ¨Î∂Ñ': '', 'Í∞í': '' },
                { 'Íµ¨Î∂Ñ': 'üè¢ ÏßÅÎ¨¥Î≥Ñ Î∂ÑÌè¨', 'Í∞í': '' },
                ...Object.entries(categories).map(([cat, count]) => ({
                    'Íµ¨Î∂Ñ': `${getCategoryIcon(cat)} ${cat}`, 'Í∞í': `${count}Í±¥`
                })),
                { 'Íµ¨Î∂Ñ': '', 'Í∞í': '' },
                { 'Íµ¨Î∂Ñ': 'üìÖ ÏõîÎ≥Ñ Î∂ÑÌè¨', 'Í∞í': '' },
                ...Object.entries(monthlyData).map(([month, count]) => ({
                    'Íµ¨Î∂Ñ': `${month}Ïõî`, 'Í∞í': `${count}Í±¥`
                }))
            ];
            
            const worksheet = XLSX.utils.json_to_sheet(chartData);
            worksheet['!cols'] = [{ wch: 25 }, { wch: 20 }];
            
            return worksheet;
        }
        
        // üé® Ïπ¥ÌÖåÍ≥†Î¶¨ ÏïÑÏù¥ÏΩò Î∞òÌôò
        function getCategoryIcon(category) {
            const icons = {
                'Ïû¨Î¨¥ÌöåÍ≥Ñ': 'üí∞', 'ÌôòÍ≤Ω': 'üå±', 'ÏïàÏ†Ñ': 'üõ°Ô∏è', 'Ïù∏ÏÇ¨ÎÖ∏Î¨¥': 'üë•',
                'Ï†ïÎ≥¥Î≥¥Ìò∏': 'üîí', 'ÏßÄÎ∞∞Íµ¨Ï°∞': 'üèõÔ∏è', 'Í≥µÏ†ïÍ±∞Îûò': '‚öñÔ∏è', 'Í∏∞ÌÉÄ': 'üìã'
            };
            return icons[category] || 'üìã';
        }
        
        // üìß Ïù¥Î©îÏùº Î∞úÏÜ°
        function openEmailScheduler() {
            const width = 1100;
            const height = 900;
            const left = (window.screen.width - width) / 2;
            const top = (window.screen.height - height) / 2;
            
            const popup = window.open(
                './email_popup.html',
                'RegRaderEmailCenter',
                `width=${width},height=${height},left=${left},top=${top},scrollbars=yes,resizable=yes`
            );
            
            // ÌåùÏóÖÏù¥ Ï∞®Îã®Îêú Í≤ΩÏö∞
            if (!popup || popup.closed || typeof popup.closed == 'undefined') {
                alert('ÌåùÏóÖÏù¥ Ï∞®Îã®ÎêòÏóàÏäµÎãàÎã§. ÌåùÏóÖ Ï∞®Îã®ÏùÑ Ìï¥Ï†úÌï¥Ï£ºÏÑ∏Ïöî.');
            }
        }
        
        // ÌÖúÌîåÎ¶øÎ≥Ñ Ïù¥Î©îÏùº Î∞úÏÜ°
        function sendEmailWithTemplate(template) {
            const toEmail = prompt('üìß Î∞õÏùÑ Ïù¥Î©îÏùº Ï£ºÏÜå:', 'example@company.com');
            
            if (!toEmail || toEmail === 'example@company.com') {
                alert('Ïò¨Î∞îÎ•∏ Ïù¥Î©îÏùº Ï£ºÏÜåÎ•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }
            
            // Î°úÎî© ÌëúÏãú
            const sendBtn = document.querySelector('.settings-btn[onclick="openEmailScheduler()"]');
            const originalHTML = sendBtn.innerHTML;
            sendBtn.innerHTML = '‚è≥';
            sendBtn.disabled = true;
            
            let templateParams = {};
            
            if (template === 'current') {
                // Ï†ÑÏ≤¥ ÌòÑÌô©
                const q1Count = lawsData.filter(law => {
                    if (!law.effectiveDate) return false;
                    const month = new Date(law.effectiveDate).getMonth() + 1;
                    return month >= 1 && month <= 3;
                }).length;
                
                const q2Count = lawsData.filter(law => {
                    if (!law.effectiveDate) return false;
                    const month = new Date(law.effectiveDate).getMonth() + 1;
                    return month >= 4 && month <= 6;
                }).length;
                
                const q3Count = lawsData.filter(law => {
                    if (!law.effectiveDate) return false;
                    const month = new Date(law.effectiveDate).getMonth() + 1;
                    return month >= 7 && month <= 9;
                }).length;
                
                const q4Count = lawsData.filter(law => {
                    if (!law.effectiveDate) return false;
                    const month = new Date(law.effectiveDate).getMonth() + 1;
                    return month >= 10 && month <= 12;
                }).length;
                
                const jobCategories = {};
                lawsData.forEach(law => {
                    const category = (law.categories && law.categories[0]) || 'Í∏∞ÌÉÄ';
                    jobCategories[category] = (jobCategories[category] || 0) + 1;
                });
                
                const jobSummary = Object.entries(jobCategories)
                    .sort((a, b) => b[1] - a[1])
                    .map(([cat, count]) => `${getCategoryIcon(cat)} ${cat}: ${count}Í±¥`)
                    .join(' / ');
                
                templateParams = {
                    to_email: toEmail,
                    email: toEmail,
                    name: toEmail.split('@')[0],
                    total: lawsData.length.toString(),
                    q1: q1Count.toString(),
                    q2: q2Count.toString(),
                    q3: q3Count.toString(),
                    q4: q4Count.toString(),
                    quarterly: `1Î∂ÑÍ∏∞: ${q1Count}Í±¥, 2Î∂ÑÍ∏∞: ${q2Count}Í±¥, 3Î∂ÑÍ∏∞: ${q3Count}Í±¥, 4Î∂ÑÍ∏∞: ${q4Count}Í±¥`,
                    job: jobSummary,
                    laws: 'ÏµúÍ∑º Í∞úÏ†ï Î≤ïÎ†π',
                    title: `[RegRader] 2025ÎÖÑ Ï†ÑÏ≤¥ Î≤ïÎ†π ÌòÑÌô© - ${lawsData.length}Í±¥`,
                    content: `2025ÎÖÑ Î≤ïÎ†π Í∞úÏ†ï ÌòÑÌô©ÏùÑ ÏïàÎÇ¥ÎìúÎ¶ΩÎãàÎã§.\n\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nüìä Ï†ÑÏ≤¥ ÌòÑÌô©: Ï¥ù ${lawsData.length}Í±¥\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\nüìÖ Î∂ÑÍ∏∞Î≥Ñ ÏãúÌñâ ÏòàÏ†ï\n‚Ä¢ 1Î∂ÑÍ∏∞(1-3Ïõî): ${q1Count}Í±¥\n‚Ä¢ 2Î∂ÑÍ∏∞(4-6Ïõî): ${q2Count}Í±¥\n‚Ä¢ 3Î∂ÑÍ∏∞(7-9Ïõî): ${q3Count}Í±¥\n‚Ä¢ 4Î∂ÑÍ∏∞(10-12Ïõî): ${q4Count}Í±¥\n\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nüìÇ ÏßÅÎ¨¥Î≥Ñ ÌòÑÌô©\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n${jobSummary}\n\nüí° ÏûêÏÑ∏Ìïú ÎÇ¥Ïö©ÏùÄ RegRader ÎåÄÏãúÎ≥¥ÎìúÏóêÏÑú ÌôïÏù∏ÌïòÏÑ∏Ïöî.`,
                    url: window.location.href,
                    date: new Date().toLocaleDateString('ko-KR')
                };
            } else {
                // Î∂ÑÍ∏∞Î≥Ñ
                const quarterNum = template.substring(1);
                const quarterMonths = {
                    'q1': [1, 2, 3],
                    'q2': [4, 5, 6],
                    'q3': [7, 8, 9],
                    'q4': [10, 11, 12]
                };
                
                const months = quarterMonths[template];
                const quarterLaws = lawsData.filter(law => {
                    if (!law.effectiveDate) return false;
                    const month = new Date(law.effectiveDate).getMonth() + 1;
                    const year = new Date(law.effectiveDate).getFullYear();
                    return year === 2025 && months.includes(month);
                });
                
                const quarterJobs = {};
                quarterLaws.forEach(law => {
                    const category = (law.categories && law.categories[0]) || 'Í∏∞ÌÉÄ';
                    quarterJobs[category] = (quarterJobs[category] || 0) + 1;
                });
                
                const quarterJobSummary = Object.entries(quarterJobs)
                    .sort((a, b) => b[1] - a[1])
                    .map(([cat, count]) => `${getCategoryIcon(cat)} ${cat}: ${count}Í±¥`)
                    .join(' / ');
                
                templateParams = {
                    to_email: toEmail,
                    email: toEmail,
                    name: toEmail.split('@')[0],
                    total: quarterLaws.length.toString(),
                    q1: template === 'q1' ? quarterLaws.length.toString() : '0',
                    q2: template === 'q2' ? quarterLaws.length.toString() : '0',
                    q3: template === 'q3' ? quarterLaws.length.toString() : '0',
                    q4: template === 'q4' ? quarterLaws.length.toString() : '0',
                    quarterly: `${quarterNum}Î∂ÑÍ∏∞: ${quarterLaws.length}Í±¥`,
                    job: quarterJobSummary || 'Îç∞Ïù¥ÌÑ∞ ÏóÜÏùå',
                    laws: quarterLaws.slice(0, 10).map(law => law.title).join(', ') || 'Î∂ÑÍ∏∞Î≥Ñ Î≤ïÎ†π',
                    title: `[RegRader] 2025ÎÖÑ ${quarterNum}Î∂ÑÍ∏∞ Î≤ïÎ†π ÌòÑÌô© - ${quarterLaws.length}Í±¥`,
                    content: `2025ÎÖÑ ${quarterNum}Î∂ÑÍ∏∞(${months[0]}~${months[2]}Ïõî) Î≤ïÎ†π Í∞úÏ†ï ÏÉÅÏÑ∏ ÏïàÎÇ¥ÎìúÎ¶ΩÎãàÎã§.\n\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nüìä ${quarterNum}Î∂ÑÍ∏∞ Ï†ÑÏ≤¥ ÌòÑÌô©: ${quarterLaws.length}Í±¥\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\nüìÇ ÏßÅÎ¨¥Î≥Ñ ÌòÑÌô©\n${quarterJobSummary || 'Îç∞Ïù¥ÌÑ∞ ÏóÜÏùå'}\n\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nüìã Ï£ºÏöî Í∞úÏ†ï Î≤ïÎ†π (ÏÉÅÏúÑ 10Í∞ú)\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n${quarterLaws.slice(0, 10).map((law, idx) => {
                        const date = law.effectiveDate ? new Date(law.effectiveDate).toLocaleDateString('ko-KR') : 'ÎÇ†Ïßú ÎØ∏Ï†ï';
                        const category = (law.categories && law.categories[0]) || 'Í∏∞ÌÉÄ';
                        return `\n${idx+1}. ${law.title}\n   [${category}] ${date} ÏãúÌñâ`;
                    }).join('\n')}\n\nüí° RegRader ÎåÄÏãúÎ≥¥ÎìúÏóêÏÑú ÏÉÅÏÑ∏ ÎÇ¥Ïö©ÏùÑ ÌôïÏù∏ÌïòÏÑ∏Ïöî.`,
                    url: window.location.href,
                    date: new Date().toLocaleDateString('ko-KR')
                };
            }
            
            // Ïù¥Î©îÏùº Î∞úÏÜ°
            emailjs.send('service_7tdd8dh', 'template_tu71wgt', templateParams)
                .then(function(response) {
                    alert(`‚úÖ Ïù¥Î©îÏùº Î∞úÏÜ° ÏÑ±Í≥µ!\n${toEmail}`);
                    sendBtn.innerHTML = originalHTML;
                    sendBtn.disabled = false;
                })
                .catch(function(error) {
                    alert(`‚ùå Î∞úÏÜ° Ïã§Ìå®: ${error.text || 'Ïò§Î•ò'}`);
                    sendBtn.innerHTML = originalHTML;
                    sendBtn.disabled = false;
                });
        }

        // üìß Ïù¥Î©îÏùº Î∞úÏÜ° Ìï®Ïàò
        function sendMonitoringEmail() {
            // Ïù¥Î©îÏùº Ï£ºÏÜå ÏûÖÎ†•Î∞õÍ∏∞
            const toEmail = prompt('üìß Î≤ïÎ†π Î™®ÎãàÌÑ∞ÎßÅ ÌòÑÌô©ÏùÑ Î∞õÏùÑ Ïù¥Î©îÏùº Ï£ºÏÜåÎ•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî:', 'example@company.com');
            
            if (!toEmail || toEmail === 'example@company.com') {
                alert('Ïò¨Î∞îÎ•∏ Ïù¥Î©îÏùº Ï£ºÏÜåÎ•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }

            // Î°úÎî© ÌëúÏãú
            const sendBtn = document.querySelector('.settings-btn[onclick="sendMonitoringEmail()"]');
            const originalHTML = sendBtn.innerHTML;
            sendBtn.innerHTML = '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><circle cx="12" cy="12" r="10" stroke-dasharray="15 5" stroke-dashoffset="0"><animateTransform attributeName="transform" type="rotate" from="0 12 12" to="360 12 12" dur="1s" repeatCount="indefinite"/></circle></svg>';
            sendBtn.disabled = true;

            // Î∂ÑÍ∏∞Î≥Ñ Îç∞Ïù¥ÌÑ∞ Í≥ÑÏÇ∞
            const q1Count = lawsData.filter(law => {
                if (!law.effectiveDate) return false;
                const month = new Date(law.effectiveDate).getMonth() + 1;
                return month >= 1 && month <= 3;
            }).length;

            const q2Count = lawsData.filter(law => {
                if (!law.effectiveDate) return false;
                const month = new Date(law.effectiveDate).getMonth() + 1;
                return month >= 4 && month <= 6;
            }).length;

            const q3Count = lawsData.filter(law => {
                if (!law.effectiveDate) return false;
                const month = new Date(law.effectiveDate).getMonth() + 1;
                return month >= 7 && month <= 9;
            }).length;

            const q4Count = lawsData.filter(law => {
                if (!law.effectiveDate) return false;
                const month = new Date(law.effectiveDate).getMonth() + 1;
                return month >= 10 && month <= 12;
            }).length;

            // ÏßÅÎ¨¥Î≥Ñ Îç∞Ïù¥ÌÑ∞ Í≥ÑÏÇ∞
            const jobCategories = {};
            lawsData.forEach(law => {
                const category = (law.categories && law.categories[0]) || 'Í∏∞ÌÉÄ';
                jobCategories[category] = (jobCategories[category] || 0) + 1;
            });

            // ÏßÅÎ¨¥Î≥Ñ ÌòÑÌô© ÌÖçÏä§Ìä∏ ÏÉùÏÑ±
            let jobSummary = '';
            Object.entries(jobCategories)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 5)
                .forEach(([category, count]) => {
                    jobSummary += `${getCategoryIcon(category)} ${category}: ${count}Í±¥\n`;
                });

            // ÏµúÍ∑º Î≤ïÎ†π Î™©Î°ù (ÏµúÎåÄ 5Í∞ú)
            const recentLaws = lawsData
                .filter(law => law.effectiveDate)
                .sort((a, b) => new Date(b.effectiveDate) - new Date(a.effectiveDate))
                .slice(0, 5)
                .map(law => `‚Ä¢ ${law.title} (${law.effectiveDate})`)
                .join('\n');

            // Ïù¥Î©îÏùº ÌÖúÌîåÎ¶ø Îç∞Ïù¥ÌÑ∞ - Í∞ÑÎã®Ìïú Î≥ÄÏàòÎ™Ö ÏÇ¨Ïö©
            const templateParams = {
                // Í∏∞Î≥∏ Ï†ïÎ≥¥
                email: toEmail,
                name: toEmail.split('@')[0],
                
                // Î≤ïÎ†π Îç∞Ïù¥ÌÑ∞
                total: lawsData.length.toString(),
                q1: q1Count.toString(),
                q2: q2Count.toString(),
                q3: q3Count.toString(),
                q4: q4Count.toString(),
                
                // ÌÖçÏä§Ìä∏ Îç∞Ïù¥ÌÑ∞
                quarterly: `1Î∂ÑÍ∏∞: ${q1Count}Í±¥, 2Î∂ÑÍ∏∞: ${q2Count}Í±¥, 3Î∂ÑÍ∏∞: ${q3Count}Í±¥, 4Î∂ÑÍ∏∞: ${q4Count}Í±¥`,
                job: jobSummary,
                laws: recentLaws || 'ÏµúÍ∑º Í∞úÏ†ïÎêú Î≤ïÎ†πÏù¥ ÏóÜÏäµÎãàÎã§.',
                
                // Î©îÏãúÏßÄ
                title: `[RegRader] 2025ÎÖÑ Î≤ïÎ†π Í∞úÏ†ï ÌòÑÌô© Î¶¨Ìè¨Ìä∏ - Ï¥ù ${lawsData.length}Í±¥`,
                content: `ÏïàÎÖïÌïòÏÑ∏Ïöî,\n\nRegRader Î≤ïÎ†π Î™®ÎãàÌÑ∞ÎßÅ ÏãúÏä§ÌÖúÏóêÏÑú 2025ÎÖÑ Î≤ïÎ†π Í∞úÏ†ï ÌòÑÌô©ÏùÑ ÏïàÎÇ¥ÎìúÎ¶ΩÎãàÎã§.\n\nüìä Ï†ÑÏ≤¥ ÌòÑÌô©\nÏ¥ù Îß§Ïπ≠ Î≤ïÎ†π: ${lawsData.length}Í±¥\n\nüìÖ Î∂ÑÍ∏∞Î≥Ñ ÌòÑÌô©\n1Î∂ÑÍ∏∞: ${q1Count}Í±¥\n2Î∂ÑÍ∏∞: ${q2Count}Í±¥\n3Î∂ÑÍ∏∞: ${q3Count}Í±¥\n4Î∂ÑÍ∏∞: ${q4Count}Í±¥\n\nüè¢ ÏßÅÎ¨¥Î≥Ñ ÌòÑÌô©\n${jobSummary}\n\nüìã ÏµúÍ∑º Í∞úÏ†ï Î≤ïÎ†π\n${recentLaws || 'ÏµúÍ∑º Í∞úÏ†ïÎêú Î≤ïÎ†πÏù¥ ÏóÜÏäµÎãàÎã§.'}\n\nÏûêÏÑ∏Ìïú ÎÇ¥Ïö©ÏùÄ ÏïÑÎûò ÎßÅÌÅ¨ÏóêÏÑú ÌôïÏù∏ÌïòÏã§ Ïàò ÏûàÏäµÎãàÎã§:\n${window.location.href}`,
                
                // Ï∂îÍ∞Ä Ï†ïÎ≥¥
                url: window.location.href,
                date: new Date().toLocaleDateString('ko-KR')
            };
            
            // ÏΩòÏÜîÏóê Î∞úÏÜ°Ìï† Îç∞Ïù¥ÌÑ∞ Ï∂úÎ†• (ÎîîÎ≤ÑÍπÖÏö©)
            console.log('üìß Ïù¥Î©îÏùº Î∞úÏÜ° Îç∞Ïù¥ÌÑ∞:', templateParams);
            console.log('=== EmailJS ÌÖúÌîåÎ¶øÏóêÏÑú ÏÇ¨Ïö© Í∞ÄÎä•Ìïú Î≥ÄÏàò ===');
            console.log('{{email}} =', templateParams.email);
            console.log('{{name}} =', templateParams.name);
            console.log('{{total}} =', templateParams.total);
            console.log('{{q1}}, {{q2}}, {{q3}}, {{q4}} =', templateParams.q1, templateParams.q2, templateParams.q3, templateParams.q4);
            console.log('{{quarterly}} =', templateParams.quarterly);
            console.log('{{job}} =', templateParams.job);
            console.log('{{laws}} =', templateParams.laws);
            console.log('{{title}} =', templateParams.title);
            console.log('{{content}} =', templateParams.content);
            console.log('{{url}} =', templateParams.url);
            console.log('{{date}} =', templateParams.date);
            console.log('=====================================');

            // EmailJSÎ°ú Ïù¥Î©îÏùº Î∞úÏÜ°
            emailjs.send('service_7tdd8dh', 'template_tu71wgt', templateParams)
                .then(function(response) {
                    console.log('SUCCESS!', response.status, response.text);
                    alert(`‚úÖ Ïù¥Î©îÏùºÏù¥ ÏÑ±Í≥µÏ†ÅÏúºÎ°ú Î∞úÏÜ°ÎêòÏóàÏäµÎãàÎã§!\n\nüìß Î∞õÎäî ÏÇ¨Îûå: ${toEmail}\nüìä Ï¥ù ${lawsData.length}Í±¥Ïùò Î≤ïÎ†π Ï†ïÎ≥¥Í∞Ä Ìè¨Ìï®ÎêòÏóàÏäµÎãàÎã§.`);
                    
                    // Î≤ÑÌäº ÏõêÏÉÅÎ≥µÍµ¨
                    sendBtn.innerHTML = originalHTML;
                    sendBtn.disabled = false;
                }, function(error) {
                    console.error('FAILED...', error);
                    alert(`‚ùå Ïù¥Î©îÏùº Î∞úÏÜ°Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.\n\nÏò§Î•ò: ${error.text || 'Ïïå Ïàò ÏóÜÎäî Ïò§Î•ò'}\n\nÎã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.`);
                    
                    // Î≤ÑÌäº ÏõêÏÉÅÎ≥µÍµ¨
                    sendBtn.innerHTML = originalHTML;
                    sendBtn.disabled = false;
                });
        }
    </script>
    
    <!-- Îç∞Ïù¥ÌÑ∞ Îã§Ïö¥Î°úÎìú Î™®Îã¨ -->
    <div id="dataDownloadModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 10000; align-items: center; justify-content: center;">
        <div style="background: white; border-radius: 16px; padding: 2rem; max-width: 600px; width: 90%; max-height: 80vh; overflow-y: auto; box-shadow: 0 20px 60px rgba(0,0,0,0.3);">
            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 1.5rem;">
                <h2 style="margin: 0; color: #333; font-size: 1.5rem;">üì• 2025ÎÖÑ Î≤ïÎ†π Îç∞Ïù¥ÌÑ∞ Îã§Ïö¥Î°úÎìú</h2>
                <button onclick="closeDataDownload()" style="background: none; border: none; font-size: 1.5rem; cursor: pointer; color: #999;">√ó</button>
            </div>
            
            <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 1.5rem; border-radius: 12px; margin-bottom: 1.5rem;">
                <h3 style="margin: 0 0 0.5rem 0; font-size: 1.2rem;">üìä 2025ÎÖÑ ÏãúÌñâÎ≤ïÎ†π Ï†ÑÏ≤¥ Îç∞Ïù¥ÌÑ∞</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 1rem; margin-top: 1rem;">
                    <div style="text-align: center;">
                        <div style="font-size: 2rem; font-weight: bold;">2,971</div>
                        <div style="font-size: 0.9rem; opacity: 0.9;">Ï¥ù Î≤ïÎ†π</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 2rem; font-weight: bold;">1,716</div>
                        <div style="font-size: 0.9rem; opacity: 0.9;">ÌòÑÌñâ</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 2rem; font-weight: bold;">213</div>
                        <div style="font-size: 0.9rem; opacity: 0.9;">ÏòàÏ†ï</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 2rem; font-weight: bold;">1,042</div>
                        <div style="font-size: 0.9rem; opacity: 0.9;">Ïó∞ÌòÅ</div>
                    </div>
                </div>
            </div>
            
            <div style="border: 1px solid #e0e0e0; border-radius: 12px; padding: 1rem; margin-bottom: 1rem;">
                <h4 style="margin: 0 0 1rem 0; color: #333;">Îã§Ïö¥Î°úÎìú Í∞ÄÎä•Ìïú ÌååÏùº</h4>
                
                <div style="display: flex; flex-direction: column; gap: 0.8rem;">
                    <a href="./2025_laws_complete.xlsx" download style="display: flex; align-items: center; padding: 1rem; background: #f5f5f5; border-radius: 8px; text-decoration: none; color: #333; transition: all 0.2s ease;" 
                       onmouseover="this.style.background='#e8e8e8'" onmouseout="this.style.background='#f5f5f5'">
                        <span style="font-size: 1.5rem; margin-right: 1rem;">üìä</span>
                        <div style="flex: 1;">
                            <div style="font-weight: 600;">2025ÎÖÑ ÏãúÌñâÎ≤ïÎ†π Ï†ÑÏ≤¥ (Excel)</div>
                            <div style="font-size: 0.85rem; color: #666;">2,971Í∞ú Î≤ïÎ†π ¬∑ ÏÉÅÌÉúÎ≥Ñ/ÏõîÎ≥Ñ/Î∂ÄÏ≤òÎ≥Ñ ÌÜµÍ≥Ñ Ìè¨Ìï® ¬∑ ÏïΩ 2MB</div>
                        </div>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#667eea" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="7 10 12 15 17 10"></polyline>
                            <line x1="12" y1="15" x2="12" y2="3"></line>
                        </svg>
                    </a>
                    
                    <a href="./laws_2025_complete.json" download style="display: flex; align-items: center; padding: 1rem; background: #f5f5f5; border-radius: 8px; text-decoration: none; color: #333; transition: all 0.2s ease;" 
                       onmouseover="this.style.background='#e8e8e8'" onmouseout="this.style.background='#f5f5f5'">
                        <span style="font-size: 1.5rem; margin-right: 1rem;">üìÑ</span>
                        <div style="flex: 1;">
                            <div style="font-weight: 600;">2025ÎÖÑ ÏãúÌñâÎ≤ïÎ†π Ï†ÑÏ≤¥ (JSON)</div>
                            <div style="font-size: 0.85rem; color: #666;">ÏõêÎ≥∏ Îç∞Ïù¥ÌÑ∞ ¬∑ API Ïó∞Îèô Í∞ÄÎä• ¬∑ ÏÉÅÏÑ∏ Î©îÌÉÄÎç∞Ïù¥ÌÑ∞ Ìè¨Ìï®</div>
                        </div>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#667eea" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="7 10 12 15 17 10"></polyline>
                            <line x1="12" y1="15" x2="12" y2="3"></line>
                        </svg>
                    </a>
                    
                    <a href="./index.json" download style="display: flex; align-items: center; padding: 1rem; background: #f5f5f5; border-radius: 8px; text-decoration: none; color: #333; transition: all 0.2s ease;" 
                       onmouseover="this.style.background='#e8e8e8'" onmouseout="this.style.background='#f5f5f5'">
                        <span style="font-size: 1.5rem; margin-right: 1rem;">üè¢</span>
                        <div style="flex: 1;">
                            <div style="font-weight: 600;">Ïö∞Î¶¨ ÌöåÏÇ¨ Ï†ÅÏö©Î≤ïÍ∑ú 207Í∞ú</div>
                            <div style="font-size: 0.85rem; color: #666;">Í∏∞Î≥∏ Ï†ÅÏö©Î≤ïÍ∑ú Î™©Î°ù ¬∑ JSON ÌòïÏãù</div>
                        </div>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#667eea" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="7 10 12 15 17 10"></polyline>
                            <line x1="12" y1="15" x2="12" y2="3"></line>
                        </svg>
                    </a>
                </div>
            </div>
            
            <div style="background: #f0f4f8; padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                <div style="display: flex; align-items: start; gap: 0.5rem;">
                    <span style="color: #667eea;">‚ÑπÔ∏è</span>
                    <div style="font-size: 0.9rem; color: #666;">
                        <strong>Îç∞Ïù¥ÌÑ∞ Ï∂úÏ≤ò:</strong> Íµ≠Í∞ÄÎ≤ïÎ†πÏ†ïÎ≥¥ÏÑºÌÑ∞ Open API<br>
                        <strong>ÏµúÏ¢Ö ÏóÖÎç∞Ïù¥Ìä∏:</strong> ${new Date().toLocaleDateString('ko-KR')}<br>
                        <strong>API Endpoint:</strong> www.law.go.kr/DRF/lawSearch.do
                    </div>
                </div>
            </div>
            
            <div style="display: flex; justify-content: flex-end; gap: 1rem;">
                <button onclick="closeDataDownload()" style="padding: 0.8rem 1.5rem; background: #e0e0e0; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;">
                    Îã´Í∏∞
                </button>

            </div>
        </div>
    </div>
    
    <script>
        function openDataDownload() {
            const modal = document.getElementById('dataDownloadModal');
            modal.style.display = 'flex';
        }
        
        function closeDataDownload() {
            const modal = document.getElementById('dataDownloadModal');
            modal.style.display = 'none';
        }
        
        // ESC ÌÇ§Î°ú Îã´Í∏∞
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeDataDownload();
            }
        });
        
        // Î™®Îã¨ Ïô∏Î∂Ä ÌÅ¥Î¶≠Ïãú Îã´Í∏∞
        document.getElementById('dataDownloadModal').addEventListener('click', (e) => {
            if (e.target.id === 'dataDownloadModal') {
                closeDataDownload();
            }
        });
    </script>
    
    <!-- PWA Service Worker Îì±Î°ù -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./service-worker.js')
                    .then(registration => console.log('ServiceWorker registered'))
                    .catch(err => console.log('ServiceWorker registration failed'));
            });
        }
    </script>
</body>
</html>
<!-- Last updated: 2025-08-29 01:29:46 -->
